(window.webpackJsonp=window.webpackJsonp||[]).push([["inbox-email-communicator"],{"/XSg":function(e,t,n){"use strict";n.d(t,"a",function(){return c});n.d(t,"b",function(){return u});var a=n("Ykb2"),r=n("kcgT"),i=n.n(r),o=n("433u"),s=n.n(o),c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Boolean(e)&&(i.a.test(e)||s.a.test(e))},u=function(e){return!!e&&(e.length>=a.a||c(e))}},"/cKn":function(e,t,n){"use strict";var a=n("QYOI"),r=n("MQNR"),i=n("mzNV"),o=Object(a.fromJS)({count:10,filterGroups:[],offset:0,sorts:[]}),s=Object(a.fromJS)({order:"DESC",property:"createdate"}),c={default:function(e){var t=o.merge(Object(a.fromJS)(e)).updateIn(["sorts"],function(e){return e.push(s)});return Object(i.a)({objectType:r.TICKET,query:t})},associatedTickets:function(e,t,n,r){return Object(a.fromJS)({filterGroups:[{filters:[{operator:"EQ",property:"associations."+e.toLowerCase(),value:t}]}],count:n,offset:0,query:r})}};t.a=c},"/sC9":function(e,t,n){"use strict";var a=n("gTuk"),r=n("bkwg"),i=n("U0r4"),o=n("RRvD"),s=n("5mx2"),c=n("AgF4");Object(i.a)({actionTypePrefix:s.u,fetcher:a.a});var u="FETCH_FAILED",l="FETCH_FAILED";t.a=Object(r.a)({actionTypePrefix:s.u}).defineName("UserSettingsStore").defineResponseTo([o.pc,o.qc],function(e,t){var n=t.key,a=t.value;return e.set(n,a)}).defineResponseTo([o.oc],function(e){return e.set(u,l)}).register(c.a)},"1Md+":function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a="CLOSED"},"2T69":function(e,t,n){"use strict";var a=n("/sC9"),r=n("QYOI"),i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){var e=a.a.get(r.Seq.Set(t).toMap());if(!e.some(function(e){return void 0===e}))return e}};t.a=function(){return{stores:[a.a],deref:i.apply(void 0,arguments)}}},"2TCK":function(e,t,n){"use strict";var a=n("QYOI"),r=n("bn2T"),i=Object(a.fromJS)({offset:0,count:10,filterGroups:[],sorts:[]}),o=Object(a.fromJS)({operator:"IN",property:"engagement.type",values:[r.c,r.i,r.g,r.a,r.h,r.f]}),s=Object(a.fromJS)({property:"engagement.id",order:"DESC"}),c={default:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).excludeDefaultFilters;return i.merge(Object(a.fromJS)(e)).updateIn(["sorts"],function(e){return e.push(s)}).updateIn(["filterGroups"],function(e){0===e.size&&(e=e.push(Object(a.fromJS)({filters:[]})));return t?e:e.map(function(e){var t=e.get("filters").push(o);return e.set("filters",t)})})}};t.a=c},"57l5":function(e,t,n){"use strict";n.d(t,"a",function(){return h});n.d(t,"b",function(){return O});n.d(t,"e",function(){return v});n.d(t,"c",function(){return j});n.d(t,"d",function(){return S});n.d(t,"f",function(){return y});n.d(t,"g",function(){return C});n.d(t,"h",function(){return E});var a=n("QYOI"),r=n("p6Sd"),i=n.n(r),o=n("MQNR"),s=n("vNYB"),c=n("ap+s"),u=n("xHov"),l=n("J92U"),d=n("SYgn"),p=n.n(d),m="engagements/v1/engagements",h="engagements/v2/engagements",f=function(e){return m+"/"+e},g=function(e){e.getIn(["engagement","type"])===o.TASK&&(e.hasIn(["metadata","taskType"])||(e=e.setIn(["metadata","taskType"],null)));return e},b=i()(Object(a.Map)(),function(e,t,n){return a.Map.isMap(t)||"attachments"===n?e.set(n,Object(a.fromJS)(t)):e});function O(e,t,n){return Object(l.d)(f(e)+"/associations/"+t+"/"+n,{})}function v(e){var t={type:c.b,timeout:1e4};return Object(u.f)(t,m+"/batch",e,function(e){return e.reduce(function(e,t){return e.set(""+t.engagement.id,s.a.fromJS(t))},Object(a.Map)())})}function j(e){e.getIn&&e.getIn(["engagement","ownerId"])||p.a.captureMessage("Engagement on create missing ownerId",{extra:{engagement:e}});return Object(l.c)(m+"/",e,function(e){return{createdEngagementRecord:s.a.fromJS(e),associationCreateFailures:e.associationCreateFailures}})}function S(e){return Object(l.a)(f(e))}function y(e){var t=b(e),n=t.getIn(["engagement","id"])||t.getIn(["eventData","engagement","id"]);return Object(l.d)(f(n),t).then(g)}function C(e,t){return Object(l.b)(f(e),b(Object(a.fromJS)(t))).then(g)}function E(e,t){return Object(l.d)(f(e)+"/associations",t)}},"7XTd":function(e,t,n){"use strict";n.d(t,"c",function(){return r});var a=n("ImZw");n.d(t,"b",function(){return a.h});n.d(t,"a",function(){return a.a});var r="UNSUBSCRIBE_LOADING"},"7qCc":function(e,t,n){"use strict";n.d(t,"b",function(){return m});n.d(t,"a",function(){return h});var a=n("QYOI"),r=n("xHov"),i=n("vNYB"),o=n("ap+s"),s=n("pPiP"),c=n.n(s),u=n("OuMQ"),l=n("WYIs"),d=n("G/lG"),p=function(e,t){var n=t||{},r=Object(u.b)(l.d),i=Object(a.fromJS)(n.responseJSON),o=i.getIn(["emailEngagementCreatorFailure","emailEngagementCreatorFailureType"])||i.get("sendSchedulingFailureType"),s=Object(u.a)({errorType:o,defaultMessage:r,emailRecord:e,isUngatedForEmailSettingsMigration:d.a.get("EmailSettingsMigration")});return Promise.reject(s)};function m(e,t,n,a,s,u){var l=a.source,d=n.delete("contactIds").toJS(),m="engagements-emails/v1/email/schedule-send";s&&(d.replyToEngagementId=s);u&&(d.recommendedSendTimeId=u);return r.f({type:o.e,headers:{"X-Source":l},query:d},m+"?scheduledTime="+t,e).then(function(e){return e&&i.a.fromJS(e)},c()(p,e))}function h(e,t){return r.e("engagements-emails/v1/email/unschedule-send/"+encodeURIComponent(e)+"/"+t)}},"8h+W":function(e,t,n){"use strict";"use es6";var a=0,r=function(e){return""+e+ ++a};t.a=function(e){var t={};Object.keys(e).forEach(function(n){t[n]=r(e[n]||n)});return t}},"9J8I":function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return a});n.d(t,"b",function(){return r});n.d(t,"c",function(){return i});var a="any",r="fixed",i="scoped";e&&e.exports&&(e.exports.default=Object.assign({},e.exports))}).call(this,n("ABwO")(e))},"9Z7B":function(e,t,n){"use strict";n.d(t,"a",function(){return m});n.d(t,"b",function(){return h});n.d(t,"c",function(){return f});var a=n("QYOI"),r=n("emzX"),i=n.n(r),o=n("RRvD"),s=(n("bC4p"),n("Ly8s")),c=n("P4dz"),u=n("X3fw"),l=n("MQNR"),d=n("7gk9"),p=function(e,t){return Object(a.Map)({objectId:e,objectType:l.COMPANY,associationType:t})};function m(e){Object(s.b)(o.f,Object(a.Set)(e));Object(s.b)(o.b,Object(a.Set)([p(e[0],d.e),p(e[0],d.g),p(e[0],d.m)]))}function h(e){i()(a.Map.isMap(e),'Companies Actions: expected companies to be a Map but got "%s"');return Object(s.a)(o.g,e)}function f(e,t){var n=""+e.get("companyId"),a=t.map(function(t,n){return Object(c.d)(e,n)});Object(s.a)(o.i,{id:n,properties:a,nextProperties:t});return u.g(e,t).then(function(){return Object(s.a)(o.j,{id:n,properties:t,prevProperties:a})},function(e){Object(s.a)(o.h,{error:e,id:n,nextProperties:t,properties:a});throw e})}},AF1D:function(e,t,n){"use strict";var a=n("QYOI"),r=n.n(a),i=n("Xdd2"),o=n("AgF4"),s=n("RRvD"),c=n("Ly8s"),u=n("ITHK"),l=n("/XSg"),d=n("OwGx"),p=n("MQNR"),m=Object.assign({},p),h={};Object.keys(m).forEach(function(e){h[e]=void 0});var f=Object(a.Record)(h,"ObjectTypesRecord"),g=n("3Ajz"),b=n("pPiP"),O=n.n(b),v=n("6l6v"),j=n.n(v),S=n("aitF"),y=n.n(S),C=n("yTm7"),E=n("xHov"),T=n("ap+s"),I=n("mDbF"),R=n.n(I),A=n("Iie8"),N=n.n(A),x=n("8QMF"),L=n.n(x),k=n("KLfa"),M=n("5mx2"),_=n("yMxc"),D=n("L9KA"),P=n("ZsE6"),w=(n("1RCs"),n("WbQG")),B="deals/v1",F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return B+"/pipelines/"+e},U=function(e){return e.get("stages").map(function(e){return e.merge({value:e.get("stageId"),text:Object(w.b)(e.get("label"))})})},q=function(e){var t=e.reduce(function(e,t){t=t.merge({stageOptions:U(t),value:t.get("pipelineId"),stages:t.get("stages")});return e.set(t.get("pipelineId"),t)},Object(a.Map)()),n=D.getFrom(localStorage,P.a);n&&!t.has(n)&&D.deleteFrom(localStorage,P.a);return t.sortBy(function(e){return e.get("displayOrder")})};function G(){return Object(E.c)(F()).then(q)}var V=Object(_.a)({fetch:G,namespace:M.f}).defineName("DealPipelineStore").defineResponseTo(s.Hb,function(e,t){var n=t.key,a=t.value;return e.setIn(["value",n],a)}).defineResponseTo(s.Gb,function(e,t){return e.deleteIn(["value",t])}).defineResponseTo(s.Fb,function(e,t){var n=t.reduce(function(e,t){return e.set(t.get("pipelineId"),t)},Object(a.OrderedMap)());return e.set("value",n)}).register(o.a),H=function(e,t){return e.merge({pipelineDisplayOrder:t.get("displayOrder"),pipelineId:t.get("pipelineId"),pipelineLabel:Object(w.b)(t.get("label")),text:Object(w.b)(e.get("label")),value:e.get("stageId")})},z=Object(i.defineFactory)().defineName("DealsStageStore").defineGetInitialState(function(){return Object(a.Map)()}).defineGet(function(e,t){0===e.size&&V.get();return t?e.get(t):e}).defineResponseTo(s.O,function(e,t){t.forEach(function(t){return t.get("stages").forEach(function(n){e=e.set(n.get("stageId"),H(n,t))})});return e}).defineResponseTo(s.Hb,function(e,t){var n=t.value;if(!n)return e;n.get("stages").sortBy(function(e){return e.get("displayOrder")}).forEach(function(t){e=e.set(t.get("stageId"),H(t,n))});return e}).defineResponseTo(s.Gb,function(e,t){return e.filter(function(e){return e.get("pipelineId")!==t})}).register(o.a),W=n("lpDa"),K="pipelines/v2/pipelines/TICKET",Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return K+"/"+e},Q=function(e){return e.get("stages").map(function(e){return e.merge({value:e.get("stageId"),text:e.get("label")})})},J=function(e){return e.reduce(function(e,t){var n=t.get("pipelineId");t=t.merge({stageOptions:Q(t),value:n});return e.set(n,t)},Object(a.Map)()).sortBy(function(e){return e.get("displayOrder")})};function X(){return Object(E.c)(Y(),{includePermissions:!0}).then(J)}var Z,$=Object(_.a)({fetch:X,namespace:M.t}).defineResponseTo(s.dc,function(e,t){return e.setIn(["value",t.get("pipelineId")],t)}).defineResponseTo(s.hc,function(e,t){return e.setIn(["value",t.get("pipelineId")],t)}).defineResponseTo(s.ec,function(e,t){return e.deleteIn(["value",t])}).defineResponseTo(s.gc,function(e,t){var n=t.reduce(function(e,t){return e.set(t.get("pipelineId"),t)},Object(a.OrderedMap)());return e.set("value",n)}).defineName("TicketsPipelinesStore").register(o.a),ee=function(e,t){return e.merge({pipelineDisplayOrder:t.get("displayOrder"),pipelineId:t.get("pipelineId"),pipelineLabel:t.get("label"),text:e.get("label"),value:e.get("stageId")})},te=Object(i.defineFactory)().defineName("TicketsPiplinesStagesStore").defineGetInitialState(function(){return Object(a.Map)()}).defineGet(function(e,t){0===e.size&&$.get();return t?e.get(t):e}).defineResponseTo(s.fc,function(e,t){t.forEach(function(t){return t.get("stages").forEach(function(n){e=e.set(n.get("stageId"),ee(n,t))})});return e}).defineResponseTo(s.Hb,function(e,t){var n=t.value;if(!n)return e;n.get("stages").sortBy(function(e){return e.get("displayOrder")}).forEach(function(t){e=e.set(t.get("stageId"),ee(t,n))});return e}).defineResponseTo(s.Gb,function(e,t){return e.filter(function(e){return e.get("pipelineId")!==t})}).register(o.a),ne=n("1Md+"),ae=n("0HCf"),re=n.n(ae),ie=n("RaRG"),oe=["JANUARY","FEBRUARY","MARCH","APRIL","MAY","JUNE","JULY","AUGUST","SEPTEMBER","OCTOBER","NOVEMBER","DECEMBER"],se=n("THQ/"),ce=n.n(se),ue=n("eVil"),le=n.n(ue),de=n("0iMM"),pe=n.n(de),me={message:"FilterPlaceholderResolver should not be used with calling setupFilterPlaceholderResolver to initialize the current owner",url:"https://git.hubteam.com/HubSpot/CRM/pull/19205",key:"FilterPlaceholderResolver:Init"},he="__hs__ME",fe="__hs__ID",ge="__hs__NOW",be="__hs__CLOSEDWON",Oe="__hs__TICKET_CLOSED",ve="__hs__FISCAL_YEAR_OFFSET",je=function(e,t){e.values&&(e.values=N()(function(e){return t.has(e)?t.get(e):e},e.values));t.has(e.value)&&(e.value=t.get(e.value));return e},Se=function(){var e=z.get();return!!e&&e.filter(function(e){return 1===e.get("probability")}).map(function(e){return e.get("value")})},ye=0,Ce=function(e){var t=oe.indexOf(e);return t>-1?t:ye},Ee=function(){var e=te.get();return!!e&&e.filter(function(e){return e.getIn(["metadata","ticketState"])===ne.a}).map(function(e){return e.get("value")})},Te=function(e){var t;Z||re.a.warn(me);return je(e,Object(a.Map)((t={},Object(d.a)(t,he,""+Z),Object(d.a)(t,fe,""+k.a.get().get("user_id")),Object(d.a)(t,ge,R.a.moment.userTz().valueOf()),t)))},Ie=function(e){var t,n=Object(a.Set)(e.values);if(n.contains(be)){n=n.remove(be);t=Se()}else if(n.contains(Oe)){n=n.remove(Oe);t=Ee()}t&&(e.values=n.union(t.toSet()).toArray());return e},Re=function(e,t){"TIME_UNIT_TO_DATE"===e.operator&&(t=12-t);"QUARTER"===e.timeUnit&&(t=(t+1)%3-1);return pe()("rollingOffset",le()("rollForward",e)||0===t?t:-t,e)},Ae=function(e){var t=W.a.get(),n=t&&t.get(ie.a);return e.rollingOffset!==ve?e:Re(e,Ce(n))},Ne=function(e){delete e.label;return e},xe=N()(L()(Te,Ie,Ae,Ne));Object(C.a)({stores:[z],deref:function(){return z.get()}}),Object(C.a)({stores:[te],deref:function(){return te.get()}}),Object(C.a)({stores:[W.a],deref:function(){return W.a.get()}}),ce()(Promise.resolve(void 0));var Le=n("Wumz"),ke=n("YM6t"),Me=n("SYgn"),_e=n.n(Me),De=n("Elgc"),Pe=n.n(De),we=Object.assign({},p),Be=function(e){Object.prototype.hasOwnProperty.call(we,e)||_e.a.captureMessage("[ObjectType.getObjectTypeDefinition] invalid objectType",{extra:{objectType:e}});return e},Fe=Pe()({name:"getObjectTypeDefinition",args:[Pe.a.TYPE],fallback:Be}),Ue=function(e){Fe(e);return null},qe=Pe()({name:"getRequiredProperties",args:[Pe.a.TYPE],fallback:Ue}),Ge=function(e,t){var n=qe(e);if(null==n)return null;var r=le()("columns",t)||[];return Object(a.Set)([].concat(Object(ke.a)(n),Object(ke.a)(r.map(function(e){return e.get("name")})))).toArray()},Ve=n("eUxV"),He="HIDDEN",ze=n("E7+s"),We=n("0dUV"),Ke=n("2h/E"),Ye=n("Eha6"),Qe=n("g+dq"),Je=n.n(Qe),Xe="crm-permissions/v1/object-access-control/permissions/PIPELINES",Ze=function(e){return Je.a.post(Xe+"/"+encodeURIComponent(e)+"/read-all",{}).then(function(t){return t.permissionsByObjectTypeIdAndTargetIdentifier[e]||{}})},$e="PIPELINE_PERMISSIONS";Object(We.b)({namespace:$e,fetch:Object(Ye.a)(Ze)});var et,tt=Object(We.a)({namespace:$e,idIsValid:function(e){return Object(Ke.a)(e)||Object(Ve.p)(e)}}).defineName("PipelinePermissionsStore").register(o.a),nt=n("omic"),at=n.n(nt)()(["permission","accessLevel"]),rt={stores:[$,tt],deref:function(e){var t=e.objectTypeId;if(t===Ve.e)return tt.get(t);if(t===Ve.o){var n=$.get();return n?n.map(function(e){return at(e)}).toJS():ze.b}return{}}},it=function(e){var t=rt.deref({objectTypeId:e});if(Object(ze.d)(t))return null;var n=e===Ve.e,a=Object.keys(t).filter(function(e){return t[e]===He});return a.length?{operator:"NOT_IN",property:n?"pipeline":"hs_pipeline",values:a}:null},ot=function(e,t){var n=Ve.k[e]||e;if(![Ve.e,Ve.o].includes(n))return t;var r=it(n);return r?t.updateIn(["filterGroups",0,"filters"],function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(a.List)()).push(r)}):t},st=n("nDpY"),ct=n.n(st),ut={type:T.d,timeout:6e4},lt=Object(C.a)(z,function(e){return e.isEmpty()}),dt=Object(C.a)(te,function(e){return e.isEmpty()}),pt=y()(function(e){var t=Object(u.a)(e),n=Object(Le.a)(e),r=t.Record,i=n?["objectId"]:r._idKey,o=r._idKey;return function(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(a.Map)(),c=s.reduce(function(t,a){var s=a.setIn(o,a.getIn(i));e===p.CONTACT&&n&&(s=s.set("canonical-vid",a.getIn(i)).set("portal-id",ct.a.get()));return t.set(s.getIn(o),r.fromJS(s))},Object(a.Map)());c.size>0&&t.updateStore(c);return s.toList().map(function(e){return e.getIn(i)})}}),mt=y()(function(e){var t=Object(u.a)(e);return function(n){var r=pt(e);return Object(a.fromJS)(n).updateIn([t.dataKey],r).set("_results",n.getIn([t.dataKey]))}}),ht=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ge(e,t);return!j()(t.properties)||j()(n)?t:Object.assign({},t,{properties:n})},ft=function(e,t,n){(t=t.toJS()).filterGroups&&(t.filterGroups=t.filterGroups.map(function(e){e.filters=xe(e.filters);return e}));return Object(E.f)(ut,Object(u.b)(e,n),ht(e,t)).then(mt(e))},gt=function(e,t,n){if(Object(u.a)(e)){var a=ot(e,t),r=function(){return ft(e,a,n)};return e===p.DEAL?lt().then(r):e===p.TICKET?dt().then(r):r()}},bt=(O()(gt,p.CONTACT),O()(gt,p.COMPANY),O()(gt,p.DEAL),O()(gt,p.TICKET),O()(gt,p.ENGAGEMENT),O()(gt,p.TASK),gt),Ot=f().reduce(function(e,t,n){return e.set(n,Object(a.Map)())},Object(a.Map)()),vt=f().reduce(function(e,t,n){return e.set(n,Object(a.Set)())},Object(a.Map)()),jt=Object(a.Record)({pending:vt},"ElasticSearchServiceState"),St=function(e){var t=e.objectType,n=e.searchQuery,a=e.viewId,r=e.options;return function(e){var i=n.get("offset"),o=n.get("count"),u=e.get("total"),l=e.get("_results").size,d=Ot.getIn([t,n],0);if(d<3&&(o+i<u&&l<o||u<o&&l<u)){setTimeout(function(){Object(c.b)(s.cb,{options:r,viewId:a,objectType:t,searchQuery:n}).done()},1e3*d);Object(c.a)(s.db,{objectType:t,searchQuery:n});Ot=Ot.setIn([t,n],d+1)}else{Object(c.a)(s.eb,{objectType:t,searchQuery:n,results:e,viewId:a,options:r});Object(c.b)(s.db,{objectType:t,searchQuery:n}).done();Ot=Ot.deleteIn([t,n])}}},yt=function(e){var t=e.objectType,n=e.searchQuery;return function(e){Object(c.a)(s.bb,{objectType:t,searchQuery:n,error:e});Object(c.b)(s.db,{objectType:t,searchQuery:n}).done()}},Ct=function(e,t){var n=e.pending,r=t.objectType,i=t.searchQuery,o=n.get(r);if(o&&o.has(i))return e;var s=St(t),c=yt(t);bt(r,i).then(s,c).done();return o?e.updateIn(["pending",r],function(e){return e.add(i)}):e.setIn(["pending",r],a.Set.of(i))},Et=function(e,t){var n=t.objectType,a=t.searchQuery;return e.updateIn(["pending",n],function(e){return e.delete(a)})},Tt=(et={},Object(d.a)(et,s.cb,Ct),Object(d.a)(et,s.db,Et),et),It=(Object(g.a)(jt(),Tt),1e3),Rt=function(e){var t=e.searchQuery,n=e.overrideMinimumSearch,a=t.get("query");Object(l.b)(a)||n||(t=t.set("query",""));return t},At=function(e,t){return[e,JSON.stringify(Object(a.Map)({filterGroups:t.get("filterGroups"),sorts:t.get("sorts"),query:t.get("query")}))]},Nt=function(e,t){var n=JSON.stringify(Object(a.Map)({offset:t.get("offset"),count:t.get("count")})),r=t.getIn(["requestOptions","properties"])||t.get("properties")||[],i=JSON.stringify(r.sort());return[].concat(At(e,t),n+"-"+i)},xt=function(e,t){return[e,"views",t]},Lt=function(e,t){var n=t.cacheTimeout;if(!1===n)return!1;null==n&&(n=It);n<It&&(n=It);return e.get("fetchTime")+n<=Date.now()},kt=function(e,t,n,a){var r=e.get(t);if(-1===r.indexOf(n)){r=r.insert(a,n);e=e.set(t,r).set("_results",r).set("total",e.get("total")+1)}return e},Mt=function(e,t,n){var a=e.get(t),r=a.indexOf(n);if(-1!==r){a=a.delete(r);e=e.set(t,a).set("_results",a).set("total",e.get("total")-1)}return e};t.a=Object(i.defineFactory)().defineName("ElasticSearchStore").defineGetInitialState(a.Map).defineGet(function(e,t){var n=t.objectType,a=t.searchQuery,i=t.viewId,o=t.options,u=void 0===o?{}:o,l=t.overrideMinimumSearch,d=void 0!==l&&l,p=u.forceFetch,m=u.forceFetchIfExists;if(n){var h=xt(n,i);if(a){a=Rt({searchQuery:a,overrideMinimumSearch:d});var f=Nt(n,a),g=e.getIn(f);if(!g||Lt(g,u)||p||m&&g)Object(c.b)(s.cb,{objectType:n,searchQuery:a,options:u,viewId:i}).done();else if(g&&i){var b=e.getIn(h.concat(["searchQuery"])),O=e.getIn(xt(n,i));r.a.is(b,a)||O===g||Object(c.b)(s.gb,{objectType:n,viewId:i,results:g}).done()}if(g)return g}else if(i)return e.getIn(h)}}).defineResponseTo(s.bb,function(e,t){var n=t.objectType,r=t.searchQuery,i=t.viewId,o=t.error,s=Nt(n,r);if(!e.hasIn(s)){var c=Object(a.Map)().merge({searchQuery:r,fetchTime:Date.now(),error:o});e=e.setIn(s,c);i&&(e=e.setIn(xt(n,i),c))}return e}).defineResponseTo([s.eb,s.ab],function(e,t){var n=t.objectType,a=t.searchQuery,r=t.viewId,i=t.results,o=t.options,s=void 0===o?{}:o,c=Nt(n,a);i=i.merge({searchQuery:a,fetchTime:Date.now()});s.clearPages&&(e=e.deleteIn(At(n,a)));r&&(e=e.setIn(xt(n,r),i));return e.setIn(c,i)}).defineResponseTo(s.gb,function(e,t){var n=t.objectType,a=t.viewId,r=t.results;a&&(e=e.setIn(xt(n,a),r));return e}).defineResponseTo(s.fb,function(e,t){var n=t.objectType,a=t.fromSearchQuery,r=t.fromViewId,i=t.toSearchQuery,o=t.toViewId,s=t.toIndex,c=void 0===s?0:s,l=t.id,d=Object(u.a)(n).dataKey,p=At(n,a),m=e.getIn(p);if(m){m=m.map(function(e){return Mt(e,d,l)});e=e.setIn(p,m)}var h=At(n,i),f=e.getIn(h);if(f){f=f.map(function(e){return kt(e,d,l,c)});e=e.setIn(h,f)}var g=xt(n,r),b=e.getIn(g);b&&(e=e.setIn(g,Mt(b,d,l)));var O=xt(n,o),v=e.getIn(O);v&&(e=e.setIn(O,kt(v,d,l,c)));return e}).defineResponseTo(s.Z,function(e,t){var n=t.key;e.getIn(n)&&(e=e.setIn(n,void 0));return e}).register(o.a)},"G/lG":function(e,t,n){"use strict";var a=n("Xdd2"),r=n("emzX"),i=n.n(r),o=n("EvX1"),s=n.n(o),c=n("RRvD"),u=n("THQ/"),l=n.n(u),d=n("0HCf"),p=n.n(d),m=n("SYgn"),h=n.n(m),f=n("LZPL"),g=n.n(f),b=function(e){var t=e.getter,n=void 0===t?s.a:t,r=e.initialState,o=void 0===r?[]:r,u=e.name,d=e.onAuthLoad;i()("string"==typeof u&&""!==u,"Name for auth store must be provided");i()("function"==typeof d,"onAuthLoad must be provided and be a function");var m=l()({isAuthLoaded:!1,authData:o});return Object(a.defineFactory)().defineName("Auth-"+u).defineGetInitialState(m).defineGet(function(e){for(var t=e.isAuthLoaded,a=e.authData,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];if(!t){g.a.isProd()&&h.a.captureMessage("Attempted to access an Auth store without dispatching an AUTH_LOADED action",{extra:{args:i,name:u},level:"info"});p.a.warn({message:"Attempted to access an Auth store without dispatching an AUTH_LOADED action"})}return n.apply(void 0,[a].concat(i))}).defineResponseTo(c.c,function(e,t){return{isAuthLoaded:!0,authData:d(t)}})},O=n("AgF4"),v=b({getter:function(e,t){return t&&e.includes(t)},initialState:[],name:"IsUngatedStore",onAuthLoad:function(e){return e.gates}}).register(O.a);t.a=v},H3JF:function(e,t,n){"use strict";var a=n("2IIJ"),r=n("QYOI"),i=n("emzX"),o=n.n(i),s=n("D2Y9"),c="id";function u(e){o()(r.List.isList(e),"TicketsAPIQuery: expected ticketIds to be a List but got %s",e);return Object(r.Map)().set(c,e)}function l(e){return Object(s.stringify)(u(e).toJS())}var d=n("KLfa"),p=n("ap+s"),m=n("1RCs"),h=n("MQNR"),f=n("xHov");n.d(t,"d",function(){return j});n.d(t,"a",function(){return S});n.d(t,"b",function(){return y});n.d(t,"e",function(){return C});n.d(t,"c",function(){return E});var g="services/v1/tickets",b={"X-Properties-Source":m.c,"X-Properties-SourceId":m.e},O=function(e){return e.reduce(function(e,t,n){return e.set(String(n),a.a.fromJS(t))},Object(r.Map)())},v=function(e){return g+"/batch?"+e+"&allPropertiesFetchMode=latest_version"};function j(e){return f.c(v(l(e))).then(O)}function S(e){var t={object:e};return f.f({headers:b,type:p.d},g,t,a.a.fromJS)}function y(e){var t=e.propertyValues,n=e.requestedAssociatedObjects;return f.f({headers:b,type:p.d},"inbounddb-objects/v1/create-and-bulk-associate",{createObjectType:h.TICKET,propertyValues:t,requestedAssociatedObjects:n},function(e){return a.a.fromJS(e)})}function C(e,t){var n=e.get("objectId");return f.f({headers:b,type:p.e},g+"/"+n+"?allPropertiesFetchMode=latest_version",{ticketId:n,properties:t.reduce(function(e,t,n){e.push({name:n,value:t,source:m.e,sourceId:d.a.get().get("email")});return e},[])},a.a.fromJS)}function E(e){return f.b(g+"/"+e)}},ITHK:function(e,t,n){"use strict";var a,r=n("OwGx"),i=n("QYOI"),o=n("aitF"),s=n.n(o),c=n("D2Y9"),u=n("MQNR"),l=n("Zwtj"),d=n("aeBh"),p=n("Q6fd"),m=n("vNYB"),h=n("2IIJ"),f=n("KkgX"),g=n("9Z7B"),b=n("TvEW"),O=n("Wumz"),v=n("WJYQ"),j=n("a9fy"),S=n.n(j),y=n("RRvD"),C=(n("Nw75"),n("bC4p"),n("Ly8s")),E=(n("P4dz"),n("folk"),n("57l5"),n("YM6t"),n("ap+s"),n("xHov"),n("1RCs"),n("KLfa"),n("h/hJ"),n("7gk9")),T=n("bn2T"),I=(T.a,T.c,T.g,T.h,T.i,n("fBvv"));Object(i.Map)((a={},Object(r.a)(a,T.a,[{propertyNameV1:"activityType",propertyPathV1:["engagement","activityType"],propertyNameV2:"hs_activity_type"},{propertyNameV1:"body",propertyPathV1:["metadata","body"],propertyNameV2:"hs_call_body"},{propertyNameV1:"disposition",propertyPathV1:["metadata","disposition"],propertyNameV2:"hs_call_disposition"}]),Object(r.a)(a,T.c,[{propertyNameV1:"html",propertyPathV1:["metadata","html"],propertyNameV2:"hs_email_html"},{propertyNameV1:"plainText",propertyPathV1:["metadata","plainText"],propertyNameV2:"hs_email_text"}]),Object(r.a)(a,T.g,[{propertyNameV1:"activityType",propertyPathV1:["engagement","activityType"],propertyNameV2:"hs_activity_type"},{propertyNameV1:"body",propertyPathV1:["metadata","body"],propertyNameV2:"hs_meeting_body"},{propertyNameV1:"internalMeetingNotes",propertyPathV1:["metadata","internalMeetingNotes"],propertyNameV2:"hs_internal_meeting_notes"},{propertyNameV1:"endTime",propertyPathV1:["metadata","endTime"],propertyNameV2:"hs_meeting_end_time"},{propertyNameV1:"meetingOutcome",propertyPathV1:["metadata","meetingOutcome"],propertyNameV2:"hs_meeting_outcome"},{propertyNameV1:"startTime",propertyPathV1:["metadata","startTime"],propertyNameV2:"hs_meeting_start_time"},{propertyNameV1:"title",propertyPathV1:["metadata","title"],propertyNameV2:"hs_meeting_title"},{propertyNameV1:"webConferenceMeetingId",propertyPathV1:["metadata","webConferenceMeetingId"],propertyNameV2:"hs_meeting_web_conference_meeting_id"}]),Object(r.a)(a,T.h,[{propertyNameV1:"body",propertyPathV1:["metadata","body"],propertyNameV2:"hs_note_body"}]),Object(r.a)(a,T.i,[{propertyNameV1:"body",propertyPathV1:["metadata","body"],propertyNameV2:I.c},{propertyNameV1:"forObjectType",propertyPathV1:["metadata","forObjectType"],propertyNameV2:I.b},{propertyNameV1:"priority",propertyPathV1:["metadata","priority"],propertyNameV2:I.d},{propertyNameV1:"reminders",propertyPathV1:["metadata","reminders"],propertyNameV2:I.f,parser:function(e){return e?e.join(";"):void 0}},{propertyNameV1:"setDefaultReminder",propertyPathV1:["metadata","setDefaultReminder"],propertyNameV2:I.g},{propertyNameV1:"status",propertyPathV1:["metadata","status"],propertyNameV2:I.h},{propertyNameV1:"subject",propertyPathV1:["metadata","subject"],propertyNameV2:I.i},{propertyNameV1:"taskType",propertyPathV1:["metadata","taskType"],propertyNameV2:I.j},{propertyNameV1:"queueMembershipIds",propertyPathV1:["engagement","queueMembershipIds"],propertyNameV2:I.e}]),a)),Object(i.Map)({activityType:"hs_activity_type",createdAt:"hs_createdate",createdBy:"hs_created_by",engagementType:"hs_engagement_type",ownerId:"hubspot_owner_id",ownerIds:"hs_at_mentioned_owner_ids",timestamp:"hs_timestamp",attachments:"hs_attachment_ids"}),n("omic"),E.C,E.B,E.D,E.E;n("J92U");n("yTm7");var R=n("5mx2"),A=n("AgF4"),N=n("yMxc"),x=n("RaJY"),L=n("aBQC"),k=n.n(L),M=n("L9KA"),_=n("LwoF"),D=n("nDpY"),P=n.n(D),w=n("GgP/"),B=n.n(w);function F(){return B()().then(function(e){var t="OID:"+e.user.user_id+":"+P.a.get(),n=Object(M.getFrom)(localStorage,t);return k()(n)&&n>0?Promise.resolve(n):Object(_.e)().then(function(e){if(!e){Object(C.a)(y.Ab,Object(i.Map)({"-1":null}));return-1}var n=Object(x.a)(e);Object(M.setFrom)(localStorage,t,n);Object(C.a)(y.Ab,Object(i.Map)(Object(r.a)({},n,e)));return n})})}Object(N.a)({namespace:R.e,fetch:F}).defineName("CurrentOwnerIdStore").register(A.a);var U=n("emzX"),q=n.n(U);function G(e){return q()(i.Map.isMap(e),'EngagementsActions: expected engagements to be a Map but got "%s"')}n("7qCc"),S()(function(e){var t=-1===e?{}:{ownerId:e};return Object(i.fromJS)({engagement:Object.assign({},t,{type:u.TASK}),metadata:{status:"NOT_STARTED"}})});function V(e){G(e);Object(C.a)(y.Y,e)}var H,z=n("u7ju"),W=n("ZoqR"),K=n("Jy7Q"),Y=n("eUxV"),Q=n("vCNV"),J=n("ihjl");n.d(t,"a",function(){return ne});n.d(t,"b",function(){return ae});var X="sales-views/v2/crm-search/with-placeholders",Z="contacts/search/v1/search/",$=Object(i.Map)((H={},Object(r.a)(H,u.CONTACT,{updateStore:b.d,Record:d.a,dataKey:"contacts"}),Object(r.a)(H,u.COMPANY,{updateStore:g.b,Record:l.a,dataKey:"companies"}),Object(r.a)(H,u.DEAL,{updateStore:v.c,Record:p.a,dataKey:"deals"}),Object(r.a)(H,u.ENGAGEMENT,{updateStore:V,Record:m.a,dataKey:"engagements"}),Object(r.a)(H,u.TASK,{updateStore:V,Record:m.a,dataKey:"engagements"}),Object(r.a)(H,u.TICKET,{updateStore:z.c,Record:h.a,dataKey:"results"}),Object(r.a)(H,u.VISIT,{updateStore:W.b,Record:f.a,dataKey:"results"}),H)),ee=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var r=n.filter(function(e){return!!e});return r.length?e+"?"+r.join("&"):e},te=s()(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(i.Map)((e={},Object(r.a)(e,u.CONTACT,ee(Z+"contacts",Object(K.a)(),t)),Object(r.a)(e,u.COMPANY,ee(Z+"companies/v2",t)),Object(r.a)(e,u.DEAL,ee(Z+"deals",t)),Object(r.a)(e,u.ENGAGEMENT,Z+"engagements"),Object(r.a)(e,u.TASK,Z+"engagements"),Object(r.a)(e,u.TICKET,Z+"services/tickets?includeAllValues=true&allPropertiesFetchMode=latest_version"),Object(r.a)(e,u.VISIT,"companyprospects/v1/prospects/search"),e))});function ne(e){if(Object(Y.p)(e))return{updateStore:Q.c,Record:J.a,dataKey:"results"};var t=$.get(e);return Object(O.a)(e)?Object.assign({},t,{dataKey:"results"}):t}function ae(e,t){if(Object(Y.p)(e)||Object(O.a)(e)){var n=Object(c.stringify)(t);return X+(n?"?"+n:"")}return te(Object(c.stringify)(t)).get(e)}},Ig8d:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n("vTCD"),r=n("k8Et"),i=n("mNyx"),o=n("txVw"),s=n("pGTB"),c=n("QYOI"),u=function(e){Object(s.a)(t,e);function t(){Object(a.a)(this,t);return Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}Object(r.a)(t,[{key:"setEngagementType",value:function(e){var t=this.engagement.merge({type:e});return this.set("engagement",t)}},{key:"setOwnerId",value:function(e){if(-1===e)return this;var t=this.engagement.merge({ownerId:e});return this.set("engagement",t)}},{key:"setTeamId",value:function(e){var t=this.engagement.merge({teamId:e});return this.set("engagement",t)}},{key:"setObjectAssociation",value:function(e){var t=this.associations.mergeDeep(e);return this.set("associations",t)}}]);return t}(Object(c.Record)({engagement:Object(c.Map)(),associations:Object(c.Map)(),attachments:Object(c.List)(),metadata:Object(c.Map)({body:"",plainText:""}),inviteeEmails:Object(c.Set)(),savable:!1,queueId:null,richTextEditorResults:null,internalRichTextEditorResults:null,rawEditorContent:null,rawInternalNoteEditorContent:null,selectedFollowUpCategory:null,includeFollowUpTask:null},"InteractionRecord"))},JMwr:function(e,t,n){"use strict";n.r(t);var a=n("vTCD"),r=n("k8Et"),i=n("mNyx"),o=n("txVw"),s=n("pGTB"),c=n("QgEn"),u=n("VfuR"),l=n.n(u),d=n("Ktcs"),p=n("os+u"),m=n.n(p),h=n("fzi9"),f=n("mDbF"),g=n.n(f),b=n("Xdd2"),O=n("sld6"),v=n("DSKb"),j=5,S=50,y=345,C=n("muUi"),E=n("Ykb2"),T=n("tPYf"),I=n("MQNR"),R=n("AgF4"),A=n("3y0f"),N=n("RRvD"),x=n("wfCi"),L=n("bkwg"),k=n("QYOI"),M=n("P4dz"),_=n("U0r4"),D="DEALS";Object(_.a)({actionTypePrefix:D,fetcher:x.d});var P=Object(L.a)({actionTypePrefix:D}).defineResponseTo(N.N,function(e,t){var n=""+t.get("dealId");return e.set(n,t)}).defineResponseTo(N.L,function(e,t){var n=t.id,a=t.nextProperties;return e.has(n)?e.updateIn([n],function(e){return a.reduce(function(e,t,n){return Object(M.f)(e,n,t)},e)}):e}).defineResponseTo(N.M,function(e,t){var n=t.id,a=t.deal;return e.set(n,a)}).defineResponseTo(N.K,function(e,t){var n=t.id,a=t.nextProperties,r=t.properties;return e.updateIn([n],function(e){return r.reduce(function(e,t,n){return a.get(n)!==Object(M.d)(e,n)?e:Object(M.f)(e,n,t)},e)})}).defineResponseTo(A.b,function(e,t){var n=t.objectId,a=""+t.subjectId;return e.get(a)?e.setIn([a,"associations","associatedCompanyIds"],k.List.of(n)):e}).defineResponseTo(A.j,function(e,t){var n=""+t.subjectId;return e.get(n)?e.setIn([n,"associations","associatedCompanyIds"],Object(k.List)()):e}).defineResponseTo(A.e,function(e,t){var n=t.objectId,a=""+t.subjectId;if(!e.get(a))return e;var r=[a,"associations","associatedVids"],i=e.getIn(r)||Object(k.List)();if(!i.contains(n)){i=i.push(n);e=e.setIn(r,i)}return e}).defineResponseTo(A.m,function(e,t){var n=t.objectId,a=""+t.subjectId;if(!e.get(a))return e;var r=[a,"associations","associatedVids"],i=e.getIn(r),o=i.indexOf(n);if(o>-1){i=i.remove(o);e=e.setIn(r,i)}return e}).register(R.a),w=n("5mx2"),B=n("0dUV"),F=n("xHov"),U=n("7GwH"),q=100,G="associations/v1/associations/",V=function(e){return e.reduce(function(e,t){var n=t.get("objectType"),a=U.a.get(t.get("associationType"));e.objectIdsByType&&e.objectIdsByType[n]?e.objectIdsByType[n]=e.objectIdsByType[n].add(t.get("objectId")):e.objectIdsByType[n]=Object(k.Set)([t.get("objectId")]);e.associationTypeIdsByCategory.HUBSPOT_DEFINED.includes(a)||e.associationTypeIdsByCategory.HUBSPOT_DEFINED.push(a);return e},{objectIdsByType:{},associationTypeIdsByCategory:{HUBSPOT_DEFINED:[]}})},H=function(e){return e.reduce(function(e,t){var n=""+t.get("fromObjectId"),a=t.get("fromObjectType"),r=U.a.findKey(function(e){return e===t.get("associationTypeId")});return e.set(Object(k.Map)({objectType:a,associationType:r,objectId:n}),t.get("results"))},Object(k.Map)()).map(function(e){return e.update("results",function(e){return e.reverse()})})};function z(e){if(1===e.groupBy(function(e){return Object(k.List)([e.get("objectId"),e.get("objectType")])}).size){var t=V(e);return F.d(G+"first-page-batch?limitPerType="+q,t).then(H)}var n=e.groupBy(function(e){return e.get("associationType")}).flatMap(function(e){return e.groupBy(function(e,t){return Object(k.List)([e.get("associationType"),Math.floor(t/100)])})}).map(function(e){var t=V(e);return F.d(G+"first-page-batch?limitPerType="+q,t)});return Promise.all(n.valueSeq().toArray()).then(function(e){return e.reduce(function(e,t){return e.concat(t)},Object(k.List)())}).then(H)}n("eVil");var W=n("aORY"),K=n.n(W),Y=(Object(k.Set)(["hs_expiration_date","hs_payment_date","hs_esign_date","hs_createdate","hs_lastmodifieddate"]),Object(k.Set)(["hs_show_signature_box","hs_show_countersignature_box","hs_payment_enabled","hs_esign_enabled","hs_locked"]),Object(k.List)(),Object(k.List)(),Object(k.List)(),Object(k.List)(),Object(k.List)(),Object(k.List)(),K()({QUOTE_TO_DEAL:null,QUOTE_TO_LINE_ITEM:null,QUOTE_TO_CONTACT:null,QUOTE_TO_COMPANY:null,QUOTE_TO_QUOTE_TEMPLATE:null}));Object(k.OrderedMap)({firstname:"hs_sender_firstname",lastname:"hs_sender_lastname",email:"hs_sender_email",jobtitle:"hs_sender_jobtitle",phone:"hs_sender_phone"}),Object(k.OrderedMap)({name:"hs_sender_company_name",domain:"hs_sender_company_domain",address:"hs_sender_company_address",address2:"hs_sender_company_address2",city:"hs_sender_company_city",zip:"hs_sender_company_zip",state:"hs_sender_company_state",country:"hs_sender_company_country",imageUrl:"hs_sender_company_image_url"});function Q(e){return Object(M.a)(e.quote)}function J(e){return e.associations[Y.QUOTE_TO_DEAL].first()}var X=n("7gk9");function Z(e){return k.Iterable.isIterable(e)||Array.isArray(e)}var $=function(e){if(k.Map.isMap(e))return e;var t=e.objectType,n=e.objectId,a=e.associationType;return Object(k.Map)({objectType:t,associationType:a,objectId:String(n)})};Object(B.b)({idTransform:$,namespace:w.a,fetch:z});var ee=Object(B.a)({idTransform:$,namespace:w.a,idIsValid:function(e){if(!e)return!1;var t=e.objectType,n=e.objectId;return t&&n}}).defineName("AssociationsStore").defineResponseTo(N.Kb,function(e,t){if(!t)return e;var n=J(t),a=$({objectType:I.DEAL,objectId:n,associationType:X.z});return e.has(a)?e.updateIn([a,"results"],function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(k.List)()).concat(Q(t))}):e}).defineResponseTo(N.xb,function(e,t){var n=t.objectId,a=t.associationsAdded,r=t.fromObjectType,i=t.toObjectType,o=e,s=$({objectType:r,objectId:n,associationType:r+"_TO_"+i});e.has(s)&&(o=e.updateIn([s,"results"],Object(k.List)(),function(e){return e.concat(Object(k.fromJS)(a))}));return a.reduce(function(e,t){s=$({objectType:i,objectId:t,associationType:i+"_TO_"+r});return e.has(s)?e.updateIn([s,"results"],Object(k.List)(),function(e){return e.concat(Object(k.fromJS)([+n]))}):e},o)}).defineResponseTo(N.yb,function(e,t){var n=t.objectId,a=t.associationsRemoved,r=t.fromObjectType,i=t.toObjectType,o=e,s=$({objectType:r,objectId:n,associationType:r+"_TO_"+i}),c=Z(a)?a:[a];e.has(s)&&(o=e.updateIn([s,"results"],function(e){return Object(k.Set)(e).subtract(c).toList()}));return c.reduce(function(e,t){s=$({objectType:i,objectId:t,associationType:i+"_TO_"+r});return e.has(s)?e.updateIn([s,"results"],function(e){return e.filterNot(function(e){return e===+n})}):e},o)}).register(R.a),te=n("AF1D"),ne=n("m9st"),ae=n("X3fw"),re="COMPANIES";Object(_.a)({actionTypePrefix:re,fetcher:ae.c,fetchLimit:250});var ie=Object(L.a)({actionTypePrefix:re}).defineResponseTo(N.k,function(e,t){var n=""+t.get("companyId");return e.set(n,t)}).defineResponseTo(N.i,function(e,t){var n=t.id,a=t.nextProperties;return e.updateIn([n],function(e){return a.reduce(function(e,t,n){return Object(M.f)(e,n,t)},e)})}).defineResponseTo(N.h,function(e,t){var n=t.id,a=t.nextProperties,r=t.properties;return e.updateIn([n],function(e){return r.reduce(function(e,t,n){return a.get(n)!==Object(M.d)(e,n)?e:Object(M.f)(e,n,t)},e)})}).defineResponseTo(N.n,function(e,t){var n=t.domain,a=""+t.company.get("companyId");return e.updateIn([a],function(e){var t=e.get("additionalDomains").filter(function(e){return e.get("domain")!==n});return e.set("additionalDomains",t)})}).defineResponseTo(A.l,function(e,t){var n=""+t.subjectId;return e.get(n)?e.update(n,function(e){var t=Object(M.d)(e,"num_associated_contacts"),n=parseInt(t,10)-1;return Object(M.f)(e,"num_associated_contacts",n)}):e}).defineResponseTo(A.d,function(e,t){var n=""+t.subjectId;return e.get(n)?e.update(n,function(e){var t=Object(M.d)(e,"num_associated_contacts")||0,n=parseInt(t,10)+1;return Object(M.f)(e,"num_associated_contacts",n)}):e}).register(R.a),oe=n("H3JF"),se=n("tuMY"),ce=n.n(se);Object(B.b)({namespace:w.s,fetch:oe.d});var ue=Object(B.a)({namespace:w.s,idIsValid:function(e){return"string"==typeof e||"number"==typeof e},idTransform:ce.a}).defineResponseTo(N.Xb,function(e,t){var n=t.objectId;return e.set(n,t)}).defineResponseTo([N.bc,N.cc],function(e,t){var n=t.id,a=t.nextProperties;return e.has(n)?e.updateIn([n],function(e){return a.reduce(function(e,t,n){return Object(M.f)(e,n,t)},e)}):e}).defineResponseTo(N.ac,function(e,t){var n=t.id,a=t.nextProperties,r=t.properties;return e.updateIn([n],function(e){return r.reduce(function(e,t,n){return a.get(n)!==Object(M.d)(e,n)?e:Object(M.f)(e,n,t)},e)})}).defineName("TicketsStore").register(R.a),le=n("Nw75"),de=n("/XSg"),pe=n("EvX1"),me=n.n(pe),he={CONTACT:ne.a,COMPANY:ie,DEAL:P,TICKET:ue},fe={CONTACT:"contacts",DEAL:"deals",COMPANY:"companies",TICKET:"results"},ge={cacheTimeout:3e4};function be(e){return e.filter(me.a).map(function(e){var t=Object(M.a)(e),n=Object(M.c)(e);return{id:t,objectType:n,record:e,text:Object(M.h)(e),value:n+" "+t}}).sortBy(function(e){return e.text.toLowerCase()}).toArray()}function Oe(e){var t=Object(de.b)(e)?0:E.a;return e.length>=t}function ve(e,t){if(!e||!e.size)return[];var n=he[t].get(e).filterNot(function(e){return!e});return n&&n.size?be(n):le.b}function je(e,t){if(!e||!e[t]||!e[t].length)return Object(k.List)();var n=e[t].map(function(e){return Number(e.split(" ")[1])});return Object(k.List)(n)}function Se(e,t,n){var a=fe[n],r=te.a.get({objectType:n,searchQuery:t,options:ge});return r?ve(r.get(a),n):le.b}function ye(e,t,n,a){if(!t||"null"===t)return[];var r=ee.get({objectType:e,objectId:t,associationType:n});return r?ve(r.get("results"),a):le.b}function Ce(e){var t=je(e,"contactValues");return be(t?ne.a.get(t):Object(k.List)())}function Ee(e){var t=e.objectType,n=e.subjectId,a=e.subject,r=[],i=Ce(e.values);t===I.CONTACT&&"null"!==n&&(r=be(Object(k.List)([a])));t===I.COMPANY?r=ye(t,n,t+"_TO_CONTACT",I.CONTACT):t===I.DEAL?r=ye(t,n,X.x,I.CONTACT):t===I.TICKET&&(r=ye(t,n,X.O,I.CONTACT));return Object(k.List)(i.concat(r||[])).reduce(function(e,t){return e.set(t.id,t)},Object(k.Map)()).sortBy(function(e){return e.text.toLowerCase()}).toArray()}var Te=n("d0Ul");function Ie(e){var t=je(e,"dealValues");return be(t?P.get(t):Object(k.List)())}function Re(e){var t=e.objectType,n=e.subjectId,a=e.subject,r=e.state,i=e.values,o=r.debouncedSearchTextForElasticSearch,s=Ie(i),c=[];if(t===I.DEAL)c=be(Object(k.List)([a]));else{if(((c=ye(t,n,t+"_TO_DEAL",I.DEAL))&&c.length)>j&&Oe(o)){c=Se(n,Te.a.associatedDeal(t,n,S,o),I.DEAL)}}return Object(k.List)(s.concat(c||[])).reduce(function(e,t){return e.set(t.id,t)},Object(k.Map)()).sortBy(function(e){return e.text.toLowerCase()}).toArray()}var Ae=n("Eha6"),Ne={getChildren:function(e){var t="companies/v2/families/"+e+"/children/with-total?limit=5";return Object(F.c)(t)},addChild:function(e){var t="companies/v2/families/"+e.parentId+"/associations?childCompanyId="+e.childId;return Object(F.e)(t)},removeChild:function(e){var t="companies/v2/families/"+e.parentId+"/associations?childCompanyId="+e.childId;return Object(F.a)(t)}},xe=function(){return Object(k.Map)().set("results",Object(k.List)()).set("total",0)},Le=Object(Ae.a)(function(e){return Ne.getChildren(e)},"CompaniesChildrenAPI.getChildren");Object(B.b)({namespace:w.b,fetch:Le});var ke=Object(B.a)({namespace:w.b,idIsValid:function(e){return"string"==typeof e}}).defineName("CompaniesChildrenStore").defineResponseTo([N.o],function(e,t){var n=t.parentId,a=t.childId,r=e.get(n,xe());return e.set(n,r.set("results",r.get("results").push(a)).set("total",r.get("total")+1))}).defineResponseTo([N.p],function(e,t){var n=t.parentId,a=t.childId,r=e.get(n,xe());return e.set(n,r.set("results",r.get("results").filterNot(function(e){return e===a})).set("total",r.get("total")-1))}).register(R.a),Me=n("cxUl");function _e(e){var t=ie.get(e);return t?be(Object(k.List)([t])):[]}function De(e,t,n){var a=Se(e,Me.a.associatedWithChidren(e,S,n),t),r=a&&a.get("companies");return r&&r.size?ie.get(r):Object(k.List)()}function Pe(e,t,n){Object(k.List)();var a=ke.get(t),r=a&&a.get("results");return r&&r.size?be(r.size<=j?ie.get(a.get("results")).filterNot(function(e){return void 0!==e}):De(t,e,n)):[]}function we(e,t,n,a){var r=Number(Object(M.d)(t,"hs_parent_company_id")),i=Object(k.List)();r&&(i=i.concat(_e(r)));i=i.concat(Pe(n,e,a));var o=be(Object(k.List)([t]));return i.concat(o)}function Be(e){var t=je(e,"companyValues");return be(t?ie.get(t):Object(k.List)())}function Fe(e){var t=e.objectType,n=e.subjectId,a=e.subject,r=e.state,i=e.values,o=r.debouncedSearchTextForElasticSearch,s=[],c=Be(i);if(t===I.CONTACT){var u=Object(M.d)(a,"associatedcompanyid");u&&(s=ve(Object(k.List)([u]),I.COMPANY))}else t===I.COMPANY?s=we(n,a,t,o):[I.DEAL,I.TICKET].includes(t)&&(s=ye(t,n,t+"_TO_COMPANY",I.COMPANY));return Object(k.List)(c).concat(s||[]).reduce(function(e,t){return e.set(t.id,t)},Object(k.Map)()).sortBy(function(e){return e.text.toLowerCase()}).toArray()}var Ue=n("/cKn");function qe(e){var t=je(e,"ticketValues");return be(t?ue.get(t):Object(k.List)())}function Ge(e){var t=e.objectType,n=e.subjectId,a=e.subject,r=e.state,i=e.values,o=r.debouncedSearchTextForElasticSearch,s=qe(i),c=[];if(t===I.TICKET)c=be(Object(k.List)([a]));else if((c=ye(t,n,t+"_TO_TICKET",I.TICKET))&&c.length>j&&Oe(o)){c=Se(n,Ue.a.associatedTickets(t,n,S,o),I.TICKET)}return Object(k.List)(s.concat(c||[])).reduce(function(e,t){return e.set(t.id,t)},Object(k.Map)()).sortBy(function(e){return e.text.toLowerCase()}).toArray()}var Ve,He=n("ITHK"),ze=n("aZYI"),We=n("E7+s"),Ke=n("v95M"),Ye=n("Sx0/"),Qe=n.n(Ye),Je=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.getSearchText||ze.a,r=n.stores||[],i=n.minimumSearchLength||E.a,o=n.getFilterGroups||Qe.a;return{stores:r.concat([e,te.a]),deref:function(n,r){var s=a(n,r),c=n.state&&n.state.overrideMinimumSearch;if(!s||!Object(de.a)(s)&&!c&&s.length<i)return We.b;var u=Ke.a.default(Object(k.fromJS)({query:s,count:25}),t),l=o(n.objectType);l&&(u=u.set("filterGroups",l));var d={cacheTimeout:5e3},p=te.a.get({objectType:t,searchQuery:u,options:d,overrideMinimumSearch:c}),m=Object(He.a)(t).dataKey;return p&&p.get(m)?be(e.get(p.get(m))):We.b}}},Xe=n("aitF"),Ze=n.n(Xe),$e=function(e){var t=e.searchText;return!!t.length&&Object(de.b)(t)},et=Ze()(function(e,t){if(!t)return!1;var n=Object.keys(t).reduce(function(e,n){return e=e.concat(t[n])},[]);return 1===n.length&&n[0]===e}),tt=Ze()(function(e,t,n){return e&&e.map(function(e){var a=e.text,r=e.value;return{text:a,value:r,disabled:!n&&et(r,t)}})}),nt=Je(ne.a,I.CONTACT,{filterOptions:!1,minimumSearchLength:E.a}).deref,at=Je(ie,I.COMPANY,{filterOptions:!1,minimumSearchLength:E.a}).deref,rt=Je(P,I.DEAL,{filterOptions:!1,minimumSearchLength:E.a}).deref,it=Je(ue,I.TICKET,{filterOptions:!1,minimumSearchLength:E.a}).deref,ot={propTypes:{objectType:T.b.isRequired,subjectId:l.a.string,subject:l.a.object,values:l.a.object},stores:[P,ne.a,ie,ue,te.a,ee],deref:function(e){var t=e.canRemoveLastAssociation,n=void 0!==t&&t,a=e.objectType,r=e.searchText,i=e.debouncedSearchTextForElasticSearch,o=e.subjectId,s=e.subject,c=e.objectTypesToAssociate,u=e.values;return[{objectTypeLabel:I.CONTACT,fetcher:$e({searchText:r})?nt:Ee},{objectTypeLabel:I.COMPANY,fetcher:$e({searchText:r})?at:Fe},{objectTypeLabel:I.DEAL,fetcher:$e({searchText:r})?rt:Re},{objectTypeLabel:I.TICKET,fetcher:$e({searchText:r})?it:Ge}].filter(function(e){var t=e.objectTypeLabel;return c.includes(t)}).map(function(e){var t=e.objectTypeLabel,c=e.fetcher;return{text:g.a.text("customerDataCommunicator.MultipleAssociationsSelect."+t),options:tt(c({objectType:a,subjectId:o,subject:s,state:{searchText:r,debouncedSearchTextForElasticSearch:i},values:u}),u,n)}})}},st=n("6dOn"),ct=n.n(st),ut=n("wBEU"),lt=n.n(ut),dt=n("jqvl"),pt=n.n(dt),mt=n("46u0"),ht=n.n(mt),ft=n("pPiP"),gt=n.n(ft),bt=n("OwGx"),Ot=n("vuW9"),vt=n("kEfQ"),jt=n("bn2T"),St=l.a.oneOf([jt.a,jt.b,jt.c,jt.d,jt.e,jt.f,jt.i,jt.g,jt.h,vt.CALL,vt.EMAIL,vt.LOGGED_CALL,vt.LOGGED_EMAIL,vt.LOGGED_MEETING,vt.NOTE,vt.SCHEDULE,vt.TASK]),yt=Object(k.Map)((Ve={},Object(bt.a)(Ve,jt.a,"customerDataCommunicator.engagementAndInteractionTypesPlural.CALL"),Object(bt.a)(Ve,jt.b,"customerDataCommunicator.engagementAndInteractionTypesPlural.CONVERSATION_SESSION"),Object(bt.a)(Ve,"default","customerDataCommunicator.engagementAndInteractionTypesPlural.default"),Object(bt.a)(Ve,jt.c,"customerDataCommunicator.engagementAndInteractionTypesPlural.EMAIL"),Object(bt.a)(Ve,jt.d,"customerDataCommunicator.engagementAndInteractionTypesPlural.EMAIL_ACTIVITY"),Object(bt.a)(Ve,jt.e,"customerDataCommunicator.engagementAndInteractionTypesPlural.FORWARDED_EMAIL"),Object(bt.a)(Ve,jt.f,"customerDataCommunicator.engagementAndInteractionTypesPlural.INCOMING_EMAIL"),Object(bt.a)(Ve,vt.CALL,"customerDataCommunicator.engagementAndInteractionTypesPlural.call"),Object(bt.a)(Ve,vt.EMAIL,"customerDataCommunicator.engagementAndInteractionTypesPlural.email"),Object(bt.a)(Ve,vt.LOGGED_CALL,"customerDataCommunicator.engagementAndInteractionTypesPlural.logged-call"),Object(bt.a)(Ve,vt.LOGGED_EMAIL,"customerDataCommunicator.engagementAndInteractionTypesPlural.logged-email"),Object(bt.a)(Ve,vt.LOGGED_MEETING,"customerDataCommunicator.engagementAndInteractionTypesPlural.logged-meeting"),Object(bt.a)(Ve,vt.NOTE,"customerDataCommunicator.engagementAndInteractionTypesPlural.note"),Object(bt.a)(Ve,vt.SCHEDULE,"customerDataCommunicator.engagementAndInteractionTypesPlural.schedule"),Object(bt.a)(Ve,vt.TASK,"customerDataCommunicator.engagementAndInteractionTypesPlural.task"),Object(bt.a)(Ve,jt.g,"customerDataCommunicator.engagementAndInteractionTypesPlural.MEETING"),Object(bt.a)(Ve,jt.h,"customerDataCommunicator.engagementAndInteractionTypesPlural.NOTE"),Object(bt.a)(Ve,jt.i,"customerDataCommunicator.engagementAndInteractionTypesPlural.TASK"),Ve)),Ct=yt.get("default"),Et=function(e){var t=e.engagementOrInteractionType,n=e.children,a=e.option,r=Object(d.useCallback)(function(e){e.stopPropagation()},[]);if(a.disabled){var i=yt.get(t,Ct),o=Object(c.jsx)(ht.a,{message:"customerDataCommunicator.MultipleAssociationsSelect.lastAssociationToolTip",options:{engagementOrInteractionType:g.a.text(i)}});return Object(c.jsx)(Ot.a,{placement:"bottom left",title:o,children:n})}return Object(c.jsx)(Ot.a,{placement:"right",title:a.text,onMouseDown:r,children:n})},Tt=function(e,t){var n=t.children,a=t.option;return Object(c.jsx)(Et,{engagementOrInteractionType:e,option:a,children:n})};Et.propTypes={engagementOrInteractionType:St.isRequired,children:l.a.node.isRequired,option:l.a.object.isRequired};var It=Tt,Rt=n("G/lG"),At=n("kJ/w"),Nt={isUngatedForCompactTimeline:l.a.bool,subject:T.a,subjectId:l.a.string},xt=Object.assign({buttonUse:l.a.string,className:l.a.string,handleRemove:l.a.func.isRequired,handleSelect:l.a.func.isRequired,menuWidth:l.a.number,minimumSearchLength:l.a.number,onCloseSelect:l.a.func,onOpenSelect:l.a.func,optionMatches:l.a.array,placeholderText:l.a.node,popoverPlacement:l.a.string,values:l.a.object,engagementOrInteractionType:St.isRequired},Nt),Lt={searchText:l.a.string.isRequired,setSearchText:l.a.func.isRequired,debouncedSearchTextForElasticSearch:l.a.string.isRequired,setDebouncedSearchTextForElasticSearch:l.a.func.isRequired},kt=Object.assign({},xt,{},Lt),Mt={minimumSearchLength:E.a,onCloseSelect:Qe.a,onOpenSelect:Qe.a,buttonUse:"transparent",menuWidth:y},_t=function(e){Object(s.a)(t,e);function t(e){var n;Object(a.a)(this,t);(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).handleSearchTextForElasticSearchChange=function(e){n.props.setDebouncedSearchTextForElasticSearch(e)};n.handleSelect=function(e){var t=e.target.value,a=n.getFlattenedValues(),r=t.filter(function(e){return!a.includes(e)}),i=a.filter(function(e){return!t.includes(e)});return r.length?n.addValue(r):n.removeValue(i)};n.handleInputValueChange=function(e){var t=e.target.value;n.props.setSearchText(t);n.handleDebouncedSearchTextChange(t)};n.handleOpenChange=function(e){if(e.target.value){n.props.setSearchText("");n.props.setDebouncedSearchTextForElasticSearch("");n.props.onOpenSelect()}else n.props.onCloseSelect()};n.partial=Ze()(gt.a);n.handleDebouncedSearchTextChange=ct()(200,n.handleSearchTextForElasticSearchChange);return n}Object(r.a)(t,[{key:"parseValue",value:function(e){if(e&&0!==e.length){var t=e[0].split(" "),n=Object(h.a)(t,2),a=n[0],r=n[1];return[a,Number(r)]}}},{key:"addValue",value:function(e){var t=this.parseValue(e),n=Object(h.a)(t,2),a=n[0],r=n[1];this.props.handleSelect(a,r)}},{key:"removeValue",value:function(e){var t=this.parseValue(e),n=Object(h.a)(t,2),a=n[0],r=n[1];this.props.handleRemove(a,r)}},{key:"getNoResultsText",value:function(){var e=this.props,t=e.minimumSearchLength,n=e.searchText,a=n.length;if(a>0&&a<t&&!Object(de.a)(n)){var r=t-a;return g.a.text("salesUI.UISearchInput.minimumSearchMessage",{count:r})}}},{key:"getPlaceholderText",value:function(){var e=this.props,t=e.isUngatedForCompactTimeline,n=e.values,a=0;if(!n)return null;var r=Object.keys(n).reduce(function(e,t){return e+n[t].length},a);return t?Object(c.jsx)(ht.a,{message:"customerDataCommunicator.MultipleAssociationsSelect.compactLabel",options:{count:r}}):r>0?Object(c.jsx)(pt.a,{message:"customerDataCommunicator.MultipleAssociationsSelect.placeholderText.some",options:{count:r}}):Object(c.jsx)(pt.a,{message:"customerDataCommunicator.MultipleAssociationsSelect.placeholderText.none",options:{count:r}})}},{key:"getFlattenedValues",value:function(){var e=this.props.values;return Object.keys(e).reduce(function(t,n){return t=t.concat(e[n])},[])}},{key:"isLoadingResults",value:function(){return lt()(function(e){return Object(We.d)(e.options)},this.props.optionMatches)}},{key:"render",value:function(){var e=this.props,t=e.buttonUse,n=e.className,a=e.engagementOrInteractionType,r=e.menuWidth,i=e.onCloseSelect,o=e.onOpenSelect,s=e.optionMatches,u=e.placeholderText,l=e.popoverPlacement;return Object(c.jsx)(O.a,{align:"center",children:Object(c.jsx)(v.a,{"data-selenium-test":"multiple-associations-select",anchorType:"button",backspaceRemoves:!1,multi:!0,buttonUse:t,className:n,menuWidth:r,minimumSearchCount:0,onClose:i,onOpen:o,onChange:this.handleSelect,onOpenChange:this.handleOpenChange,placement:l||"top left",onInputValueChange:this.handleInputValueChange,isLoading:this.isLoadingResults(),placeholder:u||this.getPlaceholderText(),_forcePlaceholder:!0,value:this.getFlattenedValues(),noResultsText:this.getNoResultsText(),options:s,searchPlaceholder:g.a.text("customerDataCommunicator.MultipleAssociationsSelect.placeholderSearch"),itemComponent:this.partial(It,a)})})}}]);return t}(C.a);_t.propTypes=kt;_t.componentPropTypes=xt;_t.defaultProps=Mt;var Dt=Object(b.connect)({isUngatedForCompactTimeline:{stores:[Rt.a],deref:function(){return Object(At.a)("CRM:CompactTimeline",Rt.a.get("CRM:CompactTimeline"))}},optionMatches:ot})(_t);function Pt(e){var t=Object(d.useState)(""),n=Object(h.a)(t,2),a=n[0],r=n[1],i=Object(d.useState)(""),o=Object(h.a)(i,2),s=o[0],u=o[1];return Object(c.jsx)(Dt,Object.assign({},e,{searchText:a,setSearchText:r,debouncedSearchTextForElasticSearch:s,setDebouncedSearchTextForElasticSearch:u}))}Pt.propTypes=Dt.componentPropTypes;Pt.defaultProps=Dt.defaultProps;var wt,Bt=Pt;wt={},Object(bt.a)(wt,I.CONTACT,"contactIds"),Object(bt.a)(wt,I.COMPANY,"companyIds"),Object(bt.a)(wt,I.DEAL,"dealIds"),Object(bt.a)(wt,I.TICKET,"ticketIds");function Ft(e,t){return t?t.map(function(t){return e+" "+t}).toArray():[]}function Ut(e){if(e.isEmpty())return{};var t=e.get("contactIds"),n=Ft(I.CONTACT,t),a=e.get("companyIds"),r=Ft(I.COMPANY,a),i=e.get("dealIds"),o=Ft(I.DEAL,i),s=e.get("ticketIds");return{contactValues:n,companyValues:r,dealValues:o,ticketValues:Ft(I.TICKET,s)}}var qt={subjectId:l.a.string.isRequired,objectType:T.b,subject:T.a.isRequired,associations:m.a.map.isRequired,onUpdateAssociation:l.a.func.isRequired,onRemoveAssociation:l.a.func.isRequired,objectTypesToAssociate:l.a.array,handleUsageLogging:l.a.func.isRequired,logUsageTrackingEvent:l.a.func,engagementType:l.a.string},Gt={logUsageTrackingEvent:Qe.a};function Vt(e){var t=function(t){Object(s.a)(n,t);function n(){var e,t;Object(a.a)(this,n);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];(t=Object(i.a)(this,(e=Object(o.a)(n)).call.apply(e,[this].concat(s)))).handleRemoveAssociation=function(e,n){var a=t.props.engagementType;t.props.logUsageTrackingEvent({eventKey:"communicatorInteraction",action:"Remove association",engagementType:a});t.props.onRemoveAssociation(e,n)};t.handleUpdateAssociation=function(e,n){var a=t.props.engagementType;t.props.logUsageTrackingEvent({eventKey:"communicatorInteraction",action:"Add association",engagementType:a});t.props.onUpdateAssociation(e,n)};return t}Object(r.a)(n,[{key:"render",value:function(){var t=this,n=this.props,a=n.associations,r=n.engagementType,i=n.objectType,o=n.objectTypesToAssociate,s=n.subject,u=n.subjectId,l=n.handleUsageLogging;return Object(c.jsx)(e,Object.assign({},this.props,{renderTray:function(){return Object(c.jsx)("div",{style:{alignItems:"flex-start",position:"absolute",right:16,zIndex:1},children:Object(c.jsx)(Bt,{handleRemove:t.handleRemoveAssociation,handleSelect:t.handleUpdateAssociation,objectType:i,objectTypesToAssociate:o,subject:s,subjectId:u,values:Ut(a),handleUsageLogging:l,engagementType:r,engagementOrInteractionType:r})})}}))}}]);return n}(d.Component);t.propTypes=qt;t.propTypes=Gt;return t}t.default=Vt},KE9x:function(e,t,n){"use strict";n.r(t);var a={};n.r(a);n.d(a,"toLocalInteraction",function(){return Lu});n.d(a,"toInteractionRecord",function(){return ku});var r={};n.r(r);n.d(r,"toLocalInteraction",function(){return Bu});n.d(r,"toInteractionRecord",function(){return Fu});var i=n("vTCD"),o=n("k8Et"),s=n("mNyx"),c=n("txVw"),u=n("UMxk"),l=n("pGTB"),d=n("QgEn"),p=n("QYOI"),m=n("Ktcs"),h=n("VfuR"),f=n.n(h),g=n("os+u"),b=n.n(g),O=n("t6nY"),v=n.n(O),j=n("8ctk"),S=n.n(j),y=n("aitF"),C=n.n(y),E=n("jqvl"),T=n.n(E),I=n("mKxs"),R=n("L9KA"),A=n("MQNR"),N=n("nm0D"),x=Object(N.b)(function(e,t){var a=n("PeaV"),r=n("uYow"),i=r.default||r,o=n("txDU"),s=o.default||o,c=n("ROLi"),u=n("WvCC").define;u("hubspot.customerdata.rte.components.RichTextEditor",[],function(){return s});u("hubspot.customerdata.rte.state.RichTextEditorContentMediator",[],function(){return i});u("hubspot.customerdata.rte.config.RichTextEditorDefaultConfigurations",[],function(){return a});c.initRteConfig(e,t)}),L=n("LB2W"),k=n("zXnf"),M=n("Xdd2"),_=n("5mx2"),D=n("AgF4"),P=n("37ae"),w=n.n(P),B=n("RaJY"),F=n("yMxc"),U=n("Iie8"),q=n.n(U),G=n("LwoF"),V=n("8QMF"),H=n.n(V),z=n("EYIQ"),W=n.n(z),K=H()(W()(function(e){var t=e.email,n=e.firstName,a=e.lastName;return(w()({firstName:n,lastName:a})+" "+t).toLowerCase()}),q()(B.a)),Y=Object(F.a)({namespace:_.j,fetch:G.f,responseTransform:K}).defineName("LegacyActiveOwnerIdsStore").register(D.a),Q=n("EvX1"),J=n.n(Q),X=n("eVil"),Z=n.n(X),$=n("E7+s"),ee=n("RRvD"),te=n("DLPV"),ne=n.n(te),ae=n("0dUV"),re=n("+KT1"),ie=n.n(re),oe=n("p6Sd"),se=n.n(oe),ce=ie()(function(e,t,n,a){return a?se()(n,function(n,a,r){return a?n.set(e(a,r),t(a,r)):n},a):n}),ue=ie()(function(e,t,n){return se()(t,function(t,n){return n?e(t,n.objects):t},n)}),le=ce(Z()("email"),B.a);Object(ae.b)({namespace:_.m,fetch:G.b});var de=Object(ae.a)({namespace:_.m,idIsValid:ne.a,responseTransform:B.a}).defineName("OwnerIdsByEmailStore").defineResponseTo([ee.kb,ee.Ab,ee.Eb,ee.Cb],le).defineResponseTo(ee.Bb,ue(le)).register(D.a),pe=n("rCpC"),me=n.n(pe),he=n("aBQC"),fe=n.n(he),ge=n("tuMY"),be=n.n(ge),Oe=ce(B.b,J.a);Object(ae.b)({namespace:_.k,fetch:G.c,idTransform:be.a});var ve=Object(ae.a)({namespace:_.k,idIsValid:me()(fe.a,ne.a),idTransform:be.a}).defineName("OwnersStore").defineResponseTo([ee.kb,ee.Db,ee.Eb,ee.Cb],Oe).defineResponseTo(ee.Bb,ue(Oe)).register(D.a),je=n("Ly8s"),Se=function(e,t){t&&t.hasMore&&Object(G.a)(t.offset,!0).then(function(e){var n=t.owners.concat(e.owners),a=Object.assign({},e,{owners:n});Object(je.b)(ee.pb,a)}).done();return e.set("owners",Z()("owners",t))},ye=function(e){return e&&e.usePaged},Ce=function(){var e=Y.get();if(!Object($.e)(e))return Object(p.Map)();var t=ve.get(e);return t.some($.d)?Object(p.Map)():t},Ee=Object(M.defineFactory)().defineName("LegacyOwnersStore").defineGetInitialState(function(){return Object(p.Map)({promise:null,owners:$.b})}).defineGet(function(e,t){if(ye(t)){e.get("promise")||Object(je.b)(ee.mb);return Object($.e)(e.get("owners"))?Object(B.c)(e.get("owners")):Object(p.Map)()}return Ce()}).defineResponseTo(ee.mb,function(e){var t=Object(G.a)(0,!0);Object(je.b)(ee.nb);t.then(function(e){return Object(je.a)(ee.ob,e)},function(){return Object(je.a)(ee.lb)}).done();return e.set("promise",t)}).defineResponseTo(ee.ob,Se).defineResponseTo(ee.pb,Se).defineResponseTo(ee.lb,function(e){return e.set("promise",null)}).defineResponseTo([Y,de,ve].reduce(function(e,t){return e.union(M.InspectStore.getActionTypes(t))},Object(p.Set)()).toArray(),J.a).register(D.a),Te=function(e){return{stores:[Ee],deref:function(){return Ee.get({usePaged:!0}).map(function(t){var n=e.format(t),a=e.formatWithEmail(t);return{value:String(t.ownerId),text:n,searchText:a,dropdownText:a}}).toArray()}}},Ie=n("OnVB");function Re(e){return M.connect({owners:Te(Ie)},D.a)(e)}var Ae=n("VHfn"),Ne=n.n(Ae),xe=n("AR4q"),Le=n("hr0l"),ke=n("wDwC"),Me=n.n(ke),_e=n("Sx0/"),De=n.n(_e),Pe=n("46u0"),we=n.n(Pe),Be=n("GgP/"),Fe=n.n(Be),Ue=n("DqRu"),qe=n("ju9H"),Ge=n("dxYZ"),Ve=n("c2Nv"),He=n("vuW9"),ze=n("e0QY"),We=n("tPYf"),Ke=n("3Yd4"),Ye=n("fzi9"),Qe=n("aJmV"),Je=n("9f1P"),Xe=n.n(Je),Ze=n("n+BK"),$e=n("r1tY"),et=n.n($e);function tt(e){var t=e.children,n=Object(m.useRef)(document.createElement("div"));Object(m.useLayoutEffect)(function(){var e=n.current;document.body.appendChild(e);return function(){document.body.removeChild(e)}},[]);return et.a.createPortal(t,n.current)}var nt=tt,at=Xe.a.iframe.withConfig({displayName:"ModalFrame__ModalFrameFrame",componentId:"ska6bd-0"})(["height:100%;width:100%;border:0;position:absolute;z-index:9999999;top:","px;display:",";"],function(e){return e.scrollTop},function(e){return e.frameReady?null:"none"});function rt(e){var t=e.src,n=e.frameReady,a=e.dispatchFrameAction,r=Object(m.useRef)(0),i=Object(m.useRef)(null);Object(m.useEffect)(function(){var e=function(e){if(Object(Ze.f)(i,e)){Object(Ze.d)(e,"FRAME_READY")&&(r.current=document.documentElement.scrollTop);Object(Ze.d)(e,"RELOAD_PARENT")&&window.location.reload(!0);"string"==typeof e.data?a({type:e.data}):"object"==typeof e.data&&a({type:e.data.type,payload:Object.assign({},e.data.dimensions,{},e.data.data)})}};window.addEventListener("message",e);return function(){window.removeEventListener("message",e)}},[a]);return Object(d.jsx)(m.Fragment,{children:Object(d.jsx)(nt,{children:Object(d.jsx)(at,{id:"ui-addon-upgrade-modal-frame",src:t,ref:i,frameReady:n,scrollTop:r.current})})})}var it=rt,ot=n("nDpY"),st=n.n(ot),ct=n("D2Y9"),ut=n("dycR"),lt=n("Fse9"),dt=n("hyQG"),pt=n("zsrv"),mt="remove-hubspot-branding-variation";function ht(e){return e.app+"-"+e.screen+"-locked-feature-"+e.uniqueId}function ft(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=e.app,r=e.screen,i=e.uniqueId,o="upgradeProduct="+e.upgradeProduct+"&app="+a+"&screen="+r+"&uniqueId="+i+"&modalKey="+t+"&source="+ht(e)+"&feature="+n,s=Object(ct.parse)(window.location.search.substring(1)).copy_machine_variant;s&&(o=o+"&copy_machine_variant="+s);return Object(ut.a)()+"/modal/"+st.a.get()+"?"+o}function gt(e){var t=e.upgradeData,n=e.modalKey,a=e.feature,r=e.children,i=Object(m.useMemo)(function(){return ft(t,n,a)},[t,n,a]),o=Object(m.useState)(Object.assign({},t,{source:ht(t)})),s=Object(Ye.a)(o,2),c=s[0],u=s[1],l=Object(lt.c)(),p=Object(Ye.a)(l,2),h=p[0],f=h.loadFrame,g=h.frameReady,b=h.showParentModal,O=h.frameDimensions,v=p[1];n===mt&&(O.width="700px");var j=t.app,S=t.screen,y=t.upgradeProduct,C=t.uniqueId;Object(m.useEffect)(function(){var e={app:j,screen:S,upgradeProduct:y,uniqueId:C},t=Object.assign({},e,{source:ht(e)});u(Object.assign({},t));Qe.a("lockedFeatureInteraction",Object.assign({action:"viewed"},t))},[j,S,y,C]);var E=function(){v({type:lt.b.LOAD_FRAME});Qe.a("lockedFeatureInteraction",Object.assign({action:"clicked"},c))};return Object(d.jsxs)(m.Fragment,{children:[r({openUpgradeModal:E,preloadUpgradeModal:function(){}}),f&&Object(d.jsx)(pt.a,{frameReady:g,showParentModal:b,modalWidth:O.width,modalHeight:O.height}),f&&Object(d.jsx)(it,{src:i,frameReady:g,dispatchFrameAction:v})]})}gt.propTypes=Object.assign({modalKey:f.a.string.isRequired,children:f.a.func.isRequired,feature:f.a.string},dt.a);var bt=gt,Ot=n("wO7w");function vt(e){var t=e.upgradeData,n=e.children,a=e.feature,r=e.isDropdownOption,i=e.modalKey,o=Object(Ot.a)(t);return Object(d.jsx)(bt,{upgradeData:o,modalKey:i,feature:a,children:function(e){var t=e.openUpgradeModal,a=e.preloadUpgradeModal;return m.Children.map(n,function(e){return Object(m.cloneElement)(e,{onMouseOver:function(){if(e.props.onMouseOver){var t;(t=e.props).onMouseOver.apply(t,arguments)}a()},onClick:function(){if(e.props.onClick){var n;(n=e.props).onClick.apply(n,arguments)}t()},className:r?e.props.className+" p-y-2 p-x-5":e.props.className,use:r?"unstyled":e.props.use||"secondary"})})}})}var jt=vt,St=function(){return Object(d.jsx)(jt,{isDropdownOption:!1,modalKey:"crm-sequences-access",upgradeData:{app:"crm_ui",screen:"communicator",upgradeProduct:"sales-professional",uniqueId:"sequences-email-communicator-pql-feature-lock"},children:Object(d.jsxs)(Ue.a,{use:"transparent",className:"template-menu-item-container p-all-0 templates-select-container",children:[Object(d.jsx)(we.a,{message:"customerDataContent.SalesContentMenu.buttons.sequences"}),Object(d.jsx)(Ke.a,{name:"locked"})]})})},yt={from:f.a.instanceOf(Ve.a).isRequired,fromSharedAccount:f.a.bool.isRequired,to:f.a.instanceOf(p.List).isRequired,hideSequencesButton:f.a.bool,meetingsUrl:f.a.string.isRequired,onDocumentSelect:f.a.func.isRequired,onMeetingsSelect:f.a.func.isRequired,onMeetingOpenChange:f.a.func,onQuotesSelect:f.a.func.isRequired,onSequenceSelectionMade:f.a.func,onTemplateSelect:f.a.func.isRequired,onClick:f.a.func,paddingClassNames:f.a.string.isRequired,subject:f.a.object,subjectId:f.a.string,timelineObjectType:We.b.isRequired,timelineSubjectId:f.a.string.isRequired,timelineSubject:We.a.isRequired,isSequencesDisabled:f.a.bool,handleUsageLogging:f.a.func,onQuotesOpenChange:f.a.func,AsyncSalesModal:f.a.func.isRequired,isCrmObject:f.a.bool},Ct={objectType:A.CONTACT,paddingClassNames:"p-y-3 p-x-5",isSequencesDisabled:!1,handleUsageLogging:De.a,onQuotesOpenChange:De.a,onMeetingOpenChange:De.a,onClick:De.a,isCrmObject:!1},Et=function(e){var t=e.MeetingsSelect,n=e.QuotesSelect,a=e.SalesModalTabs,r=e.SequenceActions,u=!!r,h=function(e){var t=e.name,n=e.type,a=e.onClick,r=e.disabled,i=e.disabledTooltip;return Object(d.jsx)(He.a,{title:i,disabled:!r,children:Object(d.jsx)(Ue.a,{disabled:r,use:"transparent",className:"template-menu-item-container p-all-0 templates-select-container","data-selenium-test":"sales-content-menu-"+n,onClick:function(){return a(n)},children:t})})};h.propTypes={name:f.a.node.isRequired,type:f.a.oneOf(Me()(a).toArray()).isRequired,onClick:f.a.func.isRequired,disabled:f.a.bool,disabledTooltip:f.a.node};var g=function(e){Object(l.a)(m,e);function m(){var e;Object(i.a)(this,m);(e=Object(s.a)(this,Object(c.a)(m).call(this))).handleClick=function(t){e.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:"clicked "+t+" in sales content menu"});e.setState({open:!0,initialTab:t});e.props.onClick(t)};e.handleClose=function(){e.setState({open:!1,initialTab:null})};e.getIsCrmObjectTooltip=function(){return Object(d.jsx)(we.a,{message:"customerDataContent.isCrmObject.disabledTooltip"})};e.getNoSalesAccessTooltip=function(){return Object(d.jsx)(we.a,{message:"customerDataContent.SalesContentMenu.tooltips.noSalesAccess"})};e.getNoToAddressTooltip=function(){return Object(d.jsx)(we.a,{message:"customerDataContent.noRecipients.disabledTooltip"})};var t=Object(Be.userInfoSync)(),n=t.user,a=t.portal;e.state={open:!1,initialTab:null,user:Object(p.fromJS)(n),portal:Object(p.fromJS)(a)};return e}Object(o.a)(m,[{key:"getRecipientEmail",value:function(){var e=this.props,t=e.subject,n=e.to,a=Object(Ge.d)(t,"email");if(!a){var r=n.first();if(!(a=r&&r.get("emailAddresses").first())){var i="SalesContentMenu: recipient is null";Object(ze.b)({message:i,tags:{communicatorType:"EMAIL"},extraData:{subject:t&&t.toJS(),to:n.toJS()},fingerprint:i})}}return a}},{key:"renderTemplatesSelect",value:function(){var e,t=this.props,n=t.to,r=t.isCrmObject,i=this.state.user,o=n&&n.size,s=["templates-limited-read-access"].every(function(e){var t=i.get("scopes");return p.List.isList(t)?t.indexOf(e)>-1:t.get(e)});r?e=this.getIsCrmObjectTooltip():s?o||(e=this.getNoToAddressTooltip()):e=Object(d.jsx)(we.a,{message:"customerDataContent.SalesContentMenu.tooltips.noSalesAccess"});return Object(d.jsx)(h,{name:Object(d.jsx)(we.a,{message:"customerDataContent.SalesContentMenu.buttons.templates"}),type:a.TEMPLATES,onClick:this.handleClick,disabledTooltip:e,disabled:!!e})}},{key:"renderSequencesSelect",value:function(){var e=this.props,t=e.isSequencesDisabled,n=e.to,r=e.fromSharedAccount,i=e.hideSequencesButton,o=e.isCrmObject,s=this.state.user;if(!u||i)return null;if(!["sequences-enrollments-write-access"].every(function(e){var t=s.get("scopes");return p.List.isList(t)?t.indexOf(e)>-1:t.get(e)}))return Object(d.jsx)(St,{});var c=n&&n.size,l=!c||t||o||r,m=null;l&&(m=o?this.getIsCrmObjectTooltip():c?r?Object(d.jsx)(we.a,{message:"customerDataContent.SalesContentMenu.tooltips.sharedInboxSelected"}):Object(d.jsx)(we.a,{message:"customerDataContent.GDPR.buttons.legalBasis"}):this.getNoToAddressTooltip());return Object(d.jsx)(h,{disabled:l,disabledTooltip:m,name:Object(d.jsx)(we.a,{message:"customerDataContent.SalesContentMenu.buttons.sequences"}),type:a.SEQUENCES,onClick:this.handleClick})}},{key:"renderSalesModal",value:function(){var e=this.props,t=e.subjectId,n=e.from,a=e.timelineObjectType,i=e.timelineSubjectId,o=e.onSequenceSelectionMade,s=e.onDocumentSelect,c=e.onTemplateSelect,l=e.AsyncSalesModal,m=this.state,h=m.open,f=m.initialTab,g=m.user,b=m.portal;if(!h)return null;var O=this.getRecipientEmail();if(!O)return null;var v=u?function(e,n){var s=e.enrollment,c=e.email;s=s.set("userPlatform","CRM");o();r.enroll({email:c,sequence:s,vid:Number(t),objectType:a,subjectId:i}).then(function(e){n("complete",e)})}:De.a,j=function(e,t,n){return c({templateId:n,res:Object(p.Map)({subject:e,html:t})})};return Object(d.jsx)(l,{tab:f,user:g,portal:b,platform:"CRM",recipient:O,closeModal:this.handleClose,sender:{inboxAddress:n.getAccountId(),fromAddress:n.address},enrollSequence:v,selectConnectedAccount:!0,useCachedConnectedAccount:!1,insertLink:s,insertTemplate:j,supplementalObjectType:a,supplementalObjectId:i})}},{key:"renderDocumentsSelect",value:function(){var e,t=this.props.to,n=this.state.user,r=t&&t.size;["documents-limited-read-access"].every(function(e){var t=n.get("scopes");return p.List.isList(t)?t.indexOf(e)>-1:t.get(e)})?r||(e=this.getNoToAddressTooltip()):e=this.getNoSalesAccessTooltip();return Object(d.jsx)(h,{name:Object(d.jsx)(we.a,{message:"customerDataContent.SalesContentMenu.buttons.documents"}),type:a.DOCUMENTS,onClick:this.handleClick,disabledTooltip:e,disabled:!!e})}},{key:"renderMeetingsSelect",value:function(){var e=this.props,n=e.meetingsUrl,a=e.onMeetingsSelect,r=e.onMeetingOpenChange;return Object(d.jsx)(t,{onMeetingOpenChange:r,meetingsUrl:n,onMeetingsSelect:a})}},{key:"renderQuotesSelect",value:function(){var e=this.props,t=e.onQuotesSelect,a=e.timelineObjectType,r=e.timelineSubject,i=e.onQuotesOpenChange,o=this.state.user,s=["quote-create"].every(function(e){var t=o.get("scopes");return p.List.isList(t)?t.indexOf(e)>-1:t.get(e)});return Object(d.jsx)(n,{onQuotesOpenChange:i,onQuotesSelect:t,hasAccessToQuotes:s,timelineObjectType:a,timelineSubject:r})}},{key:"render",value:function(){var e=this.props,t=e.paddingClassNames;if(!e.subject)return null;var n=v()("display-inline-flex justify-between width-100 crm-light-border-bottom",t);return Object(d.jsxs)("div",{className:n,children:[Object(d.jsxs)(qe.a,{inline:!0,childClassName:"m-right-4",children:[this.renderTemplatesSelect(),this.renderSequencesSelect(),this.renderDocumentsSelect(),this.renderMeetingsSelect(),this.renderQuotesSelect()]}),this.renderSalesModal()]})}}]);return m}(m.Component);g.propTypes=yt;g.defaultProps=Ct;return g},Tt=function(e){return"InteractionComponentConfig: "+e+" not defined"},It=Object(p.Record)({appId:0,appSource:"?",hasScope:function(){throw new Error(Tt("hasScope(scope)"))},hasPortalSetting:function(){throw new Error(Tt("hasPortalSetting(setting)"))}},"InteractionComponentConfig"),Rt=n("bsBP"),At=n("qL+2"),Nt=n("2T69"),xt=n("m9st"),Lt=n("M2y5"),kt=Object(p.Map)(),Mt=function(e){return e?kt.get(e):kt},_t=function(e){kt=kt.set(e.address,e)},Dt=function(e){var t=kt.get(e);if(t){t=t.set("sendResult","SENT");kt=kt.set(e,t)}},Pt=Object(M.define)().defineName("EmailRecipientDeliverabilityStore").defineGet(Mt).defineResponseTo(ee.W,_t).defineResponseTo(Lt.a,Dt).register(D.a),wt=n("xHov"),Bt=n("Eha6"),Ft="/optins/v1/availability",Ut=function(e){return Object(wt.c)(Ft+"/"+encodeURIComponent(e)).catch(function(){return $.a})},qt=Object(Bt.a)(Ut,"OptInsAPI.fetchOptIns"),Gt="OPTINS";function Vt(e,t){var n=t.optinName,a=t.optinStatus;return e.setIn([n,"state"],a)}Object(ae.b)({namespace:Gt,fetch:qt});var Ht=Object(ae.a)({namespace:Gt,idIsValid:function(){return!0}}).defineName("OptInsStore").defineResponseTo(ee.nc,Vt).register(D.a),zt=function(e){return{stores:[Ht],deref:function(){var t=Ht.get(e);return t?"OPTED_IN"===t.get("state"):t}}},Wt=n("7XTd"),Kt=n("g+dq"),Yt=n.n(Kt);function Qt(){return Yt.a.get("iris-read/v1/app/?hubField=paidHub")}function Jt(){return Qt().then(function(e){return e.hub.paidHub})}var Xt,Zt,$t,en=Object(F.a)({fetch:Jt,namespace:_.n}).defineName("PaidHubStore").register(D.a),tn="trials/v1/hub-trials",nn={getTrialState:function(){return Zt||(Zt=Yt.a.get(tn+"?active=false"))},getAvailableTrials:function(){return Xt||(Xt=Yt.a.get(tn+"/available"))}},an=n("OwGx"),rn=n("PO7J"),on=n("et6O"),sn=($t={},Object(an.a)($t,rn.SALES_STARTER,on.SALES_HUB_STARTER),Object(an.a)($t,rn.SALES_PROFESSIONAL,on.SALES_HUB_PROFESSIONAL),Object(an.a)($t,rn.SALES_ENTERPRISE,on.SALES_HUB_ENTERPRISE),Object(an.a)($t,rn.MARKETING_STARTER_EMAIL,on.MARKETING_HUB_STARTER),Object(an.a)($t,rn.MARKETING_PRO,on.MARKETING_HUB_PROFESSIONAL),Object(an.a)($t,rn.MARKETING_ENTERPRISE,on.MARKETING_HUB_ENTERPRISE),Object(an.a)($t,rn.SERVICE_STARTER,on.SERVICE_HUB_STARTER),Object(an.a)($t,rn.SERVICE_PROFESSIONAL,on.SERVICE_HUB_PROFESSIONAL),Object(an.a)($t,rn.SERVICE_ENTERPRISE,on.SERVICE_HUB_ENTERPRISE),Object(an.a)($t,rn.CMS_PROFESSIONAL,on.CMS_HUB_PROFESSIONAL),Object(an.a)($t,rn.CMS_ENTERPRISE,on.CMS_HUB_ENTERPRISE),Object(an.a)($t,rn.OPERATIONS_STARTER,on.OPERATIONS_HUB_STARTER),Object(an.a)($t,rn.OPERATIONS_PROFESSIONAL,on.OPERATIONS_HUB_PROFESSIONAL),$t),cn=n("mDbF"),un=n.n(cn),ln=function(e){var t=un.a.moment().valueOf();return e&&e<t},dn=function(e,t,n,a){return{inTrial:ln(n)?null:{createdTs:e,expiresTs:t},hasTrialed:ln(n)?{lastTrialStarted:e,lastTrialExpired:n}:null,id:a}},pn=function(e){if(0===e.length)return e;var t={};e.forEach(function(e){var n=e.trials,a=e.createdAt,r=e.endsAt,i=e.removedAt;n.forEach(function(e){var n=e.name,o=e.id,s=sn[n];t[s]=dn(a,r,i,o)})});return t},mn=function(){return nn.getTrialState().then(function(e){return pn(e)})};function hn(){return mn()}var fn=Object(F.a)({fetch:hn,namespace:_.o}).defineName("ProductTrialStateStore").register(D.a),gn=n("/sC9"),bn="/cursus/settings/portal/all",On="EMAIL_TRACKING_ENABLED";function vn(){return Object(wt.c)(bn).then(function(e){return e&&e.find(function(e){return e.get("settingName")===On})||null}).catch(function(e){Object(ze.a)({error:new Error("Failed to get portal settings for email tracking."),extraData:{error:e},tags:{communicatorType:"EMAIL"}});throw e})}var jn=Object(F.a)({fetch:function(){return vn()},namespace:_.g}).defineName("EmailTrackingSettingStore").register(D.a),Sn=n("Nw75"),yn={stores:[gn.a,jn],deref:function(){var e=jn.get(),t=gn.a.get(Rt.a.EMAIL_TRACKING_SETTINGS);if(e===Sn.b||null===e)return Sn.b;if(t===Sn.b)return Sn.b;var n=e.get("value"),a=void 0;t!==n&&(a={trackingIsEnabled:"true"===n});return a}},Cn=n("Nm19"),En="EMAIL_BRANDING",Tn=Object(F.a)({fetch:Cn.b,namespace:En}).defineName("EmailBrandingStore").register(D.a),In=Object(Nt.a)(At.a.EMAIL_COMMUNICATOR_TRACKING_TOOLTIP_SHOWN),Rn=Object(Nt.a)(Rt.a.EMAIL_UNSUBSCRIBE_LINK_TYPE),An={contacts:{stores:[xt.a],deref:function(){return xt.a}},deliverability:Pt,owners:Ee,showTrackingTooltip:{stores:In.stores,deref:function(){var e=In.deref();return!!e&&!e.get(At.a.EMAIL_COMMUNICATOR_TRACKING_TOOLTIP_SHOWN)}},unsubscribeLinkType:{stores:Rn.stores,deref:function(){var e=Rn.deref();return e?e.get(Rt.a.EMAIL_UNSUBSCRIBE_LINK_TYPE)||Wt.b:Wt.c}},isPaidHub:{stores:[en],deref:function(){return en.get()}},trialState:{stores:[fn],deref:function(){return fn.get()}},isOptedInToProfileActionsRedesign:zt("record-actions-redesign"),emailTrackingSetting:yn,emailBrandingVariation:Tn},Nn=n("pPiP"),xn=n.n(Nn),Ln=n("KLfa"),kn=n("h7ha"),Mn=n("pZnI"),_n=n("KknD"),Dn=n("StfA"),Pn=n("rCVw"),wn=n("/6Wf"),Bn=n("Bdgu"),Fn=n("3NDn"),Un=n("0lxZ"),qn="EMAIL",Gn={connectedAccounts:"connectedaccounts/v1/accounts/connected-inboxes",emailSignature:"userpreferences/v1/signature"};function Vn(e){var t=e.get("aliases"),n=e.get("aliasState"),a=e.get("inboxStatus");a!==Pn.b||e.get("shared")||(a=Pn.a);var r=Object(p.List)();"ENABLED"===n&&(r=t.map(function(e){var t={address:e.get("email"),displayableAddress:e.get("sendFromEmail")||e.get("email"),primary:e.get("primary"),signature:e.get("signature"),default:e.get("default"),type:e.get("type"),disabled:"ENABLED"===a?null:a,inboxId:e.get("conversationsInboxId"),conversationsInboxName:e.get("conversationsInboxName"),conversationsConnectedAccountId:e.get("conversationsConnectedAccountId")};return Object(wn.a)(t)}));return Object(Bn.a)({aliases:Object(p.List)(r),state:n})}function Hn(){return Object(wt.c)(Gn.emailSignature,{clienttimeout:6e4})}function zn(e){var t={friendlyFromName:null,resolvedFromName:null,sendFromEmail:null};if(e){t.friendlyFromName=e.get("friendlyFromName");t.resolvedFromName=e.get("resolvedFromName");t.sendFromEmail=e.get("sendFromEmail")}return t}function Wn(e){return Object(wt.c)(Gn.connectedAccounts,{clienttimeout:6e4}).then(function(t){var n=t.get("connectedInboxes").sortBy(function(e){return"ENABLED"===e.get("inboxStatus")?0:1}).map(function(e){var t=e.get("accountId"),n=e.get("aliases"),a=n&&n.find(function(e){return e.get("primary")}),r=Object.assign({address:t&&t.toLowerCase(),facsimileInbox:e.get("facsimileInboxState"),integration:new Fn.a({type:e.get("emailProviderType"),state:e.get("crmEmailIntegrationState")}),aliasList:Vn(e),shared:e.get("shared"),inboxType:e.get("emailProviderType")},zn(a));return new Un.a(r)}),a=new Dn.a({accounts:n});if(!a.hasPrimaryAccount(e)){var r={address:e,displayableAddress:e,signature:null,primary:!0,default:!0,type:"owner"};return Hn().then(function(t){r.signature=t.get("signature");var a={address:e,aliasList:Object(Bn.a)({aliases:Object(p.List)([Object(wn.a)(r)]),state:"ENABLED"})};n=n.concat([new Un.a(a)]);return new Dn.a({accounts:n})}).catch(function(t){Object(ze.a)({error:new Error("Failed to fetch the email signature for the owner connected account."),extraData:{error:t},tags:{communicatorType:qn}});var a={address:e,aliasList:Object(Bn.a)({aliases:Object(p.List)([Object(wn.a)(r)]),state:"ENABLED"})};n=n.concat([new Un.a(a)]);return new Dn.a({accounts:n})})}return a})}function Kn(){return Wn(Ln.a.get().get("email").toLowerCase()).catch(function(e){Object(ze.a)({error:new Error("Failed to fetch the connected accounts."),extraData:{error:e},tags:{communicatorType:qn}});throw e})}var Yn,Qn=Object(F.a)({fetch:function(){return Kn()},namespace:_.d}).defineName("ConnectedAccountsStore").defineResponseTo(ee.T,function(e,t){var n=t.emailAddressId,a=t.signature;return e.set("value",e.value.updateSignature(n,a))}).register(D.a),Jn=(Object.assign({},An,{connectedAccounts:Qn,sender:{stores:[Qn],deref:function(e){var t=e.objectType,n=e.ownerId,a=Qn.get();return Object($.d)(a)?new kn.a:Object($.c)(a)?-1===n?new kn.a({from:new Ve.a({id:"jita"})}):new kn.a({from:new Ve.a({id:"error"})}):Object(_n.g)(Ln.a.get(),a,t)}},checkIntegration:{stores:[Qn],deref:function(){var e=Qn.get();return e?xn()(Mn.k,e):function(){return!1}}}}),n("oo3K")),Xn=window.hubspot.bender.staticDomainPrefix,Zn=C()(function(e){return Xn+"/salesImages/static-1.389/"+e}),$n=Zn("icons/google.svg"),ea=Zn("icons/gmail.svg"),ta=Zn("icons/outlook-365.png"),na=Zn("icons/inbox.png"),aa=Zn("icons/unknown-email.svg"),ra=function(e){return Object(d.jsx)(we.a,{message:"customerDataCommunicator.Communicator.Email.interaction.synced_"+e})},ia=Object(p.Map)((Yn={},Object(an.a)(Yn,Le.a,new Jn.a({connectPromptLogo:ea,syncLogo:$n,tooltip:ra(Le.a)})),Object(an.a)(Yn,Le.c,new Jn.a({connectPromptLogo:ta,syncLogo:ta,tooltip:ra(Le.c)})),Object(an.a)(Yn,Le.b,new Jn.a({connectPromptLogo:aa,syncLogo:na,tooltip:ra(Le.b)})),Yn)),oa=n("1sP7"),sa="meetings/v1",ca=sa+"/user",ua=sa+"/link";function la(){return Object(wt.c)(ua+"?includeAssociated=true")}function da(){return Object(wt.c)(ca)}var pa=null,ma=null;function ha(){ma||(ma=la().then(function(e){Object(je.a)(ee.sb,e);return e}).catch(function(e){Object(je.a)(ee.rb);if(404!==e.status)throw e}).finally(function(){ma=null}));return ma}function fa(){pa||(pa=da().then(function(e){Object(je.a)(ee.tb,e);return e}).catch(function(){return Object(je.a)(ee.ub)}).finally(function(){pa=null}));return pa}var ga="meetingsUser",ba="meetingsLinks",Oa=Object(M.defineFactory)().defineName("MeetingsStore").defineGetInitialState(p.Map).defineGet(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.has(ga)||fa();t.onlyUser||e.has(ba)||ha();return e}).defineResponseTo(ee.tb,function(e,t){return e.set(ga,t)}).defineResponseTo(ee.ub,function(e){return e.set(ga,-1)}).defineResponseTo(ee.sb,function(e,t){return e.set(ba,t)}).defineResponseTo(ee.rb,function(e){return e.set(ba,-1)}).register(D.a),va={stores:[Oa],deref:function(){return Oa.get({onlyUser:!1})}},ja=n("kZyb"),Sa=n("Ukhg"),ya=function(e){var t=e.className,n=e.children;return Object(d.jsx)("div",{className:v()("private-dropdown__footer-container",t),children:n})};ya.propTypes={children:f.a.node};ya.displayName="UIDropdownFooter";var Ca=ya,Ea=n("QhRM"),Ta=n("muUi"),Ia=n("dd+0"),Ra=n.n(Ia),Aa=n("WvEe"),Na={buttonText:f.a.string,iconName:f.a.string,className:f.a.string.isRequired,meetingsUrl:f.a.string.isRequired},xa=330,La=function(e){Object(l.a)(t,e);function t(){Object(i.a)(this,t);return Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.iconName,n=e.buttonText,a=e.className,r=e.meetingsUrl;return Object(d.jsx)(Sa.a,{buttonText:n,buttonUse:"link",className:a,iconName:t,menuWidth:xa,children:Object(d.jsxs)("div",{className:"align-center flex-column",children:[Object(d.jsx)("h5",{children:Object(d.jsx)(Ra.a,{message:"customerDataContent.MeetingsGetStarted.cta.header"})}),Object(d.jsx)(Aa.a,{className:"p-bottom-3",src:Zn("sales-content/templates-meetings-cta.png")}),Object(d.jsx)("p",{className:"text-center",children:Object(d.jsx)(Ra.a,{message:"customerDataContent.MeetingsGetStarted.cta.text"})}),Object(d.jsx)(Ue.a,{href:r,target:"_blank",use:"primary",children:Object(d.jsx)(Ra.a,{message:"customerDataContent.MeetingsGetStarted.cta.button"})})]})})}}]);return t}(Ta.a);La.propTypes=Na;var ka=La,Ma={onMeetingOpenChange:f.a.func,meetings:Object(g.mapContains)({meetingsUser:f.a.oneOfType([g.map,f.a.number]),meetingsLinks:f.a.oneOfType([Object(g.listOf)(Object(g.mapContains)({customParams:Object(g.mapContains)({durations:Object(g.listOf)(f.a.number.isRequired)}).isRequired,id:f.a.number.isRequired,link:f.a.string.isRequired,name:f.a.string,slug:f.a.string.isRequired})),f.a.number])}),meetingsUrl:f.a.string.isRequired,onMeetingsSelect:f.a.func.isRequired},_a={onMeetingOpenChange:De.a},Da=function(e){Object(l.a)(t,e);function t(){var e;Object(i.a)(this,t);(e=Object(s.a)(this,Object(c.a)(t).call(this))).partial=C()(xn.a);return e}Object(o.a)(t,[{key:"renderLinks",value:function(){var e=this;return this.props.meetings.get("meetingsLinks").map(function(t){var n={minutes:un.a.formatList(t.getIn(["customParams","durations"]).map(function(e){return un.a.moment.duration(e).asMinutes()}).toJS())},a=un.a.text("customerDataContent.MeetingsSelect.placeholderName",n),r=t.get("name")||a;return Object(d.jsxs)(Ea.a,{onClick:e.partial(e.props.onMeetingsSelect,r,t.get("link")),children:[Object(d.jsx)("p",{className:"p-bottom-0 m-bottom-0",children:r}),Object(d.jsx)(ja.a,{className:"truncate-text",children:t.get("slug")})]},"meetings-link-"+t.get("id"))})}},{key:"renderManageMeetingsLink",value:function(){return Object(d.jsx)(Ca,{children:Object(d.jsx)(Ue.a,{use:"link",href:this.props.meetingsUrl,children:Object(d.jsx)(T.a,{message:"customerDataContent.MeetingsSelect.manageLinks"})})})}},{key:"renderMeetingsLinks",value:function(){var e=this.props.meetings.get("meetingsLinks");return e&&-1!==e?Object(d.jsxs)(Sa.a,{menuWidth:300,buttonText:un.a.text("customerDataContent.MeetingsSelect.menuLabel"),onOpenChange:this.props.onMeetingOpenChange,buttonUse:"link",children:[Object(d.jsx)(qe.a,{className:"overflow-y-auto m-top-2",style:{maxHeight:300},children:this.renderLinks()}),this.renderManageMeetingsLink()]}):null}},{key:"renderGetStarted",value:function(){return-1!==this.props.meetings.get("meetingsUser")?null:Object(d.jsx)(ka,{className:"m-all-4",buttonText:un.a.text("customerDataContent.MeetingsSelect.menuLabel"),meetingsUrl:this.props.meetingsUrl})}},{key:"render",value:function(){return Object(d.jsxs)("div",{className:"template-menu-item-container","data-selenium-test":"sales-content-menu-MEETINGS",children:[this.renderGetStarted(),this.renderMeetingsLinks()]})}}]);return t}(Ta.a);Da.propTypes=Ma;Da.defaultProps=_a;var Pa=Da,wa=n("P4dz"),Ba=n("DSKb"),Fa=n("yvRk"),Ua=n.n(Fa),qa=Ua()({displayName:"QuotesPQLButton",propTypes:{app:f.a.string.isRequired,screen:f.a.string.isRequired,uniqueId:f.a.string.isRequired,buttonTextKey:f.a.string.isRequired,buttonProps:f.a.object},render:function(){var e=this.props,t=e.app,n=e.screen,a=e.uniqueId,r=e.buttonTextKey,i=e.buttonProps;return Object(d.jsx)(jt,{modalKey:"customer-data-quotes-pql",upgradeData:{app:t,screen:n,upgradeProduct:"sales-starter",uniqueId:a},children:Object(d.jsxs)(Ue.a,Object.assign({},i,{children:[Object(d.jsx)(we.a,{message:r}),Object(d.jsx)(Ke.a,{name:"locked"})]}))})}}),Ga=function(e){Object(l.a)(t,e);function t(){Object(i.a)(this,t);return Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.objectType;return Object(d.jsx)("div",{className:t,children:Object(d.jsx)(we.a,{message:"customerDataContent.QuotesSelect.emptyState."+n})})}}]);return t}(Ta.a);Ga.propTypes={objectType:f.a.string.isRequired,className:f.a.string};var Va=Ga,Ha=n("HNbR"),za=function(e){var t=e.httpClient,n=e.objectType,a=e.objectId,r=e.hasAccess;return{condition:function(){return[A.CONTACT,A.COMPANY,A.DEAL].indexOf(n)>=0&&!!a&&r},fetchFunction:function(){return Object(Ha.a)({httpClient:t,objectType:n,objectId:a})},manageUrl:"https://knowledge.hubspot.com/articles/kcs_article/deals/how-do-i-create-quotes",title:"customerDataContent.QuotesSelect.menuLabel",zeroState:Va}},Wa={hasAccessToQuotes:f.a.bool.isRequired,onQuotesSelect:f.a.func.isRequired,timelineObjectType:We.b.isRequired,timelineSubject:We.a.isRequired,onQuotesOpenChange:f.a.func},Ka={onQuotesOpenChange:De.a},Ya=function(e){Object(l.a)(t,e);function t(e){var n;Object(i.a)(this,t);(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).handleOnChange=function(e){(0,n.props.onQuotesSelect)(e.target.value.title,e.target.value.value)};n.renderEmptyState=function(){var e=n.quotesConfig.zeroState,t=n.props.timelineObjectType;return Object(d.jsx)(e,{className:"p-x-4 p-y-5",objectType:t})};n.renderHelpLink=function(){var e=n.quotesConfig.manageUrl;return Object(d.jsx)(Ue.a,{use:"link",external:!0,href:e,children:Object(d.jsx)(we.a,{message:"customerDataContent.QuotesSelect.helpText"})})};n.renderPQLButton=function(){var e="crm_ui",t=n.props.timelineObjectType+"-profile-page",a="quotes-email-communicator-pql-feature-lock";return Object(d.jsx)("div",{className:"template-menu-item-container",children:Object(d.jsx)(qa,{app:e,screen:t,uniqueId:a,buttonTextKey:"customerDataContent.QuotesSelect.menuLabel",buttonProps:{use:"link"}})})};n.renderButtonContent=function(){var e=n.quotesConfig.title;return Object(d.jsx)(we.a,{message:e})};n.state={isLoading:!0,hasFailed:!1,options:null};n.quotesConfig=za({httpClient:Yt.a,objectType:e.timelineObjectType,objectId:Object(wa.a)(e.timelineSubject),hasAccess:e.hasAccessToQuotes});n.renderButtonContent=n.renderButtonContent.bind(Object(u.a)(n));return n}Object(o.a)(t,[{key:"componentDidMount",value:function(){this.fetch()}},{key:"fetch",value:function(){var e=this;if((0,this.quotesConfig.condition)()){this.setState({isLoading:!0});this.quotesConfig.fetchFunction().then(function(t){e.setState({isLoading:!1,hasFailed:!1,options:t})}).catch(function(){e.setState({isLoading:!1,hasFailed:!0})})}}},{key:"render",value:function(){var e=this.props.hasAccessToQuotes,t=this.state,n=t.isLoading,a=t.hasFailed,r=t.options,i=this.quotesConfig.condition;return e?!i()||n||a?null:Object(d.jsx)("div",{className:"template-menu-item-container","data-selenium-test":"sales-content-menu-QUOTES",children:Object(d.jsx)(Ba.a,{anchorType:"button",buttonUse:"link",menuWidth:300,onSelectedOptionChange:this.handleOnChange,options:r,ButtonContent:this.renderButtonContent,dropdownFooter:this.renderHelpLink(),noResultsText:this.renderEmptyState(),onOpenChange:this.props.onQuotesOpenChange})}):this.renderPQLButton()}}]);return t}(Ta.a);Ya.propTypes=Wa;Ya.defaultProps=Ka;var Qa,Ja,Xa,Za,$a,er,tr=Ya,nr=Object(p.Record)({MeetingsSelect:null,QuotesSelect:null,SalesModalTabs:null,SequenceActions:null,interactionType:null},"SalesContentMenuComponentConfig")({MeetingsSelect:Object(M.connect)({meetings:va},D.a)(Pa),QuotesSelect:tr,SalesModalTabs:oa}),ar=n("K79i"),rr=n("a7/P"),ir=n("NUMG"),or=n.n(ir),sr=n("NxWu"),cr=n("eP/i"),ur=Ua()({displayName:"EmailBrandingBanner",propTypes:{brandingCopy:f.a.string.isRequired,signupLink:f.a.string.isRequired},render:function(){var e={link:this.props.signupLink};return Object(d.jsx)("div",{children:Object(d.jsxs)(ja.a,{use:"help",children:[Object(d.jsx)(Ke.a,{name:"sprocket",size:"small",color:cr.LORAX})," ",Object(d.jsx)(T.a,{message:"customerDataCommunicator.branding."+this.props.brandingCopy,options:e})]})})}}),lr="editWithHubSpot",dr=[lr,"variationFomo","variationFree","variationVoiceOfTheUser","variationSocialProof","variationValueProp"],pr=function(e){return dr.indexOf(e)>-1},mr=function(e){return 3===e.split(".").length},hr=function(e){if("string"!=typeof e)return lr;var t=mr(e)?e.split(".").slice(-1)[0]:e;return pr(t)?t:lr},fr={CRM:"CRM",FB_CRM:"FB_CRM",MARKETING:"MARKETING",SALES:"SALES",ACADEMY:"ACADEMY",CLASSROOM_TRAINING:"CLASSROOM_TRAINING",CONTENT:"CONTENT",HUBSPOT_FOR_STARTUPS:"HUBSPOT_FOR_STARTUPS",INTEGRATIONS:"INTEGRATIONS",PURCHASE:"PURCHASE",SERVICE:"SERVICE",WORDPRESS:"WORDPRESS",WORDPRESS_LOGIN:"WORDPRESS_LOGIN",GROWTH_HUB:"GROWTH_HUB",DEVELOPERS:"DEVELOPERS",EMBEDDED:"EMBEDDED",CONTENT_HUB:"CONTENT_HUB",STANDALONE_CMS_PARTNER:"STANDALONE_CMS_PARTNER"},gr=(Qa={},Object(an.a)(Qa,fr.CRM,"crm"),Object(an.a)(Qa,fr.FB_CRM,"fb-crm"),Object(an.a)(Qa,fr.MARKETING,"marketing"),Object(an.a)(Qa,fr.SALES,"sales"),Object(an.a)(Qa,fr.ACADEMY,"academy"),Object(an.a)(Qa,fr.CLASSROOM_TRAINING,"classroom-training"),Object(an.a)(Qa,fr.CONTENT,"content"),Object(an.a)(Qa,fr.HUBSPOT_FOR_STARTUPS,"hubspot-for-startups"),Object(an.a)(Qa,fr.INTEGRATIONS,"integrations"),Object(an.a)(Qa,fr.PURCHASE,"purchase"),Object(an.a)(Qa,fr.SERVICE,"service"),Object(an.a)(Qa,fr.WORDPRESS,"wordpress"),Object(an.a)(Qa,fr.WORDPRESS_LOGIN,"wordpress-login"),Object(an.a)(Qa,fr.GROWTH_HUB,"growth-hub"),Object(an.a)(Qa,fr.DEVELOPERS,"developers"),Object(an.a)(Qa,fr.EMBEDDED,"embedded"),Object(an.a)(Qa,fr.CONTENT_HUB,"content-hub"),Object(an.a)(Qa,fr.STANDALONE_CMS_PARTNER,"standalone-cms-partner"),Qa),br={CONVERSATIONS:"CONVERSATIONS",DOCUMENTS:"DOCUMENTS",FORMS:"FORMS",LEAD_FLOWS:"LEAD_FLOWS",LEARNING_CENTER:"LEARNING_CENTER",LANDING_PAGES:"LANDING_PAGES",MARKETING_ADS:"MARKETING_ADS",MARKETING_FREE_EMAIL:"MARKETING_FREE_EMAIL",MEETINGS:"MEETINGS",SALES_FREE:"SALES_FREE",SALES_O365:"SALES_O365",SALES_VSTO:"SALES_VSTO",TRIAL:"TRIAL",COMPANY_GRADER:"COMPANY_GRADER",HUBSPOT_NETWORK:"HUBSPOT_NETWORK"},Or=(Ja={},Object(an.a)(Ja,br.LEAD_FLOWS,"lead-flows"),Object(an.a)(Ja,br.MEETINGS,"salesMeetings"),Object(an.a)(Ja,br.CONVERSATIONS,"conversations"),Object(an.a)(Ja,br.DOCUMENTS,"salesDocuments"),Object(an.a)(Ja,br.FORMS,"marketingFreeForms"),Object(an.a)(Ja,br.SALES_FREE,"salesFree"),Object(an.a)(Ja,br.SALES_O365,"salesO365"),Object(an.a)(Ja,br.MARKETING_FREE_EMAIL,"marketingFreeEmail"),Object(an.a)(Ja,br.SALES_VSTO,"salesVsto"),Object(an.a)(Ja,br.MARKETING_ADS,"marketingAds"),Object(an.a)(Ja,br.TRIAL,"trial"),Object(an.a)(Ja,br.LEARNING_CENTER,"learningCenter"),Object(an.a)(Ja,br.LANDING_PAGES,"landingpages"),Object(an.a)(Ja,br.COMPANY_GRADER,"companygrader"),Object(an.a)(Ja,br.HUBSPOT_NETWORK,"hubspotnetwork"),Ja),vr={UTM_SOURCE:"UTM_SOURCE",UTM_MEDIUM:"UTM_MEDIUM",UTM_ID:"UTM_ID"},jr=(Xa={},Object(an.a)(Xa,vr.UTM_SOURCE,"utm_source"),Object(an.a)(Xa,vr.UTM_MEDIUM,"utm_medium"),Object(an.a)(Xa,vr.UTM_ID,"utm_id"),Xa),Sr={HUBS_CAMPAIGN:"HUBS_CAMPAIGN",HUBS_CONTENT:"HUBS_CONTENT",HUBS_CTA:"HUBS_CTA",HUBS_MEDIUM:"HUBS_MEDIUM",HUBS_SIGNUP_URL:"HUBS_SIGNUP_URL",HUBS_SOURCE:"HUBS_SOURCE"},yr=(Za={},Object(an.a)(Za,Sr.HUBS_CAMPAIGN,"hubs_campaign"),Object(an.a)(Za,Sr.HUBS_CONTENT,"hubs_content"),Object(an.a)(Za,Sr.HUBS_CTA,"hubs_cta"),Object(an.a)(Za,Sr.HUBS_MEDIUM,"hubs_medium"),Object(an.a)(Za,Sr.HUBS_SIGNUP_URL,"hubs_signup-url"),Object(an.a)(Za,Sr.HUBS_SOURCE,"hubs_source"),Za),Cr=n("uEQG"),Er="opt_sidebar",Tr="sales-extension-signup",Ir="livechat-signup",Rr="landing-pages",Ar="meeting",Nr="leadflows",xr="forms",Lr="documents",kr="crm-email",Mr="marketing-free",_r="skip_setup",Dr="partnerId",Pr="landingPageType",wr="viralSourcePortalId",Br="viralSourceUserId",Fr=($a={},Object(an.a)($a,Cr.i,Er),Object(an.a)($a,Cr.k,Er),Object(an.a)($a,Cr.g,Er),Object(an.a)($a,Cr.d,Er),Object(an.a)($a,Cr.f,Er),Object(an.a)($a,Cr.c,Er),Object(an.a)($a,Cr.b,Er),Object(an.a)($a,Cr.a,Er),Object(an.a)($a,Cr.h,Er),Object(an.a)($a,Cr.l,_r),Object(an.a)($a,Cr.j,Dr),Object(an.a)($a,Cr.e,Pr),Object(an.a)($a,Cr.m,wr),Object(an.a)($a,Cr.n,Br),$a),Ur=(er={},Object(an.a)(er,Cr.d,Rr),Object(an.a)(er,Cr.i,Ar),Object(an.a)(er,Cr.k,Tr),Object(an.a)(er,Cr.g,Ir),Object(an.a)(er,Cr.f,Nr),Object(an.a)(er,Cr.c,xr),Object(an.a)(er,Cr.b,Lr),Object(an.a)(er,Cr.a,kr),Object(an.a)(er,Cr.h,Mr),Object(an.a)(er,Cr.j,Dr),er),qr=Fr,Gr="/signup",Vr=Gr+"/crm",Hr=function(e){var t=[];Object.keys(e).sort().forEach(function(n){if(e.hasOwnProperty(n)){var a=e[n];a&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}});return t.length?"?"+t.join("&"):""},zr=function(e){if(fr.hasOwnProperty(e)&&gr.hasOwnProperty(e))return gr[e];console.error("Couldn`t find signup flow, defaulting to crm");return gr[fr.CRM]},Wr=function(e){if(br.hasOwnProperty(e)&&Or.hasOwnProperty(e))return Or[e];console.error("Couldn`t find intent for "+e+", leaving empty");return null},Kr=function(e){var t=Object.assign({},qr,{},yr,{},jr)[e];t||console.error("Couldn`t find mapping for "+e+", leaving empty");return t},Yr=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(i.a)(this,e);this.shouldUpdateOptions=!0;this.signupFlow=t;this.options=n||{};this.options.query||(this.options.query={});try{var a=zr(this.signupFlow);this.signupPathname=Gr+"/"+a;this.signupQueryParams=this.updateOptions(n)}catch(e){this.signupPathname=Vr;this.signupQueryParams=""}}Object(o.a)(e,[{key:"updateOptions",value:function(e){var t=e.query?Hr(e.query):"";this.shouldUpdateOptions=!1;return t}},{key:"getPathname",value:function(){return this.signupPathname}},{key:"getSearch",value:function(){if(this.shouldUpdateOptions){this.signupQueryParams=this.updateOptions(this.options);this.shouldUpdateOptions=!1}return this.signupQueryParams}},{key:"getUrl",value:function(){return""+this.signupPathname+this.getSearch()}},{key:"withIntent",value:function(e){var t=Wr(e);if(t){this.options.query.intent=t;this.shouldUpdateOptions=!0}return this}},{key:"withParam",value:function(e,t){var n=Kr(e);if(n){this.options.query[n]=t||Ur[e];this.shouldUpdateOptions=!0}return this}},{key:"withUtm",value:function(e,t){return this.withParam(e,t)}},{key:"withHubs",value:function(e,t){return this.withParam(e,t)}},{key:"withOption",value:function(e){return this.withParam(e)}}]);return e}(),Qr=function(e){return"https://app.hubspot.com"+new Yr(fr.SALES).withHubs(Sr.HUBS_CAMPAIGN,"hubspot-email-branding-virality").withHubs(Sr.HUBS_MEDIUM,"virality").withUtm(vr.UTM_SOURCE,"email").withUtm(vr.UTM_ID,"crm-email-signature-branding"+(pr(e)?"--"+e:"")).withIntent(br.SALES_FREE).withOption(Cr.a).getUrl()},Jr="email-branding-component",Xr=function(e){var t=Ua()({displayName:"EditableEmailBranding",propTypes:{block:f.a.object.isRequired},mixins:[or.a],componentDidMount:function(){var t=e.onMountBanner;t&&t()},componentWillUnmount:function(){var t=e.onDeleteBanner;t&&t()},render:function(){var e=this.props.block,t=hr(e.getData().get("emailBranding"));return Object(d.jsx)("div",{className:Jr,children:Object(d.jsx)(ur,{brandingCopy:t,signupLink:Qr(t)})})}});return Object(sr.a)(Jr)(t)},Zr=n("pzuj"),$r=n.n(Zr),ei="atomic",ti="EMAIL_BRANDING",ni="data-hs-email-branding",ai=function(e){var t=Xr(e);return function(e){return e.getType()===ei&&e.getData().get("atomicType")===ti?{component:t,editable:!1}:null}},ri=function(e){if(e.type===ei&&e.data.atomicType===ti){var t={display:"inline-block",maxWidth:22,verticalAlign:"middle"},n={color:"#516f90",outlineColor:"#516f90",fontSize:12,lineHeight:"1.125rem",fontFamily:"apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif",textAlign:"start",verticalAlign:"middle"},a=hr(e.data.emailBranding),r=un.a.text("customerDataCommunicator.branding."+a,{link:Qr(a)});return Object(d.jsxs)("div",{children:[Object(d.jsx)("img",{"aria-hidden":"true",style:t,src:"https:"+$r.a,width:22,height:22})," ",Object(d.jsx)("small",{style:n,children:Object(d.jsx)("span",{dangerouslySetInnerHTML:{__html:r}})})]})}return null},ii=function(e,t,n,a){return a===ei?null:t.hasAttribute(ni)?{type:ei,data:{atomicType:ti,emailBranding:t.innerHTML}}:null};function oi(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(rr.createPlugin)({blockRendererFn:ai(e),blockToHTML:ri,htmlToBlock:ii})}var si=n("rWb3"),ci=n("iJaT"),ui=n("BiPx"),li=n("GBWN"),di=n("Sshb"),pi=n("Ryvg"),mi=n("l52g"),hi=n("Tqy5"),fi=n("FGZp"),gi=n("OW66"),bi=n("sld6"),Oi=n("0vUY"),vi=n("WW83"),ji=n("3o4F"),Si=n("o22v"),yi=n("8B+i"),Ci=n("f9wP"),Ei=n("xL8J"),Ti=n("xTso"),Ii=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(ji.a)({FileManager:e.AsyncFileManager,drawerType:"IMAGE",httpClient:Yt.a});return Object(rr.compose)(Object(Si.a)(),Object(yi.a)({headerStyles:[],miscStyles:[]}),Object(Ci.a)({Button:t}),Object(Ei.a)(),Ti.a)},Ri=Ii()(vi.convertFromHTML),Ai=Ii()(vi.convertToHTML);n("ImZw");var Ni=["abbr","acronym","address","applet","article","aside","audio","bdi","bdo","big","blockquote","body","button","canvas","caption","center","cite","code","colgroup","command","datalist","dd","del","details","dfn","dialog","dir","dl","dt","embed","fieldset","figcaption","font","footer","form","frameset","head","header","hgroup","html","iframe","ins","kbd","keygen","label","legend","map","mark","menu","meter","nav","noframes","noscript","object","optgroup","output","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","strike","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","tt","var","video"],xi=["script","style"],Li="\\<(".concat(["basefont","hr","input","source","frame","param","area","meta","!--","col","link","option","base","wbr","!DOCTYPE"].join("|"),")[\\s\\S]*?>|\\<(",Ni.join("|"),")[\\s\\S]*?</\\2>"),ki="\\<(".concat(xi.join("|"),")[\\s\\S]*?</\\1>"),Mi=new RegExp(Li,"i"),_i=new RegExp(ki,"i"),Di=C()(function(e){return Mi.test(e)}),Pi=C()(function(e){return _i.test(e)});function wi(e){return Di(e)}function Bi(e){return Pi(e)}var Fi=n("fFSu"),Ui="<p></p>",qi=function(e){return e===Ui?"":e},Gi=function(e){return Ua()({displayName:"SignatureEditorState("+e.displayName+")",propTypes:{gates:f.a.object.isRequired,signature:f.a.string.isRequired,onChange:f.a.func.isRequired,onPreventSaveHTMLChange:f.a.func.isRequired},getInitialState:function(){var e=Ri(this.props.signature);return{editorState:fi.EditorState.createWithContent(e),html:this.props.signature}},componentDidMount:function(){Bi(this.state.html)&&this.props.onPreventSaveHTMLChange(!0)},handleEditorStateChange:function(e){var t=this,n=e.getCurrentContent();this.setState({editorState:e,html:qi(Ai(n))},function(){t.emitChange(!1)})},handleRawChange:function(e){var t=this,n=Bi(e),a=wi(e),r={html:e};if(!n&&!a){var i=Ri(e);r.editorState=fi.EditorState.createWithContent(i)}this.setState(r,function(){t.props.onPreventSaveHTMLChange(n);t.emitChange(!0)})},emitChange:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.props.onChange,n=this.state,a=n.editorState,r=n.html;t(e?r:qi(Ai(a.getCurrentContent())))},render:function(){var t=this.props,n=(t.signature,t.onChange,t.gates),a=Object(Fi.a)(t,["signature","onChange","gates"]),r=this.state,i=r.editorState,o=r.html;return Object(d.jsx)(e,Object.assign({},a,{editorState:i,html:o,onEditorStateChange:this.handleEditorStateChange,onRawChange:this.handleRawChange,gates:n}))}})},Vi=n("oFTO"),Hi="visual",zi="text",Wi=function(e){return wi(e)?zi:Hi},Ki=Gi(Ua()({displayName:"SignatureEditor",propTypes:{editorState:f.a.instanceOf(fi.EditorState).isRequired,html:f.a.string.isRequired,onEditorStateChange:f.a.func.isRequired,onRawChange:f.a.func.isRequired,AsyncFileManager:f.a.func,gates:f.a.shape({get:f.a.func.isRequired})},getInitialState:function(){return{activeEditor:Wi(this.props.html)}},UNSAFE_componentWillMount:function(){var e=this.props.gates&&this.props.gates.get("CRM:EnableFileManagerSidebar")?this.props.AsyncFileManager:null;this.RichEditor=Ii({AsyncFileManager:e})(rr.Editor)},handleEditorToggle:function(e){this.setState({activeEditor:e})},handleRawChange:function(e){var t=e.target.value;this.props.onRawChange(t)},renderToggle:function(){var e=this,t=this.props.html,n=this.state.activeEditor,a=wi(t),r=n===Hi,i=n===zi;return Object(d.jsxs)(gi.a,{children:[Object(d.jsx)(He.a,{disabled:!a,use:"default",placement:"bottom",title:un.a.text("signatureEditorModal.unsupportedHTML.description"),children:Object(d.jsx)(Ue.a,{active:r,use:"tertiary-light",size:"small",onClick:function(){return e.handleEditorToggle(Hi)},disabled:a,children:un.a.text("signatureEditorModal.labels.visual")})}),Object(d.jsx)(Ue.a,{active:i,use:"tertiary-light",size:"small",onClick:function(){return e.handleEditorToggle(zi)},children:un.a.text("signatureEditorModal.labels.text")})]})},renderRichEditor:function(){var e=this.props,t=e.editorState,n=e.onEditorStateChange,a=this.RichEditor;return Object(d.jsx)(a,{editorState:t,onChange:n})},renderRawEditor:function(){var e=this.props.html;return Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{className:"private-form__control raw-editor",children:Object(d.jsx)(Oi.a,{className:"raw-text-editor",resize:!1,value:e,onChange:this.handleRawChange})}),Object(d.jsx)("div",{className:"m-top-4",children:Object(d.jsx)("h5",{children:un.a.text("signatureEditorModal.labels.preview")})}),Object(d.jsx)("div",{className:"raw-text-editor-preview",children:Object(d.jsx)(Vi.a,{signature:e})})]})},render:function(){var e=this.state.activeEditor;return Object(d.jsxs)("div",{children:[Object(d.jsx)("h5",{children:Object(d.jsxs)(bi.a,{align:"center",justify:"between",direction:"row",wrap:"nowrap",children:[Object(d.jsx)("div",{children:un.a.text("signatureEditorModal.labels.signature")}),this.renderToggle()]})}),e===Hi?this.renderRichEditor():this.renderRawEditor(),Object(d.jsx)("p",{className:"p-top-4",children:un.a.text("signatureEditorModal.descriptions.signature")})]})}})),Yi=n("WLqE"),Qi={signature:f.a.string,error:f.a.string,gates:f.a.object,showLoading:f.a.bool,saveDisabled:f.a.bool,promptToSave:f.a.bool,onUpdateSignatureChanged:f.a.func,onSave:f.a.func.isRequired,onClose:f.a.func.isRequired,onPreventSaveHTMLChange:f.a.func.isRequired,containsUnsupportedHTML:f.a.bool,AsyncFileManager:f.a.func},Ji={gates:Object(p.Set)(),showLoading:!1,saveDisabled:!1,promptToSave:!1,onUpdateSignatureChanged:De.a,containsUnsupportedHTML:!1},Xi=function(e){Object(l.a)(t,e);function t(e){var n;Object(i.a)(this,t);(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).handleChange=n.handleChange.bind(Object(u.a)(n));n.handleSave=n.handleSave.bind(Object(u.a)(n));n.handleUpdateSignatureChanged=n.handleUpdateSignatureChanged.bind(Object(u.a)(n));n.state={signature:e.signature||""};return n}Object(o.a)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.signature;t!==this.props.signature&&this.setState({signature:t})}},{key:"getTagsPreventingSave",value:function(){return xi.map(function(e){return Object(d.jsx)("span",{children:"<"+e+">"},e)})}},{key:"getSaveDisabledTooltip",value:function(){return this.props.containsUnsupportedHTML?Object(d.jsxs)("div",{children:[Object(d.jsx)(we.a,{message:"signatureEditorModal.unsupportedHTML.saveButtonDisabled"}),Object(d.jsx)(qe.a,{className:"m-top-1",children:this.getTagsPreventingSave()})]}):null}},{key:"handleChange",value:function(e){this.setState({signature:e})}},{key:"handleUpdateSignatureChanged",value:function(e){var t=e.target.checked;this.props.onUpdateSignatureChanged(t)}},{key:"handleSave",value:function(){var e=this.state.signature;this.props.onSave(e)}},{key:"renderSignatureTextEditor",value:function(){var e=this.props,t=e.gates,n=e.showLoading,a=e.AsyncFileManager,r=this.state.signature;return n?Object(d.jsx)("div",{className:"loading-container",children:Object(d.jsx)(mi.a,{grow:!0})}):Object(d.jsx)(Ki,{AsyncFileManager:a,signature:r,gates:t,onChange:this.handleChange,onPreventSaveHTMLChange:this.props.onPreventSaveHTMLChange})}},{key:"renderUpdateCheckbox",value:function(){return this.props.promptToSave?Object(d.jsx)("div",{children:Object(d.jsx)(He.a,{placement:"left",title:un.a.text("signatureEditorModal.labels.update.tooltip"),children:Object(d.jsx)(hi.a,{onChange:this.handleUpdateSignatureChanged,children:un.a.text("signatureEditorModal.labels.update.prompt")})})}):null}},{key:"renderError",value:function(){var e=this.props.error;return e?Object(d.jsx)(si.a,{className:"m-top-4",type:"danger",titleText:un.a.text("signatureEditorModal.errors.title"),children:e}):null}},{key:"render",value:function(){var e=this.props,t=e.saveDisabled,n=e.onClose;return Object(d.jsxs)(ci.a,{className:"sig-editor",size:"auto",width:600,children:[Object(d.jsxs)(li.a,{children:[Object(d.jsx)(ui.a,{onClick:this.props.onClose}),Object(d.jsx)(Yi.a,{children:un.a.text("signatureEditorModal.labels.editEmailSignature")})]}),Object(d.jsxs)(di.a,{children:[this.renderSignatureTextEditor(),this.renderUpdateCheckbox(),this.renderError()]}),Object(d.jsxs)(pi.a,{children:[Object(d.jsx)(He.a,{disabled:!t,title:this.getSaveDisabledTooltip(),children:Object(d.jsx)(Ue.a,{use:"primary",onClick:this.handleSave,disabled:t,"data-selenium-test":"sig-editor-crm-acceptance-test-submit",children:un.a.text("signatureEditorModal.labels.save")})}),Object(d.jsx)(Ue.a,{onClick:n,children:un.a.text("signatureEditorModal.labels.cancel")})]})]})}}]);return t}(m.Component);Xi.propTypes=Qi;Xi.defaultProps=Ji;var Zi=Xi,$i="UNINITIALIZED",eo="PENDING",to="SUCCESS",no="FAILURE",ao="userpreferences/v1/signature",ro=function(){return Yt.a.get(ao)},io=function(e){return Yt.a.put(ao,{data:e,headers:{"content-type":"text/plain"}})},oo={gates:f.a.object.isRequired,id:f.a.string,onCloseModal:f.a.func.isRequired,onSave:f.a.func,signature:f.a.string,AsyncFileManager:f.a.func},so={gates:Object(p.Set)(),onSave:De.a,signature:null},co="SIGNATURE_TOO_LONG",uo=function(e){return un.a.text("signatureEditorModal.errors.signatureTooLong",{maxLength:e.maxCharacterLength})},lo=function(e){var t=un.a.text("signatureEditorModal.errors.unableToUpdateSignature");e&&400===e.status&&e.responseJSON&&e.responseJSON.errorType===co&&(t=uo(e.responseJSON));return t},po=function(e){Object(l.a)(t,e);function t(e){var n;Object(i.a)(this,t);n=Object(s.a)(this,Object(c.a)(t).call(this,e));var a=e.signature,r=e.id;n.handleSave=n.handleSave.bind(Object(u.a)(n));n.handleUpdateSignatureChanged=n.handleUpdateSignatureChanged.bind(Object(u.a)(n));n.handleSignatureFetchSuccess=n.handleSignatureFetchSuccess.bind(Object(u.a)(n));n.handleSignatureFetchFailed=n.handleSignatureFetchFailed.bind(Object(u.a)(n));n.handleSignatureSaveSuccess=n.handleSignatureSaveSuccess.bind(Object(u.a)(n));n.handleSignatureSaveFailed=n.handleSignatureSaveFailed.bind(Object(u.a)(n));n.handlePreventSaveHTML=n.handlePreventSaveHTML.bind(Object(u.a)(n));n.state={signature:a,id:r,updatingSignature:!n.signatureProvided(),error:void 0,fetchSignatureRequestStatus:null!==a?to:$i,saveSignatureRequestStatus:$i,containsUnsupportedHTML:!1};return n}Object(o.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){if(!this.signatureProvided()){this.setState({fetchSignatureRequestStatus:eo});ro().then(this.handleSignatureFetchSuccess,this.handleSignatureFetchFailed)}}},{key:"signatureProvided",value:function(){return null!=this.props.signature}},{key:"showLoading",value:function(){var e=this.state,t=e.fetchSignatureRequestStatus,n=e.saveSignatureRequestStatus;return!this.signatureProvided()&&(t===$i||t===eo)||n===eo}},{key:"saveDisabled",value:function(){var e=this.state,t=e.fetchSignatureRequestStatus,n=e.saveSignatureRequestStatus,a=e.containsUnsupportedHTML;return t!==to||n===eo||a}},{key:"triggerOnSave",value:function(e){var t=this.state.updatingSignature,n=this.props,a=n.onCloseModal;(0,n.onSave)(e,t);a()}},{key:"handleUpdateSignatureChanged",value:function(e){this.setState({updatingSignature:e})}},{key:"handleSignatureFetchSuccess",value:function(e){this.setState({fetchSignatureRequestStatus:to,id:e.id,signature:e.signature||""})}},{key:"handleSignatureFetchFailed",value:function(){this.setState({fetchSignatureRequestStatus:no,error:un.a.text("signatureEditorModal.errors.unableToLoadSignature")})}},{key:"handleSignatureSaveSuccess",value:function(e){this.setState({saveSignatureRequestStatus:to});this.triggerOnSave(e)}},{key:"handleSignatureSaveFailed",value:function(e){this.setState({saveSignatureRequestStatus:no,error:lo(e)})}},{key:"handleSave",value:function(e){var t=this.state,n=t.updatingSignature,a=t.id;if(n){this.setState({saveSignatureRequestStatus:eo});io(e,a).then(xn()(this.handleSignatureSaveSuccess,e),this.handleSignatureSaveFailed)}else this.triggerOnSave(e)}},{key:"handlePreventSaveHTML",value:function(e){this.setState({containsUnsupportedHTML:e})}},{key:"render",value:function(){var e=this.state,t=e.signature,n=e.error;return e.saveSignatureRequestStatus!==to?Object(d.jsx)(Zi,{AsyncFileManager:this.props.AsyncFileManager,signature:t,error:n,showLoading:this.showLoading(),saveDisabled:this.saveDisabled(),promptToSave:this.signatureProvided(),onUpdateSignatureChanged:this.handleUpdateSignatureChanged,onSave:this.handleSave,onClose:this.props.onCloseModal,gates:this.props.gates,onPreventSaveHTMLChange:this.handlePreventSaveHTML,containsUnsupportedHTML:this.state.containsUnsupportedHTML}):null}}]);return t}(m.Component);po.defaultTypes=so;po.propTypes=oo;var mo=po,ho=n("V0w3"),fo=n("d1d8"),go=n("0agr"),bo=(n("0HCf"),n("EipP")),Oo=n("FqPN"),vo=n("GXw1"),jo=n("8dyM"),So=n("FN/f"),yo=n("jZYs"),Co=function(e){Object(l.a)(t,e);function t(){Object(i.a)(this,t);return Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}Object(o.a)(t,[{key:"render",value:function(){var e,t=this.props,n=t.onChange,a=t.options,r=t.placeholder,i=t.searchable,o=t.onSearchChange,s=t.value,c=Object(Fi.a)(t,["onChange","options","placeholder","searchable","onSearchChange","value"]);a.forEach(function(t){t.value!==s||e||(e=t);0});return Object(d.jsx)(Sa.a,Object.assign({},c,{buttonText:e?e.text:Object(jo.a)(r),children:Object(d.jsx)(Oo.a,{resultsClassName:"p-y-0",minimumSearchCount:i?0:1/0,onChange:n,onSearchChange:o,options:a})}))}}]);return t}(m.Component);Co.propTypes={buttonClassName:f.a.string,buttonUse:f.a.oneOf(Object.keys(vo.c)).isRequired,onChange:f.a.func,onSearchChange:f.a.func,options:f.a.arrayOf(yo.c).isRequired,placeholder:Object(So.a)(f.a.string).isRequired,searchable:f.a.bool.isRequired,value:yo.d};Co.defaultProps={buttonClassName:"p-x-2",buttonUse:"transparent",placeholder:function(){return un.a.text("salesUI.UIDropdownSelect.placeholder")},searchable:!1};Co.displayName="UIDropdownSelect";var Eo=Object(bo.a)(Co,["open","value"]),To=n("6dOn"),Io=n.n(To),Ro={onChange:f.a.func.isRequired,matches:f.a.array,matchesToAppend:f.a.array,placeholder:f.a.string,showShortName:f.a.bool,truncateButton:f.a.bool,value:f.a.string,width:f.a.number,buttonUse:f.a.string,onGetAvatar:f.a.func,requireMultipleOptionsForEdit:f.a.bool,useUISelect:f.a.bool,noResultsText:f.a.string,setState:f.a.func,searchText:f.a.string,setSearchText:f.a.func,placement:f.a.string},Ao={objectType:A.CONTACT,state:{searchText:""},width:400,matchesToAppend:[],buttonUse:"link",requireMultipleOptionsForEdit:!1,searchText:""},No=xn()(go.a,w.a),xo=function(e){Object(l.a)(t,e);function t(e){var n;Object(i.a)(this,t);(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).handleSearchChange=function(e){var t=e.target.value;n.setSearchText(t)};n.handleInputValueChange=function(e){var t=e.target.value;n.handleUpdateSearchValueChange(t)};n.handleUpdateSearchValueChange=function(e){n.setSearchText(e)};n.handleContactChange=function(e){var t=e.target.value;n.props.onChange(t)};n.handleUpdateSearchValueChange=Io()(250,n.handleUpdateSearchValueChange);n.state={defaultContactDetermined:!!e.value};return n}Object(o.a)(t,[{key:"componentDidMount",value:function(){this.checkIfDefaultContactDetermined()}},{key:"UNSAFE_componentWillUpdate",value:function(e){if(this.props.value&&!e.value){this.setState({defaultContactDetermined:!1});this.setSearchText(void 0)}}},{key:"componentDidUpdate",value:function(e,t){this.checkIfDefaultContactDetermined();this.state.defaultContactDetermined&&this.state.defaultContactDetermined!==t.defaultContactDetermined&&this.notifyDefaultContactDetermined()}},{key:"setSearchText",value:function(e){this.props.setState&&this.props.setState({searchText:e});this.props.setSearchText&&this.props.setSearchText(e)}},{key:"resolveMatches",value:function(e){var t=this.props,n=t.showShortName,a=t.matchesToAppend,r=t.onGetAvatar;e=e.map(function(e){if(e.record&&n){e.text=No(e.record);e.avatar=r&&r(e.record)}return e});a.length&&(e=this.formatDropdownGroups(e));return e}},{key:"checkIfDefaultContactDetermined",value:function(){var e=this.state.defaultContactDetermined,t=this.props,n=t.value,a=t.matchesToAppend;if(!e&&!n){var r=this.props.matches;(this.getSingleMatch(r,a)||r&&r.length)&&this.setState({defaultContactDetermined:!0})}}},{key:"notifyDefaultContactDetermined",value:function(){var e=this.props,t=e.onChange,n=e.matches,a=e.matchesToAppend,r=this.getSingleMatch(n,a)||null;r&&t(r)}},{key:"formatDropdownGroups",value:function(e){var t=this.props.matchesToAppend,n=Object(d.jsx)(we.a,{message:"twilio.phoneNumbers.contact"}),a=Object(d.jsx)(we.a,{message:"twilio.phoneNumbers.company"});return[{text:n,options:e=e.filter(function(e){return!t.find(function(t){return t.value===e.value})})},{text:a,options:t}]}},{key:"getSingleMatch",value:function(e,t){if(void 0!==e){var n=e&&e.length;return!(t&&t.length)&&e&&1===e.length?e[0].value:!n&&t&&1===t.length?t[0].value:void 0}}},{key:"getDefaultContact",value:function(){var e=this.props,t=e.value,n=e.matches,a=e.matchesToAppend;return t?""+t:this.getSingleMatch(n,a)}},{key:"render",value:function(){var e=this.props,t=e.matchesToAppend,n=e.useUISelect,a=e.noResultsText,r=t&&t.length||0,i=this.props.matches||[],o=r+i.length;i=this.resolveMatches(i);var s="m-top-1 contact-search-select"+(this.props.truncateButton?" truncated":""),c=r||n?Ba.a:Eo,u=this.props.requireMultipleOptionsForEdit&&o<2;return Object(d.jsx)(c,{"data-selenium-test":"contact_search_select",buttonClassName:s,buttonUse:this.props.buttonUse,menuWidth:this.props.width,noResultsText:a,onChange:this.handleContactChange,onInputValueChange:this.handleInputValueChange,onSearchChange:this.handleSearchChange,options:i,placeholder:this.props.placeholder,placement:this.props.placement,readOnly:u,searchable:!0,value:this.getDefaultContact()})}}]);return t}(Ta.a);xo.displayName="ContactSearchSelect";xo.propTypes=Ro;xo.defaultProps=Ao;var Lo=xo,ko=function(e){var t={matches:e},n=Object(M.connect)(t,D.a)(Lo);function a(e){var t=Object(m.useState)(""),a=Object(Ye.a)(t,2),r=a[0],i=a[1];return Object(d.jsx)(n,Object.assign({},e,{searchText:r,setSearchText:i}))}a.displayName="StatefulContactSearchSelect";return a},Mo=n("W2dw"),_o=n("rEFu"),Do=n("ufkj"),Po=Object(p.Record)({EmailActions:new Mo.a,EmailProviderBranding:Object(p.Map)(),JitaMessageComponent:null,OnboardingComponent:null,RecipientResolverFactories:Object(Do.b)(),RichTextEditorResults:null,SalesContentMenu:null,SignatureEditorComponent:null,SignaturePlugin:null,EmailBrandingPlugin:null,SignatureUnsubscribePlugin:null,common:new It,dependencies:null,footerClassName:"",getEmailIntegrationLinks:function(){return Object(_o.a)()},getMeetingsLinks:function(){},isJitaUser:function(){return!1},makeContactSearchSelect:null,openHelpWidget:function(e){return window.open(e,"_blank")},SendLaterPopover:null,createEmailMetadata:null,onDeleteEmailBrandingBanner:function(){},renderEmailBranding:function(){return!1},hasEmailBrandingBanner:function(){return!1},isOptedInToProfileActionsRedesign:!1,InboxConnectWizardDialog:null},"EmailInteractionComponentConfig");function wo(e,t){Object(je.a)(e,t)}var Bo=n("vNYB"),Fo=n("VcCP"),Uo=Object(p.Record)({address:null,sendResult:Fo.b,hasStatus:function(){return this.sendResult!==Fo.b},deliverable:function(){return this.sendResult!==Fo.a}},"EmailRecipientDeliverabilityRecord"),qo=n("ap+s"),Go=n("OuMQ"),Vo=n("WYIs"),Ho=n("G/lG"),zo={send:"engagements-emails/v1/email/send",sendUsingHubSpot:"conversations-email/v1/send/crm",deliverability:function(e){return"email/v1/contacts/"+encodeURIComponent(e)+"/subscriptions/predict-drop"}},Wo=function(e){return Object(p.Map)({is_transactional:!0,portal_id:st.a.get(),app_id:e})},Ko=function(e,t){return Uo(t).set("address",e)},Yo=function(e,t){var n=t||{},a=Object(Go.b)(Vo.d),r=Object(p.fromJS)(n.responseJSON||{}),i=r.has("@error")?r.get("@error"):r.get("errorType"),o=Object(Go.a)({errorType:i,defaultMessage:a,emailRecord:e,isUngatedForEmailSettingsMigration:Ho.a.get("EmailSettingsMigration")});Object(ze.a)({error:new Error("Email send failed"),extraData:{error:r},tags:{communicatorType:"EMAIL"}});return Promise.reject(o)};function Qo(e,t){var n=t.appId;if(!n||!e){var a=e?"appId":"emailAddress";return Promise.reject({message:a+" is null."})}var r=xn()(Ko,e);return wt.e(zo.deliverability(e),Wo(n)).then(r,function(e){return Promise.reject(e)})}function Jo(e,t,n){var a=n.source,r=t.toJS();return wt.f({type:qo.e,headers:{"X-Source":a},query:r},zo.send,e).then(function(e){return e&&Bo.a.fromJS(e)},xn()(Yo,e))}function Xo(e,t){var n=t.source;return wt.f({type:qo.d,headers:{"X-Source":n}},zo.sendUsingHubSpot,e).then(Bo.a.fromJS,xn()(Yo,e))}function Zo(e,t,n,a){var r=a.source,i=t.toJS();i.replyToEngagementId=n;return wt.f({type:qo.e,headers:{"X-Source":r},query:i},zo.send,e).then(Bo.a.fromJS,xn()(Yo,e))}var $o=function(e){return"email/v1/contacts/"+encodeURIComponent(e)+"/subscriptions?source=SOURCE_HUBSPOT_CUSTOMER"};function es(e){return Object(wt.c)($o(e))}Object(Bt.a)(es,"EmailSubscriptionAPI.fetch");var ts=function(e){var t=e.engagementId,n=e.emailAddress,a=e.lawfulBasis,r=e.explanation;return""+("email/v2/contacts/"+encodeURIComponent(n)+"/subscriptions/one-off-legal-basis")+("?legalBasis="+a+"&legalBasisExplanation="+r+"&engagementId="+t)};function ns(e){return Object(wt.d)(ts(e))}var as=n("7qCc"),rs=function(e,t){return{email:e,engagement:t}};function is(e,t){Qo(e,t).then(function(e){return wo(ee.W,e)}).done()}function os(e,t,n){return Jo(e,t,n).then(xn()(rs,e))}function ss(e,t){return Xo(e,t).then(xn()(rs,e))}function cs(e,t,n,a){return Zo(e,t,n,a).then(xn()(rs,e))}function us(e,t,n,a,r,i){return Object(as.b)(e,t,n,a,r,i).then(xn()(rs,e))}function ls(e){return ns(e)}function ds(e){Object(je.c)(ee.U,e)}function ps(e){Object(je.c)(ee.V,e)}function ms(){return Ln.a.then(function(e){var t="users/v1/users/"+e.get("user_id")+"/verifications";return Object(wt.d)(t)})}function hs(){return ms()}var fs=Object(Mo.a)({fetchEmailRecipientDeliverabilityStatus:is,sendConfirmationEmail:hs,sendEmail:os,sendEmailUsingHubSpot:ss,sendReplyEmail:cs,scheduleEmail:us,provideLegalBasisForCommunication:ls,updateLocalLawfulBasis:ds,completeLocalLawfulBasis:ps}),gs={stores:[xt.a],deref:function(e){var t=e.subjectId;return xt.a.get(t)}},bs=Object(M.connect)({subject:gs},D.a)(Et(nr)),Os=new(Object(p.Record)({meetings:null},"MeetingsLinks"))({meetings:"/meetings/"+st.a.get()}),vs=n("s8DR"),js=n("BPM/"),Ss=function(e,t){return e({id:t.value,label:t.text,referencedObject:t})},ys=function(e,t){var n=H()(p.Seq,q()(xn()(Ss,t)));return function(t,a){var r=e(t,a);return Object($.d)(r)?r:n(r)}},Cs=function(e,t){e.deref=ys(e.deref,t);return e},Es=function(e,t){var n=e.RecipientResolverFactory,a=e.ReferenceRecord,r=e.makeReferenceResolver,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return new n({dependency:t,create:function(e,t,n){var o=Cs(i.get(e,t,n),a),s=Object(M.connectCallback)({result:o},D.a);return r({search:function(e,t){return s(function(e,n){var a=n.result;if(e)throw e;Object($.d)(a)||t({results:a,count:a.count(),hasMore:!1,offset:a.count()})},{searchText:Z()("query",e),value:Z()("value",e),objectType:Z()("objectType",e),parseFunc:Z()("parseFn",e)}).remove}})}})},Ts=n("8qhJ"),Is=n.n(Ts),Rs=n("aZYI"),As=n("ITHK"),Ns=n("AF1D"),xs=function(e){return""+Object(wa.a)(e)},Ls=function(e){return{id:e}},ks=function(e,t){return{record:t,text:Object(wa.h)(t),value:e(t)}},Ms=xn()(ks,xs),_s=n("v95M"),Ds=20,Ps={cacheTimeout:5e3},ws=Is()(["count","filterGroups","sorts"]),Bs=function(e,t){return e?e.map(t).toArray():[]};function Fs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t,a=n.parseMatchValue,r=void 0===a?Ls:a,i=n.processMatchesFunc,o=void 0===i?J.a:i,s=n.toMatchFunc,c=void 0===s?Ms:s;t=ws(t);return{stores:[Ns.a,e],deref:function(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.filterFunc,s=n.objectType,u=n.parseFunc,l=n.value,d=Object(Rs.a)(n,a);if(!d){if(!l)return Sn.b;var m=(Array.isArray(l)?Object(p.List)(l):p.List.of(l)).map(r);if(m.some(function(e){return!e.id}))return Sn.b;var h=m.reduce(function(t,n){var a=n.id;return t.concat(p.List.of(e.get(a)))},Object(p.List)()).filter(J.a);if(h.isEmpty())return Sn.b;var f=o(h,{value:m});return Bs(f,c)}var g=_s.a.default(Object(p.fromJS)(Object.assign({query:d,count:Ds},t)),s),b=Ns.a.get({objectType:s,searchQuery:g,options:Ps});if(!b)return Sn.b;var O=Object(As.a)(s).dataKey,v=e.get(b.get(O));o&&(v=o(v,{searchText:d}));v=Bs(v,c);i&&(v=v.filter(i));u&&(v=u(v));return v}}}var Us=n("aeBh"),qs=n("ODtf"),Gs=n.n(qs),Vs=Object(p.Record)({query:"",count:20,offset:0},"OwnersSearchQuery");Vs.fromJS=function(e){return e?Vs(e):e};Vs.isOwnersSearchQuery=Gs()(Vs);Vs.isValid=function(e){if(!Vs.isOwnersSearchQuery(e))return!1;var t=e.count,n=e.offset,a=e.query;return ne()(a)&&fe()(t)&&t>0&&fe()(n)&&n>=0};var Hs=Vs,zs=n("emzX"),Ws=n.n(zs),Ks=n("k6JV"),Ys=n.n(Ks),Qs=n("c+8p"),Js=n.n(Qs),Xs=n("kcGL"),Zs=n.n(Xs);function $s(e){return e.reduce(function(e,t){return e.union(M.InspectStore.getActionTypes(t))},Object(p.Set)()).toArray()}function ec(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===n?Ws()(e(t),"JoinStore: expected `idIsValid` to return true for id: `%s`",t):Ws()(e(t),"JoinStore: expected `idIsValid` to return true for ids[%s]: `%s`",n,t);return t}var tc=function(e){return null!=e};function nc(e){return Ys()(e)||Zs()(e)||p.Iterable.isIterable(e)}function ac(e,t){for(var n=t.length,a=t[0].get(e),r=1;r<n;r++){if(Object($.c)(a)||Object($.d)(a))return a;a=t[r].get(a)}return a}function rc(e){var t=e.idIsValid,n=void 0===t?tc:t,a=e.join,r=void 0===a?ac:a,i=e.stores;Ws()(Array.isArray(i),"expected `stores` to be an Array of Stores but got `%s`",i);Ws()(Js()(n),"expected `idIsValid` to be a function but got `%s`",n);Ws()(Js()(r),"expected `idIsValid` to be a function but got `%s`",r);return Object(M.defineFactory)().defineGetInitialState(function(){return C()(r)}).defineGet(function(e,t){if(n(t))return e(t,i);Ws()(nc(t),"JoinStore: expected a valid id or an Array/Object/Iterable of valid ids but got `%s`",t);return q()(function(t,a){return e(ec(n,t,a),i)},t)}).defineResponseTo($s(i),function(e){return e.cache.isEmpty()?e:C()(r)})}var ic=n("xtZR"),oc=n.n(ic),sc=n("bxcW"),cc=Z()("count"),uc=Z()("offset"),lc=Z()("query");function dc(e){return ne()(lc(e))&&fe()(uc(e))&&fe()(cc(e))}function pc(e){return oc()(e)||p.Iterable.isIterable(e)?e:Object(p.Map)(e)}var mc=Z()("searchResult");function hc(e){if(null===e)return e;Ws()(sc.a.isPaginatedSearchResponse(e),"expected `response` to be a `PaginatedSearchResponse` but got `%s`",e);return mc(e)}function fc(e){var t=e.namespace,n=e.fetch;return Object(ae.b)({namespace:t,idTransform:pc,fetch:n})}function gc(e){var t=e.namespace,n=e.idIsValid;return Object(ae.a)({namespace:t,idIsValid:n?function(e){return dc(e)&&n(e)}:dc,idTransform:pc,responseTransform:hc})}fc({namespace:_.l,fetch:G.g});var bc=gc({namespace:_.l,idIsValid:Hs.isValid}).defineName("OwnerIdsSearchStore").register(D.a),Oc=rc({stores:[bc,ve],join:function(e){var t=bc.get(e);if(!t)return t;var n=ve.get(t.results);return n.some($.d)?$.b:t.set("results",n)},idIsValid:Hs.isValid}).defineName("OwnersSearchStore").register(D.a),vc=[Oc,ve],jc=function(e){return e&&e.split(".")[1]},Sc=function(e){return Us.a.fromJS({vid:"owner."+e.ownerId,properties:{firstname:{value:e.firstName},lastname:{value:e.lastName},email:{value:e.email}}})},yc=function(e){var t=e.formatWithEmail,n=function(e){var n=Sc(e);return{record:n,text:t(e),value:n.vid}},a=function(e){return function(t,a){a=a||{};var r,i,o=Object(p.List)(),s=Object(Rs.a)(t,a),c=e(t,a);if(Object($.d)(c))return c;var u=jc(t.value);u&&(r=ve.get(u));if(s){var l=Hs({query:s});i=Oc.get(l)&&Oc.get(l).get("results")}i&&(o=o.concat(i));r&&(o=o.push(r));if(!o.size)return c;var d=o.toSet().filter(function(e){return e.get("email")}).map(n).toArray();return c.concat(d)}};return function(e){return{stores:e.stores.concat(vc),deref:a(e.deref)}}},Cc="email",Ec="firstname",Tc="lastname",Ic="hs_additional_emails",Rc=new RegExp("\\s+"),Ac=function(e){return e.trim().replace(Rc," ").toLowerCase()},Nc=function(e,t){return!!e&&e.toLowerCase().indexOf(t)>-1},xc=function(e,t,n){return Nc(Object(wa.d)(e,t),n)},Lc=function(e,t){return Nc(Object(wa.d)(e,Ec)+" "+Object(wa.d)(e,Tc),t)},kc=function(e,t){return xc(e,Ec,t)||xc(e,Tc,t)||Lc(e,t)},Mc=function(e,t){return Object(wa.f)(e,Cc,t)},_c=function(e,t,n){var a=Object(wa.d)(t,Ic);if(!a)return e;a.split(";").forEach(function(a){n&&!Nc(a,n)||(e=e.push(Mc(t,a)))});return e},Dc=function(e){return function(t,n){if(kc(n,e)){t=t.push(n);t=_c(t,n)}else{xc(n,Cc,e)&&(t=t.push(n));t=_c(t,n,e)}return t}},Pc=_n.n,wc=function(e){return Object(_n.m)(Object(wa.a)(e),Object(wa.d)(e,Cc))},Bc=_n.m,Fc=xn()(ks,wc),Uc={parseMatchValue:Pc,processMatchesFunc:function(e,t){var n=t.searchText,a=t.value;if(!(n=n||(void 0===a?{}:a).emailAddress))return e;n=Ac(n);return e.reduce(Dc(n),Object(p.List)())},toMatchFunc:Fc},qc=function(e){return e?Uc:void 0},Gc=function(e){var t=yc(e);return{get:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeAdditionalEmailAddresses,n=qc(void 0===e||e);return t(Fs(xt.a,n))},toId:Bc}},Vc=n("duMR"),Hc=Gc(Ie),zc=xn()(Es,{RecipientResolverFactory:Vc.a,ReferenceRecord:js.a,makeReferenceResolver:vs.a}),Wc=Object(Do.b)(Object(an.a)({},A.CONTACT,zc(Hc))),Kc=new Po({EmailActions:fs,EmailProviderBranding:ia,RecipientResolverFactories:Wc,RichTextEditorResults:fo.a,SalesContentMenu:bs,SignatureEditorComponent:mo,SignaturePlugin:ar.a,EmailBrandingPlugin:oi,SignatureUnsubscribePlugin:ho.a,common:It,getMeetingsLinks:function(){return Os},makeContactSearchSelect:ko}),Yc=function(e,t,n,a){return new It({appId:e,appSource:t,hasScope:n,hasPortalSetting:a})},Qc=function(e){return Kc.merge(e).set("dependencies",An)},Jc=n("lpDa"),Xc=function(){return Object(d.jsxs)("div",{className:"text-center p-top-10",children:[Object(d.jsx)("h4",{children:"JITA users can't send email"}),"Please add yourself to this portal if you would like to send email."]})};Xc.displayName="JITAAlert";var Zc,$c=function(){return!0},eu=function(e){if(!Jc.a.get())return!1;var t=Jc.a.get().get(e);return!0===t||"true"===t},tu=Qc({SignaturePlugin:null,SignatureEditorComponent:null,JitaMessageComponent:Xc,common:Yc(xe.b,"LIVE_MESSAGES_UI",$c,eu)}),nu=tu.set("dependencies",Ne()(["showTrackingTooltip"],tu.get("dependencies"))),au=n("19qb"),ru=n("bn2T"),iu=n("Ig8d"),ou=n("snvP"),su=n("ydXj"),cu=function(e){var t=Object(ou.e)(e);return new iu.a({metadata:Object(p.Map)({ccs:Object(ou.c)(e)||Object(p.List)(),bccs:Object(ou.b)(e)||Object(p.List)(),from:Object(ou.f)(e),subject:Object(ou.n)(e),to:Object(ou.q)(e)||Object(p.List)(),templateId:Object(ou.o)(e)}),rawEditorContent:Object(su.a)(t)})},uu=n("N7iy"),lu=n("3kxU"),du=function(e,t){var n=t?Object(p.Set)(t.accounts.flatMap(function(e){return e.getIn(["aliasList","state"])===lu.a||e.getIn(["integration","state"])===lu.a?[]:e.getIn(["aliasList","aliases"]).map(function(t){var n=e.get("address"),a=t.get("displayableAddress");return new uu.a({accountId:n,address:n,displayableAddress:a})})}).toArray()):Object(p.Set)(),a=Object(ou.f)(e),r=Z()("address",a),i=Z()("sendAsAddress",a)||r,o=new uu.a({accountId:r,address:r,displayableAddress:i});return n.contains(o)?new kn.a({from:a,aliasEmailAddresses:n}):new kn.a({aliasEmailAddresses:n})},pu=n("MBJP"),mu=n("Zwz/"),hu=(Zc={},Object(an.a)(Zc,A.CONTACT,"contactIds"),Object(an.a)(Zc,A.COMPANY,"companyIds"),Object(an.a)(Zc,A.DEAL,"dealIds"),Object(an.a)(Zc,A.TICKET,"ticketIds"),Zc),fu=Object(pu.a)([mu.a],function(e){var t=new p.Map({contactIds:Object(p.List)(),companyIds:Object(p.List)(),dealIds:Object(p.List)(),ticketIds:Object(p.List)()});return e?e.reduce(function(e,t){var n=t.get("type"),a=t.get("id"),r=hu[n];return r&&e.get(r)?e.set(r,e.get(r).push(a)):e},t):t}),gu=n("IqVT"),bu=n("Albu"),Ou=Object(gu.createAction)(bu.b,function(e){var t=e.threadId;return{associations:e.associations,threadId:t}}),vu=n("tyhE"),ju=function(e){var t=e.associationType;return{key:"associated-crm-object-in-communicator",properties:{action:"associated crm object",channel:vu.a.EMAIL,"association-type":t}}},Su=function(e){var t=e.associationType;return{key:"unassociated-crm-object-in-communicator",properties:{action:"unassociated crm object",channel:e.source,"association-type":t}}},yu=Object(gu.createAction)(bu.a,function(e){var t=e.threadId;return{association:e.association,threadId:t}}),Cu=function(e){var t=e.threadId,n=e.association;return function(e){Object(L.e)(ju({associationType:n.get("type")}));e(yu({threadId:t,association:n}))}},Eu=Object(gu.createAction)(bu.c,function(e){var t=e.threadId;return{association:e.association,threadId:t}}),Tu=function(e){var t=e.threadId,n=e.association;return function(e){Object(L.e)(Su({associationType:n.get("type")}));e(Eu({threadId:t,association:n}))}},Iu=function(){return Promise.resolve.apply(Promise,arguments)};function Ru(e){var t=function(t){Object(l.a)(n,t);function n(e){var t;Object(i.a)(this,n);(t=Object(s.a)(this,Object(c.a)(n).call(this,e))).addAssociation=function(e,n){var a=t.props,r=a.addAssociation,i=a.addSystemAssociations,o=a.threadId;if(p.List.isList(n)){i({associations:n.map(function(t){return Object(p.Map)({id:t,type:e})}).toSet(),threadId:o})}else if("number"==typeof n){r({association:Object(p.Map)({type:e,id:n}),threadId:o})}};t.removeAssociation=function(e,n){var a=t.props,r=a.removeAssociation,i=a.threadId;"number"==typeof n&&r({threadId:i,association:Object(p.Map)({type:e,id:n})})};var a=e.connectedAccounts,r=e.reply,o=e.onSend;t.state={emailActions:new Mo.a({fetchEmailRecipientDeliverabilityStatus:is,sendEmail:o,sendReplyEmail:Iu}),initialInteraction:cu(r),sender:du(r,a)};return t}Object(o.a)(n,[{key:"render",value:function(){var t=this.props,n=t.associations,a=t.conversationsInteract,r=t.isReply,i=t.onAttach,o=t.onCancel,s=t.onChange,c=t.onRemoveAttachment,u=t.reply,l=Object(Fi.a)(t,["associations","conversationsInteract","isReply","onAttach","onCancel","onChange","onRemoveAttachment","reply"]),p=this.state,m=p.emailActions,h=p.initialInteraction,f=p.sender,g=r?ru.f:null,b=Object(ou.a)(u);return Object(d.jsx)(e,Object.assign({},l,{allowSenderChange:!0,associations:n,attachments:b,EmailActions:m,enableMultipleToAddresses:!0,interaction:h,isJitaUser:function(){return!a},isConversationsInteraction:!0,objectTypesToAssociate:[A.CONTACT,A.COMPANY,A.DEAL,A.TICKET],onAttachmentAdded:i,onAttachmentRemoved:c,onCancel:o,onInteractionChange:s,onRemoveAssociation:this.removeAssociation,onSave:function(){},onSaveStatusChanged:s,onUpdateAssociation:this.addAssociation,replyEngagementType:g,sender:f,sendToAnyEmailAddress:!r,showTrackingTooltip:!1}))}}]);return n}(m.PureComponent);t.displayName="InteractionBasic";t.propTypes={addAssociation:f.a.func.isRequired,addSystemAssociations:f.a.func.isRequired,associations:f.a.instanceOf(p.Map).isRequired,connectedAccounts:Object(I.a)("ConnectedAccountsRecord"),conversationsInteract:f.a.bool.isRequired,isReply:f.a.bool,onAttach:f.a.func.isRequired,onCancel:f.a.func.isRequired,onChange:f.a.func.isRequired,onSend:f.a.func.isRequired,removeAssociation:f.a.func,reply:Object(I.a)("CommonReplyRecord"),threadId:f.a.oneOfType([f.a.number,f.a.oneOf([k.a])]).isRequired};t.defaultProps={onAttach:function(){},onCancel:function(){},onChange:function(){},onRemoveAttachment:function(){},onSend:function(){}};var n=function(e,t){var n=t.threadId;return{associations:fu(e,{threadId:n})}},a={addAssociation:Cu,addSystemAssociations:Ou,removeAssociation:Tu};return Object(au.connect)(n,a)(t)}var Au=Object(p.Record)({type:null,icon:null,label:null,engagementType:null,onboardingAware:!1,Component:null,wrappers:Object(p.Seq)(),passthruRtePlugins:void 0,localTransforms:Object(p.Seq)(),applicable:function(){return!0}},"InteractionDescriptorRecord"),Nu=n("kEfQ"),xu=n("M76c");function Lu(e,t){var n=null,a=null;e.richTextEditorResults.hasContent()&&(n=e.richTextEditorResults.toRawEditorContent());e.internalRichTextEditorResults&&e.internalRichTextEditorResults.hasContent()&&(a=e.internalRichTextEditorResults.toRawEditorContent());return t.set("associations",e.associations).set("rawEditorContent",n).set("rawInternalNoteEditorContent",a).set("savable",e.savable)}function ku(e,t){var n=e.get("ownerIds")?e.get("associations",Object(p.Map)()).set("ownerIds",e.get("ownerIds")):e.get("associations");return t.set("associations",n).set("rawEditorContent",e.get("rawEditorContent")).set("rawInternalNoteEditorContent",e.get("rawInternalNoteEditorContent")).set("savable",e.get("savable"))}var Mu=n("sbZX"),_u=n.n(Mu),Du=Object(p.Seq)(["subject","ccs","bccs","from","to","templateId","replyEngagementId","replyEngagementType","isForward"]),Pu=function(e){var t=e.get("address");return t?e.set("address",t.toLowerCase()):null},wu={subject:!0,ccs:function(e){return e.get("ccs").map(function(e){return new Ve.a(e)})},bccs:function(e){return e.get("bccs").map(function(e){return new Ve.a(e)})},from:function(e){return new Ve.a(Pu(e.get("from")))},to:function(e){var t=e.get("to");p.List.isList(t)||(t=Object(p.List)([t]));return t.map(function(e){return new Ve.a(e)})},templateId:!0,replyEngagementId:!0,replyEngagementType:!0,isForward:!0};function Bu(e,t){return t.set("email",e.metadata.filter(function(e,t){return Du.includes(t)}))}function Fu(e,t){var n=e.get("email");if(!n)return t;var a=t.metadata.merge(_u()(wu,n));return t.set("metadata",a)}var Uu=Au({type:Nu.EMAIL,icon:"email",engagementType:ru.c,passthruRtePlugins:new xu.a,localTransforms:Object(p.Seq)([a,r]),applicable:Object(p.Seq)()}),qu=n("NNP0"),Gu=n("CkxV"),Vu=(Object(Gu.a)(qu.a),Object(p.OrderedSet)());function Hu(e){Ws()("function"==typeof e,"expected `checker` to be a function but got `%s`",e);return e}function zu(e){Vu=Vu.add(Hu(e))}function Wu(e){Vu=Vu.remove(Hu(e))}var Ku=Object(p.Record)({navigationHandler:null,abandonChangesPromptKey:"customerDataCommunicator.InteractionWithNavigationConfirmation.abandonChanges.prompt"},"InteractionWithNavigationConfirmationComponentConfig"),Yu={children:f.a.node,descriptor:f.a.instanceOf(Au).isRequired,handleNavigationTriggered:f.a.func},Qu={handleNavigationTriggered:De.a};function Ju(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ku();return function(t){var n=function(n){Object(l.a)(a,n);function a(){var t,n;Object(i.a)(this,a);for(var r=arguments.length,o=new Array(r),u=0;u<r;u++)o[u]=arguments[u];(n=Object(s.a)(this,(t=Object(c.a)(a)).call.apply(t,[this].concat(o)))).handleGetNavigationConfirmation=function(){var t=n.props.descriptor.type,a=e.abandonChangesPromptKey;n.props.handleNavigationTriggered();return n.showPreventNavigation?un.a.text(a,{objectType:t}):null};n.handlePreventNavigation=function(e){n.showPreventNavigation=e};return n}Object(o.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){zu(this.handleGetNavigationConfirmation)}},{key:"componentWillUnmount",value:function(){Wu(this.handleGetNavigationConfirmation)}},{key:"render",value:function(){return Object(d.jsx)(t,Object.assign({},this.props,{onPreventNavigation:this.handlePreventNavigation,children:this.props.children}))}}]);return a}(Ta.a);n.propTypes=Yu;n.defaultProps=Qu;return n}}var Xu=Ju(Ku({abandonChangesPromptKey:"customerDataCommunicator.InteractionWithNavigationConfirmation.abandonChanges.emailPrompt"})),Zu=n("Ah6I"),$u=1024,el=(Math.pow($u,2),Object(p.Seq)(["ade","adp","bat","chm","cmd","com","cpl","exe","hta","ins","isp","jar","js","jse","lib","lnk","mde","msc","msi","msp","mst","nsh","pif","scr","sct","shb","sys","vb","vbe","vbs","vxd","wsc","wsf","wsh"])),tl=C()(function(e){return el.contains(e)});function nl(e){var t=e.get("extension");return!!tl(t)&&{key:"contactInteraction.errors.attachments.invalidType",options:{extension:t}}}var al=Object(p.Record)({portalId:null,getPreviewUrl:function(){}},"ThumbnailUrlConfig"),rl=n("i5cO"),il=Object(p.Map)({pdf:"pdfFile",doc:"",txt:"",xls:"",default:"file"});function ol(e){return il.get(e.get("extension"))||il.get("default")}var sl=n("6N2u"),cl=n("Y33h"),ul=n("fPxq"),ll=n("MO2O");function dl(e){var t=e.attachmentName,n=e.description,a=e.isOpen,r=e.onCancelClick,i=e.onRemoveClick;if(!a)return null;var o=Object(d.jsx)(we.a,{message:"deleteModal.removeTitle",options:{name:t}}),s=Object(d.jsx)(we.a,{message:"deleteModal.remove"}),c=Object(d.jsx)(we.a,{message:"deleteModal.cancel"});return Object(d.jsx)(ll.a,{confirmLabel:s,description:n,onConfirm:i,onReject:r,message:o,rejectLabel:c})}dl.propTypes={attachmentName:f.a.string.isRequired,description:f.a.node,isOpen:f.a.bool.isRequired,onCancelClick:f.a.func.isRequired,onRemoveClick:f.a.func.isRequired};var pl=dl,ml=Xe()(cl.a).withConfig({displayName:"Attachment__SpacedUIFileAttachment",componentId:"sc-1d7n0vp-0"})([".media-body{padding-right:5px !important;width:180px;}"]);ml.displayName="SpacedUIFileAttachment";var hl={attachment:b.a.mapContains({id:f.a.number,extension:f.a.string,name:f.a.string.isRequired,size:f.a.number.isRequired}).isRequired,canView:f.a.bool,hasInteractions:f.a.bool,onRemoved:f.a.func,optionRemoveWithModal:f.a.bool,removeModalDescription:f.a.node,thumbnailUrlConfig:f.a.instanceOf(al).isRequired,renderSize:f.a.string,useIconThumbnail:f.a.bool},fl={canView:!0,hasInteractions:!1,optionRemoveWithModal:!1,renderSize:"small",useIconThumbnail:!1},gl=function(e){Object(l.a)(t,e);function t(e){var n;Object(i.a)(this,t);(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).handleShowModal=function(){n.setState({isModalOpen:!0})};n.handleHideModal=function(){n.setState({isModalOpen:!1})};n.handleError=function(){n.state.hasThumbnailLoadedSuccessfully&&n.setState({hasThumbnailLoadedSuccessfully:!1})};n.handleCloseClick=function(){var e=n.props,t=e.attachment,a=e.onRemoved;n.state.isModalOpen&&n.handleHideModal();a&&a(t.get("id"))};n.partial=C()(xn.a);n.state={isModalOpen:!1,hasThumbnailLoadedSuccessfully:!0};return n}Object(o.a)(t,[{key:"renderProgressBar",value:function(){var e=this.props.attachment;if(e.get("id"))return null;var t=1e4/e.get("size");return Object(d.jsx)(ul.a,{optimismFactor:t,optimismIncrement:100})}},{key:"renderName",value:function(e){var t=this.props,n=t.hasInteractions,a=t.attachment,r=t.canView,i=t.thumbnailUrlConfig;if(!n)return e;var o=un.a.text("customerDataEmail.Attachments.viewDisabled");return Object(d.jsx)(sl.a,{disabled:r,title:o,children:Object(d.jsx)(Ea.a,{use:"dark",href:i.getPreviewUrl(a.get("id")),target:"_blank",disabled:!r,children:e})})}},{key:"renderThumbnail",value:function(){var e=this.props.attachment;return Object(d.jsx)(Aa.a,{onError:this.handleError,src:Object(rl.a)(e,"icon"),shape:"thumbnail",style:{maxHeight:"21px"}})}},{key:"renderThumbnailIcon",value:function(){var e=this.props.attachment;return Object(d.jsx)(Ke.a,{name:ol(e),className:"p-top-1 p-right-2"})}},{key:"renderRemoveAttachmentModal",value:function(){var e=this.props,t=e.attachment,n=e.removeModalDescription;return Object(d.jsx)(pl,{attachmentName:t.get("name"),description:n,isOpen:this.state.isModalOpen,onCancelClick:this.handleHideModal,onRemoveClick:this.handleCloseClick})}},{key:"renderPreview",value:function(){var e=this.state.hasThumbnailLoadedSuccessfully;return this.props.useIconThumbnail||!e?this.renderThumbnailIcon():this.renderThumbnail()}},{key:"render",value:function(){var e=this.props,t=e.attachment,n=e.optionRemoveWithModal,a=e.onRemoved,r=e.renderSize,i=t.get("extension"),o=t.get("name");o=i?o+"."+i:o;var s=!(!a||!t.get("id")),c=this.renderProgressBar();return Object(d.jsxs)(m.Fragment,{children:[Object(d.jsx)(ml,{fileName:this.renderName(o),fileType:t.get("type"),fileInfo:un.a.formatSize(t.get("size")),renderPreview:this.renderPreview(),closeable:s,onCloseClick:n?this.handleShowModal:this.handleCloseClick,size:r,children:c}),n?this.renderRemoveAttachmentModal():null]})}}]);return t}(Ta.a);gl.propTypes=hl;gl.defaultProps=fl;var bl=gl,Ol={attachments:b.a.listOf(b.a.map).isRequired,attachmentsInProgress:b.a.listOf(b.a.map),canView:f.a.bool.isRequired,childClassName:f.a.string,hasInteractions:f.a.bool.isRequired,inline:f.a.bool.isRequired,onAttachmentRemoved:f.a.func,optionRemoveWithModal:f.a.bool,removeModalDescription:f.a.node,thumbnailUrlConfig:f.a.instanceOf(al).isRequired,useDefaultPadding:f.a.bool,useIconThumbnail:f.a.bool},vl={canView:!0,hasInteractions:!1,inline:!0,useDefaultPadding:!0,optionRemoveWithModal:!1,useIconThumbnail:!1},jl=function(e){Object(l.a)(t,e);function t(e){var n;Object(i.a)(this,t);(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).renderAttachment=n.renderAttachment.bind(Object(u.a)(n));return n}Object(o.a)(t,[{key:"renderAttachment",value:function(e){var t=this.props,n=t.canView,a=t.hasInteractions,r=t.onAttachmentRemoved,i=t.optionRemoveWithModal,o=t.removeModalDescription,s=t.thumbnailUrlConfig,c=t.useIconThumbnail;return Object(d.jsx)(bl,{attachment:e,canView:n,hasInteractions:a,optionRemoveWithModal:i,onRemoved:r,removeModalDescription:o,thumbnailUrlConfig:s,useIconThumbnail:c},e.get("name"))}},{key:"render",value:function(){var e=this.props,t=e.attachments,n=e.attachmentsInProgress,a=e.inline,r=e.useDefaultPadding,i=e.childClassName,o=v()(i,"m-bottom-1 m-right-1");return Object(d.jsxs)(qe.a,{className:"p-bottom-2 display-flex flex-wrap"+(r?" p-left-1 p-y-2":""),childClassName:o,inline:a,children:[t.map(this.renderAttachment),n&&n.map(this.renderAttachment)]})}}]);return t}(Ta.a);jl.propTypes=Ol;jl.defaultProps=vl;var Sl=jl,yl=n("a9fy"),Cl=n.n(yl)()(function(){return{query:{hidden:!0},hideAndProtectFile:!0}}),El={file:function(){return!1},all:function(){return Object(p.Seq)()}},Tl=Object(p.Record)({GenericPluginGroup:null,AttachmentPlugin:null,FileManagerAttachmentPlugin:null,fileOptions:Cl(),thumbnailUrlConfig:al(),validators:El,onOpenPopover:function(){}},"InteractionWithValidatedAttachmentsComponentConfig"),Il=n("Xc69"),Rl=n("jNxY"),Al=n("DF6h"),Nl={enabled:!0,tooltip:null,multiple:!0};function xl(e){var t=e.getCurrentOptions?e.getCurrentOptions():{};return Object.assign({},Nl,e,t)}function Ll(e){var t=e.icon,n=e.messageKey;return t?Object(d.jsx)(Ke.a,{name:t}):n?Object(d.jsx)(T.a,{message:n}):null}function kl(e){var t=this,n=function(n){var a=xl(e),r=n.closePopover,i=a.enabled,o=a.tooltip,s=a.multiple,c=function(){if(a.onChange){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];a.onChange.apply(t,n)}r&&r()};return Object(d.jsx)(He.a,{title:o,disabled:!o,children:Object(d.jsx)(Al.a,{use:"secondary",multiple:s,disabled:!i,onChange:c,children:Ll(a)})})};n.propTypes={closePopover:f.a.func};return n}function Ml(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(rr.createPlugin)({displayName:"ToolbarUploadActionPlugin",buttons:kl(e)})}var _l={messageKey:"customerDataCommunicator.attachmentOptions.upload",onAttachmentSelected:De.a,onAttachmentUploadStarted:De.a};function Dl(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=(arguments.length>4?arguments[4]:void 0).target.files;if(r&&0!==r.length){var i=Object(p.List)([]);Array.prototype.slice.call(r).forEach(function(e){var r={name:e.name,size:e.size,type:e.type};i=i.push(Object(p.Map)(r));Object(Rl.d)(e,a).then(function(e){return Object(p.fromJS)(e)}).then(function(e){var n=e.getIn(["objects",0]);if(n){n=n.merge({originalName:r.name});t(n)}},function(e){return n(e,Object(p.Map)(r))})});e(i)}}function Pl(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},_l,e)).onChange=xn()(Dl,e.onAttachmentUploadStarted,e.onAttachmentSelected,e.onAttachmentUploadFailed,e.fileOptions);return Ml(e)}function wl(e,t){return e?Object(d.jsx)(Ke.a,{name:e}):t?Object(d.jsx)(T.a,{message:t}):null}var Bl=Object(m.memo)(function(e){var t=e.tooltip,n=e.tooltipPlacement,a=e.onClick,r=e.icon,i=e.messageKey;return Object(d.jsx)(He.a,{disabled:!t,title:t,placement:n,children:Object(d.jsx)(Ue.a,{onClick:a,children:wl(r,i)})})});function Fl(e){return function(t){Object(l.a)(n,t);function n(){var t;Object(i.a)(this,n);(t=Object(s.a)(this,Object(c.a)(n).call(this))).handleClick=function(){t.setState({open:!0});e.onPluginOpenModal&&e.onPluginOpenModal();if(e.onClick){for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];e.onClick.apply(Object(u.a)(t),a)}};t.handleSelect=function(n){e.onAttachmentSelected(n);t.setState({open:!1})};t.handleClose=function(){t.setState({open:!1})};t.onCloseComplete=function(){e.onPluginCloseModal&&e.onPluginCloseModal()};t.state={open:!1};return t}Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;Fe()().then(function(t){e.setState({auth:t})})}},{key:"renderFileManager",value:function(){return this.state.open?Object(d.jsx)(e.AsyncFileManager,{auth:this.state.auth,httpClient:Yt.a,onSelect:this.handleSelect,onClose:this.handleClose,onCloseComplete:this.onCloseComplete,SharedDragDropContext:e.SharedDragDropContext}):null}},{key:"render",value:function(){var t=e.icon,n=e.tooltip,a=e.tooltipPlacement,r=void 0===a?"bottom":a,i=e.messageKey;return Object(d.jsxs)(m.Fragment,{children:[this.renderFileManager(),Object(d.jsx)(Bl,{tooltip:n,placement:r,onClick:this.handleClick,icon:t,messageKey:i})]})}}]);return n}(m.Component)}function Ul(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(rr.createPlugin)({displayName:"FileManagerSidebar",buttons:Fl(e)})}var ql={messageKey:"customerDataCommunicator.attachmentOptions.sharedFiles",onAttachmentSelected:De.a,onPluginOpenModal:De.a,onPluginCloseModal:De.a};function Gl(e){e()}function Vl(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},ql,e)).onClick=xn()(Gl,e.onAttachmentSelected,e.onPluginOpenModal,e.onPluginCloseModal,e.gates,e.AsyncFileManager);return Ul(e)}var Hl=function(e){return"/file-preview/"+st.a.get()+"/file/"+e+"/"},zl=new al({portalId:st.a.get(),getPreviewUrl:Hl}),Wl=new Tl({GenericPluginGroup:Il.a,AttachmentPlugin:Pl,FileManagerAttachmentPlugin:Vl,thumbnailUrlConfig:zl}),Kl=n("FONj"),Yl=n("mpvR"),Ql=n("zmx5"),Jl=n("Mr4n"),Xl=n("6ePo"),Zl=n("QmtD"),$l=n("bkwg"),ed=n("U0r4"),td="ATTACHMENTS";Object(ed.a)({actionTypePrefix:td,fetcher:Zl.a});var nd=Object($l.a)({actionTypePrefix:td}).register(D.a),ad={stores:[nd],deref:function(e){var t=e.interaction,n=e.attachments;if(n&&n.size)return n;if(!t||!t.metadata.get("isForward"))return Object(p.List)();var a=t.get("attachments");if(!a.size)return Object(p.List)();var r=a.map(function(e){return e.get("id")}).filter(J.a);return nd.get(r).filter(J.a)}},rd=Object(Jl.DropTarget)(Ql.NativeTypes.FILE,{drop:function(e,t){return{files:t.getItem().files}}},function(e,t){return{connectDropTarget:e.dropTarget(),isHovered:t.isOver()}}),id={attachments:f.a.instanceOf(p.List).isRequired,children:f.a.node,gates:Object(g.setOf)(f.a.string),passthruRtePlugins:f.a.instanceOf(xu.a).isRequired,handleResizeIframe:f.a.func,handleUsageLogging:f.a.func,logUsageTrackingEvent:f.a.func,onSave:f.a.func,onAttachmentRemoved:f.a.func,onAttachmentAdded:f.a.func,engagementType:f.a.string,threadId:f.a.oneOfType([f.a.string,f.a.number]),AsyncFileManager:f.a.func},od={passthruRtePlugins:new xu.a,handleResizeIframe:De.a,handleUsageLogging:De.a,onAttachmentAdded:De.a,onAttachmentRemoved:De.a,logUsageTrackingEvent:De.a},sd={enabled:!0,tooltip:null},cd=Object(d.jsx)(T.a,{message:"customerDataCommunicator.InteractionWithValidatedAttachments.tooltip"}),ud="top",ld=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wl;return function(t){var n=function(n){Object(l.a)(a,n);function a(t){var n;Object(i.a)(this,a);(n=Object(s.a)(this,Object(c.a)(a).call(this,t))).handleGetFileUploadOptions=function(){return sd};n.onResetSendValidation=function(){n.state.errors.isEmpty()||n.setState({errors:Object(p.List)()})};n.validateFile=function(t){var a=n.props.attachments,r=e.validators;if(-1!==a.findIndex(function(e){return e.get("id")===t.get("id")})){n.setState({warning:{key:"customerDataCommunicator.Email.api.errors.DUPLICATE_ATTACHMENTS"}});return!1}var i=nl(t)||r.file(t);if(i){n.setState({warning:i});return!1}return!0};n.handleSave=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.state.attachments;e&&(e=e.set("attachments",r));t&&(t=t.set("attachments",r));n.setState({attachments:Object(p.List)(),attachmentsInProgress:Object(p.List)()});return n.props.onSave(e,t,a)};n.handleRemoveAttachment=function(e){p.List.isList(e)||(e=Object(p.List)([e]));var t=n.state.attachments;t=S()(function(t){return e.contains(t.get("id"))},t);n.setState({attachments:t,warning:!1,errors:Object(p.List)()});n.props.onAttachmentRemoved(e)};n.handleAddAttachment=function(e){n.setState({attachments:n.state.attachments.push(e),warning:!1});n.props.onAttachmentAdded(e)};n.handleAttachmentSelected=function(e,t){if(t&&t.get("id")){n.props.handleUsageLogging("addedAttachment",{subAction:e});var a=n.props.engagementType;n.props.logUsageTrackingEvent({action:"insert file",eventKey:"communicator_fileInteraction",engagementType:a,extraData:{fileType:t.get("type"),fileSource:"upload"===e?e:"attached",source:n.props.threadId?"inbox":"communicator"}});var r=n.state.attachmentsInProgress;r=r.filter(function(e){return!t.get("originalName")||t.get("originalName")!==e.get("name")});n.setState({attachmentsInProgress:r});n.validateFile(t)&&n.handleAddAttachment(t)}};n.handleAttachmentUploadStarted=function(e){var t=n.state.attachmentsInProgress,a=p.List.isList(e)?e:Object(p.List)([e]);n.setState({attachmentsInProgress:t.concat(a)})};n.handleAttachmentUploadFailed=function(e,t){var a=n.state.attachmentsInProgress;a=a.filter(function(e){return!t||t.get("name")!==e.get("name")});n.setState({attachmentsInProgress:a});Object(Yl.b)("customerDataCommunicator.InteractionWithValidatedAttachments.attachmentUploadFailed",{fileName:t&&t.get("name")})};n.handleWarningClosed=function(){n.setState({warning:!1})};n.onBeforeSendValidation=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).editorState,a=e.validators,r=t&&t.getCurrentContent().getBlockMap().filter(function(e){var t=e.getData();return e.getType()===Xl.g&&t.get("atomicType")===Xl.f&&100===t.getIn(["image","uploadPercent"])}).map(function(e){return e.getData().get("image")}).toList(),i=n.state.attachments;r&&r.size&&(i=i.concat(r));var o=a.all(i);if(o.isEmpty()){n.state.errors.isEmpty()||n.setState({errors:Object(p.List)()});return!0}n.setState({errors:o});return!1};n.partial=C()(xn.a);n.state=n.createInitialState();return n}Object(o.a)(a,[{key:"componentDidUpdate",value:function(e){e.attachments!==this.props.attachments&&this.setState({attachments:this.props.attachments})}},{key:"createInitialState",value:function(){var t=this,n=e.GenericPluginGroup,a=e.AttachmentPlugin,r=e.FileManagerAttachmentPlugin,i=e.fileOptions,o=this.props.passthruRtePlugins,s=this.props,c=s.gates,u=s.AsyncFileManager;return{passthruRtePlugins:o=o.concatPlugins(n([r({AsyncFileManager:u,gates:c,onAttachmentSelected:this.partial(this.handleAttachmentSelected,"file manager"),fileOptions:i,onPluginOpenModal:function(){t.props.handleResizeIframe("fullscreen")},onPluginCloseModal:function(){t.props.handleResizeIframe("windowed")}}),a({onAttachmentUploadStarted:this.handleAttachmentUploadStarted,onAttachmentSelected:this.partial(this.handleAttachmentSelected,"upload"),onAttachmentUploadFailed:this.handleAttachmentUploadFailed,fileOptions:i,getCurrentOptions:this.handleGetFileUploadOptions})],{icon:"attach",inline:!1,className:"private-dropdown--list",tooltip:cd,tooltipPlacement:ud,onOpenPopover:e.onOpenPopover})).concatPluginComposers(Object(Kl.a)({fileOptions:i,onNonImageUploadStarted:this.handleAttachmentUploadStarted,onNonImageUploadFailed:this.handleAttachmentUploadFailed,onDropNonImage:this.partial(this.handleAttachmentSelected,"drag and drop")})),warning:!1,attachmentsInProgress:Object(p.List)(),attachments:this.props.attachments,errors:Object(p.List)()}}},{key:"renderWarning",value:function(){var e=this.state.warning;return e?Object(d.jsx)(si.a,{className:"m-bottom-4",closeable:!0,onClose:this.handleWarningClosed,type:"warning",children:Object(d.jsx)(T.a,{message:e.key,options:e.options})}):null}},{key:"renderError",value:function(e){return Object(d.jsx)(T.a,{message:e.key,options:e.options},e.key)}},{key:"renderErrors",value:function(){var t=this.props,n=t.engagementType,a=t.attachments,r=this.state.errors;if(n!==ru.c&&a.size){r=e.validators.all(a)}return r.isEmpty()?null:Object(d.jsx)(si.a,{className:"m-bottom-4",type:"danger",children:Object(d.jsx)(qe.a,{styled:r.size>1,children:r.map(this.renderError)})})}},{key:"renderAttachmentList",value:function(){var t=e.thumbnailUrlConfig,n=this.state,a=n.attachmentsInProgress,r=n.attachments;return Object(d.jsx)(Sl,{attachments:r,attachmentsInProgress:a,hasInteractions:!0,onAttachmentRemoved:this.handleRemoveAttachment,thumbnailUrlConfig:t})}},{key:"renderAttachments",value:function(){var e=this.state,t=e.attachmentsInProgress;return e.attachments.size||t.size?Object(d.jsxs)(m.Fragment,{children:[this.renderWarning(),this.renderErrors(),this.renderAttachmentList()]}):this.renderErrors()}},{key:"render",value:function(){var e=this.props.children,n=this.state,a=n.passthruRtePlugins,r=n.errors,i=n.attachmentsInProgress;return Object(d.jsxs)(t,Object.assign({},this.props,{attachments:this.state.attachments,attachmentsValid:r.isEmpty(),isUploadingAttachments:!!i.size,onResetSendValidation:this.onResetSendValidation,onSave:this.handleSave,passthruRtePlugins:a,onBeforeSendValidation:this.onBeforeSendValidation,children:[Object(d.jsx)("div",{className:"attachments",style:{overflowY:"scroll",maxHeight:100},children:this.renderAttachments()}),e]}))}}]);return a}(m.Component);n.propTypes=id;n.defaultProps=od;var a=rd(n),r={attachments:ad};return Object(M.connect)(r)(Object(Zu.a)()(a))}},dd=Math.pow(1024,2),pd=100,md=20*dd,hd={key:"customerDataEmail.Attachments.errors.totalSize",options:{max:md/dd}},fd={key:"customerDataEmail.Attachments.errors.maxNum",options:{max:pd}},gd=function(e){return e.reduce(function(e,t){return e+t.get("size")},0)},bd=function(e){var t=Object(p.List)(),n=gd(e);if(n>md){var a=(n/dd).toFixed(2),r=Object.assign({total:a},hd.options);t=t.push(Object.assign({},hd,{options:r}))}e.size>pd&&(t=t.push(fd));return t},Od={file:function(){return!1},all:function(e){return bd(e)}},vd=Wl.set("validators",Od),jd=n("qvRI"),Sd=Object(N.b)(function(){var e=ld(vd.merge({onOpenPopover:function(){jd.a.log("communicatorInteraction",{action:"click to attach file",activity:"email",channel:"email",source:"inbox"})}})),t=n("JMwr"),a=n("wrRD"),r=t.default||t,i=(a.default||a).buildEmail(nu),o=Uu.merge({Component:i,wrappers:Object(p.Seq)([e,Xu,r,Ru])});return Object(p.Seq)([o])}),yd=n("Rf1a"),Cd=n.n(yd);function Ed(e,t){if(e){if("function"==typeof e)return e(t);if(e.size)return Cd()(function(e){return e(t)},e)}return!0}function Td(e){var t=function(t){return e.find(function(e){return e.type===t})},n=function(e,n){if(!e)return!1;var a=t(e);return null!=a&&Ed(a.applicable,n)};return{getAllDescriptors:function(){return e},getDescriptor:function(e){return t(e)},getDefault:function(t,a,r){return n(a,r)?a:n(t,r)?t:e.first().type},activate:function(e){return this.getDescriptor(e).onActivated()}}}var Id=function(e){var t=Td(e);return Object.assign({},t,{getDefault:function(e,n,a){return t.getDefault(e,n,a)}})},Rd=function(e){if(e){var t=e.find(function(e){return Boolean(Z()("id",e))})||e.first();if(t)return new Us.a(Object(p.fromJS)({properties:{email:{value:Z()("address",t)},firstname:{value:Z()("firstName",t)},lastname:{value:Z()("lastName",t)}},vid:Z()("id",t)||null}))}return new Us.a},Ad=function(e){return Dn.a.fromJS({accounts:e.toList().map(function(e){var t=e.email,n=e.emailAccountType,a=e.friendlyFromName,r=e.isActive,i=e.sendFromEmail,o=e.resolvedFromName,s=i||t,c=r?lu.b:lu.a;return{address:t,friendlyFromName:o||a,sendFromEmail:i,integration:{type:n,state:c},aliasList:{state:c,aliases:[{address:t,displayableAddress:s,primary:!0}]}}})})},Nd="INACTIVE_ACCOUNT",xd="MISSING_ACCOUNT",Ld="NO_CONNECTED_ACCOUNTS",kd=n("GEiH"),Md=n("ngaI"),_d=n("lAFI"),Dd=n.n(_d),Pd=n("6Djj"),wd=n("NSir");function Bd(e){Object(wd.a)(e&&e.id,"The connected acccount must be defined and have an id, given "+e);return Pd.a.put("/conversations-email/v1/connected-accounts/"+e.id,{data:e})}var Fd=n("Twuc"),Ud=function(e){return Object(kd.a)({requestFn:Bd,actionTypes:Fd.b,toRecordFn:Md.a})(Dd()(["isActive"],function(e){return!e},e))},qd=n("Zqny"),Gd=n("FXjx"),Vd=n("PHk6");function Hd(e){var t=e.children,n=e.enabled,a=e.useReadOnly,r=Object(Fi.a)(e,["children","enabled","useReadOnly"]);return n?t:Object(d.jsx)(He.a,Object.assign({title:Object(d.jsx)(we.a,{message:"conversations-thread-view.access-control.adminAccessRequired"})},r,{children:Object(m.cloneElement)(t,{disabled:!0,readOnly:!!a||void 0})}))}Hd.displayName="EnabledForAdmins";Hd.propTypes={children:f.a.node.isRequired,enabled:f.a.bool.isRequired,useReadOnly:f.a.bool};var zd=Hd;function Wd(e){return{enabled:Object(Vd.a)(e)}}var Kd=Object(au.connect)(Wd,{})(zd),Yd={body:f.a.node,buttonText:f.a.node,href:f.a.string,onClick:f.a.func,title:f.a.node};function Qd(e){var t=e.body,n=e.buttonText,a=e.onClick,r=e.title,i=e.href;return Object(d.jsxs)(Gd.a,{className:"text-center p-top-6",children:[Object(d.jsx)("h5",{className:"m-bottom-3",children:r}),Object(d.jsx)("p",{children:t}),Object(d.jsx)("div",{className:"display-inline",children:Object(d.jsx)(Kd,{children:Object(d.jsx)(Ue.a,{use:"tertiary",size:"small",href:i,onClick:a,children:n})})})]})}Qd.displayName="AbstractConnectedAccountError";Qd.propTypes=Yd;var Jd={connectedAccount:Object(I.a)("ConnectedEmailAccount"),toggleAccountStatus:f.a.func};function Xd(e){var t=e.toggleAccountStatus,n=e.connectedAccount,a=function(){t(n.toJS())},r=Object(d.jsx)(we.a,{message:"conversations-thread-view.connected-accounts.disabledReplyEmail.title",options:{email:Object(qd.d)(n)}}),i=Object(d.jsx)(we.a,{message:"conversations-thread-view.connected-accounts.disabledReplyEmail.body"}),o=Object(d.jsx)(we.a,{message:"conversations-thread-view.connected-accounts.disabledReplyEmail.button"});return Object(d.jsx)(Qd,{title:r,body:i,buttonText:o,onClick:a})}Xd.displayName="DisabledReplyEmail";Xd.propTypes=Jd;var Zd={toggleAccountStatus:Ud},$d=Object(au.connect)(null,Zd)(Xd),ep=n("QM91"),tp=function(e,t){if(!e||!e.size)return Ld;var n=Object(ep.a)(e,t);return n?Object(qd.h)(n)?null:Nd:xd},np=n("6gGY"),ap=n("1AW5"),rp="channels/email/create",ip=":inboxId/email/create",op=n("LjUL");function sp(e){return Object(op.a)()+"/"+e}var cp=n("mpe+"),up=function(e){return e.search&&e.search.length?Object(ct.parse)(e.search.substring(1)):{}},lp=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location;if(up(t).seleniumRun){var n="?";e.endsWith("?")?n="":e.includes("?")&&(n="&");return""+e+n+"seleniumRun=true"}return e},dp=function(e){var t=null!==e||void 0!==e||""!==e?Object(cp.a)(ip,e):sp(rp);return lp(t)},pp=function(e,t){return dp(t)+"?returnToThread="+e+"&fromInbox=true"},mp=Object(pu.a)([np.a,ap.a],function(e,t){return pp(t,e)}),hp={connectEmailUrl:f.a.string,emailAddress:f.a.string};function fp(e){var t=e.connectEmailUrl,n=e.emailAddress,a=Object(d.jsx)(we.a,{message:"conversations-thread-view.connected-accounts.removedEmailOnThread.title",options:{email:n||un.a.text("conversations-thread-view.connected-accounts.removedEmailOnThread.defaultAddress")}}),r=Object(d.jsx)(we.a,{message:"conversations-thread-view.connected-accounts.removedEmailOnThread.body"}),i=Object(d.jsx)(we.a,{message:"conversations-thread-view.connected-accounts.removedEmailOnThread.button"});return Object(d.jsx)(Qd,{title:a,body:r,buttonText:i,href:t})}fp.displayName="RemovedEmailOnThread";fp.propTypes=hp;var gp=function(e){return{connectEmailUrl:mp(e)}},bp=Object(au.connect)(gp,null)(fp),Op={connectEmailUrl:f.a.string};function vp(e){var t=e.connectEmailUrl,n=Object(d.jsx)(we.a,{message:"conversations-thread-view.connected-accounts.noEmailChannel.title"}),a=Object(d.jsx)(we.a,{message:"conversations-thread-view.connected-accounts.noEmailChannel.body"}),r=Object(d.jsx)(we.a,{message:"conversations-thread-view.connected-accounts.noEmailChannel.button"});return Object(d.jsx)(Qd,{title:n,body:a,buttonText:r,href:t})}vp.displayName="NoConnectedEmail";vp.propTypes=Op;var jp=function(e){return{connectEmailUrl:mp(e)}},Sp=Object(au.connect)(jp,null)(vp),yp={connectedAccounts:Object(g.mapOf)(Object(I.a)("ConnectedEmailAccount"),f.a.any),emailAddress:f.a.string.isRequired,type:f.a.oneOf([Nd,xd,Ld])},Cp=function(e){var t=e.connectedAccounts,n=e.emailAddress,a=e.type;Ws()(tp(t,n)===a,"Provided type doesn't match error derived from props");switch(a){case Nd:return Object(d.jsx)($d,{connectedAccount:Object(ep.a)(t,n)});case xd:return Object(d.jsx)(bp,{emailAddress:n});case Ld:return Object(d.jsx)(Sp,{});default:return null}};Cp.propTypes=yp;Cp.displayName="ConnectedAccountErrorSplash";var Ep=Cp,Tp=n("CIxt"),Ip={children:f.a.node.isRequired,onClose:f.a.func.isRequired},Rp=Xe()(ui.a).withConfig({displayName:"ConnectedAccountErrorDialog__StyledCloseButton",componentId:"rgsggt-0"})(["margin-top:18px;"]),Ap=Xe()(di.a).withConfig({displayName:"ConnectedAccountErrorDialog__StyledBody",componentId:"rgsggt-1"})(["margin-top:50px;margin-bottom:50px;"]),Np=function(e){var t=e.children,n=e.onClose;return Object(d.jsxs)(Tp.a,{className:"email-communicator communicator--floating",children:[Object(d.jsx)(li.a,{className:"communicator-header",children:Object(d.jsx)(Rp,{onClick:n})}),Object(d.jsx)(Ap,{children:t})]})};Np.displayName="ConnectedAccountErrorDialog";Np.propTypes=Ip;var xp=Np,Lp={children:f.a.node.isRequired,connectedAccounts:Object(g.mapOf)(Object(I.a)("ConnectedEmailAccount"),f.a.any),onClose:f.a.func.isRequired,reply:Object(I.a)("CommonReplyRecord")},kp=function(e){var t=e.children,n=e.connectedAccounts,a=e.onClose,r=e.reply,i=Object(ou.h)(r),o=tp(n,i);if(o){var s=Object(d.jsx)(Ep,{connectedAccounts:n,emailAddress:i,type:o});return Object(d.jsx)(xp,{onClose:a,children:s})}return t};kp.propTypes=Lp;var Mp=kp,_p=n("/iZH"),Dp=n("Exoo"),Pp=n("mTb/");function wp(e){return{ownerId:e.ownerId,objectType:e.objectType,subject:e.subject}}var Bp=n("WAUT");function Fp(e){var t=e.Component;e.wrappers.forEach(function(n){t=n(t,e.type)});return t}var Up=n("kAwc"),qp=n("xRv3"),Gp=n("9xhK"),Vp=Xe()(bi.a).withConfig({displayName:"CommunicatorError__ErrorWrapper",componentId:"sc-1nspfxu-0"})(["min-height:400px;max-width:400px;margin:0 auto;"]);function Hp(e){var t=e.detail;return Object(d.jsxs)(Vp,{align:"center",justify:"center",direction:"column",wrap:"wrap",className:"m-y-10 text-center",children:[Object(d.jsx)(Gp.a,{name:"errors/general",width:"25%",className:"m-bottom-6"}),Object(d.jsx)("h2",{children:Object(d.jsx)(we.a,{message:"customerDataCommunicator.componentErrorAlert.header"})}),Object(d.jsx)("p",{children:t||Object(d.jsx)(we.a,{message:"customerDataCommunicator.componentErrorAlert.communicatorErrorGeneric"})})]})}Hp.propTypes={detail:f.a.string};var zp=Hp,Wp=n("LljG"),Kp=n.n(Wp),Yp=n("LNSE"),Qp=Xe()(li.a).withConfig({displayName:"CommunicatorHeader__StyledDialogHeader",componentId:"sc-1mal2ee-0"})(["box-shadow:",";cursor:",";"],function(e){return e.isMinimized&&"0 1px 24px 0 rgba(0, 0, 0, 0.35)"},function(e){return e.shouldUseMoveCursor&&"move"}),Jp=Xe.a.div.withConfig({displayName:"CommunicatorHeader__StyledTitle",componentId:"sc-1mal2ee-1"})(["cursor:",";"],function(e){return!e.isDraggable&&"pointer"}),Xp=function(e){var t=e.connectDragSource,n=e.disableClose,a=e.interactionType,r=e.isDraggable,i=e.isFullScreen,o=e.isFullScreenEnabled,s=e.isMinimized,c=e.onCloseCommunicator,u=e.onToggleFullScreen,l=e.onToggleMinimize,p=e.selected,h=e.showHeader,f=e.title,g=e.type,b=Object(m.useCallback)(function(){u(a)},[a,u]),O=Object(m.useCallback)(function(e){e.stopPropagation();c()},[c]);if(!h)return null;var v=Object(d.jsx)(Yp.a,{className:"m-x-2","aria-label":un.a.text("customerDataCommunicator.Communicator.floatingCommunicator.closeDialogAriaLabel"),"data-selenium-test":"close-floating-communicator",disabled:n,iconName:"remove",onClick:O}),j=function(){if(!o)return null;var e=i?"customerDataCommunicator.Communicator.floatingCommunicator.fullScreenTooltip.close":"customerDataCommunicator.Communicator.floatingCommunicator.fullScreenTooltip.open",t=Object(d.jsx)(we.a,{message:e});return Object(d.jsx)(He.a,{title:t,placement:"bottom",children:Object(d.jsx)(Yp.a,{"aria-label":un.a.text("customerDataCommunicator.Communicator.floatingCommunicator.expandDialogAriaLabel"),className:"m-x-2","data-selenium-test":"full-screen-communicator-button",iconName:i?"exitFullScreen":"enlarge",onClick:b})})},S=function(){return Object(d.jsxs)("div",{"data-floating-communicator-actions":!0,className:"display-flex",children:[j(),v]})},y=function(){return Object(d.jsx)(we.a,{message:"customerDataCommunicator.Communicator.floatingCommunicator."+(g||p)})},C=function(){var e=f||y();return Object(d.jsx)(Jp,{className:"display-flex flex-grow-1","data-test":"communicator-header-title",isDraggable:r,onClick:r?void 0:l,children:Object(d.jsx)("h5",{className:"m-all-0 p-all-0",children:e})})},E=Object(d.jsx)("div",{className:"m-right-2",children:Object(d.jsx)(Yp.a,{"aria-label":un.a.text("customerDataCommunicator.Communicator.floatingCommunicator.minimizeDialogAriaLabel"),className:"m-x-2","data-selenium-test":"floating-communicator-minimize-button",iconName:s?"right":"down",onClick:l})}),T=function(){return Object(d.jsxs)("div",{className:"display-flex align-center flex-grow-1",children:[E,C(),S()]})},I=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(d.jsx)(Qp,{className:"communicator-header p-right-5",isMinimized:s,shouldUseMoveCursor:e,children:T()})};return r?t(Object(d.jsx)("div",{"data-test":"dnd-communicator-drag-source",children:I(!0)})):I()};Xp.propTypes={connectDragSource:f.a.func,disableClose:f.a.bool,interactionType:f.a.string.isRequired,isDraggable:f.a.bool,isFullScreen:f.a.bool,isFullScreenEnabled:f.a.bool,isMinimized:f.a.bool,onCloseCommunicator:f.a.func.isRequired,onToggleFullScreen:f.a.func.isRequired,onToggleMinimize:f.a.func.isRequired,showHeader:f.a.bool,selected:f.a.string.isRequired,title:f.a.node,type:f.a.node};var Zp=Xp,$p=Xe()(Bp.a).withConfig({displayName:"DnDCommunicatorInteraction__StyledUICardWrapper",componentId:"sc-1oip8uc-0"})(["box-shadow:",";background-color:",";width:",";"],function(e){var t=e.isDraggable;return e.isMinimized?"none":"0 1px 24px 0 rgba(0, 0, 0, "+(t?"0.35":".08")+")"},function(e){return e.isMinimized&&"unset"},function(e){var t=e.isMinimized,n=e.isDraggable;return!t||n?null:"300px !important"}),em=Xe.a.div.withConfig({displayName:"DnDCommunicatorInteraction__DivWithHeight",componentId:"sc-1oip8uc-1"})(["&&&{",";}"],function(e){var t=e.isDraggable;return e.isMinimized?t?"\n        display: none;\n      ":"\n          height: 0;\n        ":null}),tm={applicabilityConfig:f.a.func.isRequired,AsyncFileManager:f.a.func,AsyncSalesModal:f.a.func,className:f.a.string,connectDragSource:f.a.func,connectRte:f.a.func.isRequired,disableClose:f.a.bool,gates:Object(g.setOf)(f.a.string),gdprDisabled:f.a.bool,handleCloseCommunicator:f.a.func,handleNavigationTriggered:f.a.func,handleResizeIframe:f.a.func,handleToggleFullScreen:f.a.func,handleToggleMinimize:f.a.func,handleUsageLogging:f.a.func.isRequired,hasScope:f.a.func,interactions:f.a.shape({activate:f.a.func.isRequired,getAllDescriptors:f.a.func.isRequired,getDefault:f.a.func.isRequired,getDescriptor:f.a.func.isRequired}).isRequired,interactionPassThruProps:Object(g.mapOf)(f.a.object,f.a.string).isRequired,isDraggable:f.a.bool,isFullScreen:f.a.bool,isMinimized:f.a.bool,isFullScreenEnabled:f.a.bool,LocalSettings:f.a.object.isRequired,logUsageTrackingEvent:f.a.func,objectType:We.b.isRequired,onInteractionEvent:f.a.func.isRequired,onInteractionTypeChanged:f.a.func.isRequired,onPasteContent:f.a.func,ownerId:f.a.number.isRequired,paddingClassName:f.a.string.isRequired,selected:f.a.string.isRequired,showHeader:f.a.bool,sourceApp:f.a.string,subject:We.a.isRequired,teamId:f.a.number,title:f.a.node,userEmail:f.a.string},nm={gdprDisabled:!1,handleNavigationTriggered:De.a,handleResizeIframe:De.a,handleToggleFullScreen:function(){return null},handleToggleMinimize:function(){return null},interactionPassThruProps:Object(p.Map)(),isFullScreen:!1,isFullScreenEnabled:!1,isMinimized:!1,logUsageTrackingEvent:De.a,onPasteContent:De.a,paddingClassName:"",showHeader:!0},am=function(e){Object(l.a)(t,e);function t(e){var n;Object(i.a)(this,t);(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).handleLoggedActivityTypeChange=function(e){n.setState({type:e})};n.partial=C()(xn.a);n.state={type:""};n.communicatorRef=Object(m.createRef)();n.handleLoggedActivityTypeChange=n.handleLoggedActivityTypeChange.bind(Object(u.a)(n));return n}Object(o.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.interactionComponentCache={};this.getInteractionComponent(this.props.selected)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.selected!==e.selected&&this.getInteractionComponent(e.selected)}},{key:"getSelectedDescriptor",value:function(){return this.state.type?this.props.interactions.getDescriptor(this.state.type):this.props.interactions.getDescriptor(this.props.selected)}},{key:"getWrapperClasses",value:function(){var e=this.props,t=e.selected,n=e.isFullScreen,a=e.className;return v()("communicator communicator--floating floating-panel-is-"+t,a,n&&"communicator--fullscreen")}},{key:"getInteractionComponent",value:function(e){if(!this.interactionComponentCache[e]){var t=this.props.interactions.getDescriptor(e);this.interactionComponentCache[e]=Fp(t)}return this.interactionComponentCache[e]}},{key:"renderInteractionComponent",value:function(){var e=this.props,t=e.interactionPassThruProps,n=e.subject,a=e.connectRte,r=e.gates,i=e.handleCloseCommunicator,o=e.LocalSettings,s=e.objectType,c=e.onInteractionEvent,u=e.ownerId,l=e.teamId,p=e.paddingClassName,m=e.handleUsageLogging,h=e.onPasteContent,f=e.gdprDisabled,g=e.handleResizeIframe,b=e.handleNavigationTriggered,O=e.hasScope,v=e.AsyncFileManager,j=e.AsyncSalesModal,S=e.sourceApp,y=e.userEmail,C=this.getSelectedDescriptor(),E=C.engagementType,T=C.passthruRtePlugins,I=this.getInteractionComponent(C.type),R=t.get(C.type);return Object(d.jsx)("div",{className:"floating-communicator-body"+(this.props.isFullScreen?" floating-communicator-body--fullscreen":""),"data-selenium-test":"floating-communicator-body",children:Object(d.jsx)(I,Object.assign({},R,{connectRte:a,descriptor:C,engagementType:E,gates:r,handleCloseCommunicator:i,useMultipleAssociationsSelect:!0,isFullScreen:this.props.isFullScreen,LocalSettings:o,objectType:s,onInteractionEvent:c,onLoggedActivityTypeChange:this.handleLoggedActivityTypeChange,ownerId:u,teamId:l,paddingClassName:p,passthruRtePlugins:T,subject:n,subjectId:""+Object(Ge.a)(n),handleUsageLogging:m,onPasteContent:h,gdprDisabled:f,handleResizeIframe:g,handleNavigationTriggered:b,hasScope:O,AsyncSalesModal:j,AsyncFileManager:v,logUsageTrackingEvent:this.props.logUsageTrackingEvent,sourceApp:S,userEmail:y}))})}},{key:"renderBody",value:function(){var e=this.props,t=e.isDraggable,n=e.isFullScreen,a=e.isMinimized,r=this.getSelectedDescriptor().engagementType,i=r?"customerDataCommunicator.componentErrorAlert.communicatorErrorOption":"customerDataCommunicator.componentErrorAlert.communicatorErrorGeneric";return Object(d.jsx)(em,{className:"communicator-body","data-selenium-test":"communicator-body","data-selenium-fullscreen":n,"data-selenium-minimized":a,isDraggable:t,isMinimized:a,children:Object(d.jsx)(qp.a,{ErrorComponent:zp,errorProps:{detail:un.a.text(i,{type:r?r.toLocaleLowerCase():null})},children:this.renderInteractionComponent()})})}},{key:"renderHeader",value:function(){var e=this.getSelectedDescriptor().type.toUpperCase();return Object(d.jsx)(Zp,{connectDragSource:this.props.connectDragSource,disableClose:this.props.disableClose,interactionType:e,isDraggable:this.props.isDraggable,isFullScreen:this.props.isFullScreen,isFullScreenEnabled:this.props.isFullScreenEnabled,isMinimized:this.props.isMinimized,onCloseCommunicator:this.props.handleCloseCommunicator,onToggleFullScreen:this.props.handleToggleFullScreen,onToggleMinimize:this.props.handleToggleMinimize,selected:this.props.selected,showHeader:this.props.showHeader,title:this.props.title,type:this.state.type})}},{key:"renderCommunicator",value:function(){return Object(d.jsxs)($p,{className:this.getWrapperClasses(),"data-selenium-test":"profile-interactions","data-onboarding":"profile-interactions",isDraggable:this.props.isDraggable,isMinimized:this.props.isMinimized,ref:this.communicatorRef,children:[this.renderHeader(),this.renderBody()]})}},{key:"renderFullScreenCommunicator",value:function(){return Object(d.jsx)(Up.a,{"data-selenium-test":"full-screen-communicator",style:{display:"flex",justifyContent:"center",alignItems:"center"},width:1500,children:this.renderCommunicator()})}},{key:"render",value:function(){return this.props.isFullScreen?this.renderFullScreenCommunicator():this.renderCommunicator()}}]);return t}(Ta.a);am.propTypes=tm;am.defaultProps=nm;var rm={beginDrag:function(e,t,n){var a=Object($e.findDOMNode)(n.communicatorRef.current).getBoundingClientRect();return{left:a.left,top:a.top}}},im=Kp()(Object(Jl.DragSource)("communicator-dnd",rm,function(e){return{connectDragSource:e.dragSource()}}))(am),om=f.a.oneOf(Object.keys(Nu).map(function(e){return Nu[e]})),sm=n("O/Gz"),cm=Object.keys(Nu).map(function(e){return Nu[e]}),um={applicabilityConfig:f.a.func.isRequired,className:f.a.string,connectRte:f.a.func.isRequired,defaultInteraction:om,gates:Object(g.setOf)(f.a.string),onPasteContent:f.a.func,handleCloseCommunicator:f.a.func,handleToggleFullScreen:f.a.func,handleToggleMinimize:f.a.func,InteractionConfig:f.a.func.isRequired,interactionDescriptors:Object(g.iterableOf)(Au).isRequired,interactionPassThruProps:Object(g.mapOf)(f.a.object,f.a.string),isDraggable:f.a.bool,isFullScreen:f.a.bool,isFullScreenEnabled:f.a.bool,isMinimized:f.a.bool,LocalSettings:f.a.object.isRequired,objectType:We.b.isRequired,onInteractionEvent:f.a.func.isRequired,onInteractionTypeChanged:f.a.func.isRequired,ownerId:f.a.number.isRequired,teamId:f.a.number,paddingClassName:f.a.string,showHeader:f.a.bool,subject:We.a.isRequired,title:f.a.node,handleUsageLogging:f.a.func,gdprDisabled:f.a.bool,handleResizeIframe:f.a.func,handleNavigationTriggered:f.a.func,hasScope:f.a.func,AsyncFileManager:f.a.func,AsyncSalesModal:f.a.func,logUsageTrackingEvent:f.a.func,sourceApp:f.a.string,disableClose:f.a.bool,userEmail:f.a.string},lm={applicabilityConfig:wp,gates:Object(p.Set)(),InteractionConfig:Td,isFullScreenEnabled:!0,objectType:A.CONTACT,onPasteContent:De.a,onInteractionEvent:De.a,onInteractionTypeChanged:De.a,ownerId:0,paddingClassName:"p-x-5",handleUsageLogging:De.a,gdprDisabled:!1,handleResizeIframe:De.a,handleNavigationTriggered:De.a,logUsageTrackingEvent:De.a,disableClose:!1},dm=[Nu.NOTE,Nu.EMAIL,Nu.LOGGED_CALL,Nu.LOGGED_EMAIL,Nu.LOGGED_MEETING],pm=function(e){Object(l.a)(t,e);function t(e){var n;Object(i.a)(this,t);(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).handleInteractionTypeChanged=function(e){if(e!==n.state.selected){n.setState({selected:e});n.props.onInteractionTypeChanged(e)}};var a=e.interactionDescriptors,r=e.defaultInteraction,o=e.applicabilityConfig;n.interactions=e.InteractionConfig(a);n.state={selected:n.interactions.getDefault(n.getLocalType(),r,o(e))};return n}Object(o.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){var e=this.props.gates,t=!(!e||!e.get("CRM:ImprovedRtePerformance"));Object(sm.b)(t);this.props.onInteractionTypeChanged(this.state.selected)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.defaultInteraction&&this.state.selected!==e.defaultInteraction&&cm.includes(e.defaultInteraction)&&this.handleInteractionTypeChanged(e.defaultInteraction)}},{key:"getLocalType",value:function(){var e=this.props,t=e.defaultInteraction,n=e.objectType,a=e.subject,r=e.LocalSettings;return Object(Pp.b)(t,n,Object(Ge.a)(a),r.getFrom)}},{key:"getDescriptorType",value:function(){return this.interactions.getDescriptor(this.state.selected).type}},{key:"getIsFullScreenEnabled",value:function(){return this.props.isFullScreenEnabled&&dm.includes(this.getDescriptorType())}},{key:"render",value:function(){var e=this.props,t=e.LocalSettings,n=e.applicabilityConfig,a=e.connectRte,r=e.gates,i=e.handleCloseCommunicator,o=e.handleToggleFullScreen,s=e.handleToggleMinimize,c=e.interactionPassThruProps,u=e.isDraggable,l=e.isFullScreen,p=e.isMinimized,m=e.objectType,h=e.onInteractionEvent,f=e.ownerId,g=e.teamId,b=e.paddingClassName,O=e.showHeader,v=e.subject,j=e.className,S=e.title,y=e.handleUsageLogging,C=e.gdprDisabled,E=e.onPasteContent,T=e.handleResizeIframe,I=e.handleNavigationTriggered,R=e.hasScope,A=e.AsyncFileManager,N=e.AsyncSalesModal,x=e.sourceApp,L=e.disableClose,k=e.userEmail,M=this.state.selected;return Object(d.jsx)(im,{title:S,logUsageTrackingEvent:this.props.logUsageTrackingEvent,className:j,LocalSettings:t,applicabilityConfig:n,connectRte:a,gates:r,handleCloseCommunicator:i,handleToggleFullScreen:o,handleToggleMinimize:s,interactionPassThruProps:c,interactions:this.interactions,isDraggable:u,isFullScreen:l,isFullScreenEnabled:this.getIsFullScreenEnabled(),isMinimized:p,objectType:m,onPasteContent:E,onInteractionEvent:h,onInteractionTypeChanged:this.handleInteractionTypeChanged,ownerId:f,teamId:g,paddingClassName:b,selected:M,showHeader:O,subject:v,handleUsageLogging:y,gdprDisabled:C,handleResizeIframe:T,handleNavigationTriggered:I,hasScope:R,AsyncFileManager:A,AsyncSalesModal:N,sourceApp:x,disableClose:L,userEmail:k})}}]);return t}(Ta.a);pm.propTypes=um;pm.defaultProps=lm;var mm=Object(Zu.a)()(pm),hm=function(e,t){return Object.keys(e).reduce(function(n,a){return n&&e[a]===t[a]},!0)&&Object.keys(t).reduce(function(n,a){return n&&t[a]===e[a]},!0)},fm=function(e){Object(l.a)(t,e);function t(){Object(i.a)(this,t);return Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}Object(o.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){var n=this.props,a=(n.reply,Object(Fi.a)(n,["reply"])),r=(e.reply,Object(Fi.a)(e,["reply"]));return!(hm(a,r)&&hm(this.state,t))}},{key:"render",value:function(){return Object(d.jsx)(mm,Object.assign({},this.props))}}]);return t}(m.Component);fm.displayName="AdaptedCommunicator";fm.propTypes={AsyncFileManager:f.a.func,reply:Object(I.a)("CommonReplyRecord")};var gm=n("omic"),bm=n.n(gm),Om=function(e,t){var n=e.withMutations(function(n){var a=bm()(["metadata","to"],t)||Object(ou.q)(e)||Object(p.List)(),r=bm()(["metadata","from"],t)||Object(ou.f)(e),i=bm()(["metadata","subject"],t)||Object(ou.n)(e),o=bm()(["metadata","ccs"],t)||Object(ou.c)(e),s=bm()(["metadata","bccs"],t)||Object(ou.b)(e),c=bm()(["metadata","templateId"],t)||Object(ou.o)(e);Object(Dp.f)(r,n);Object(Dp.k)(a,n);Object(Dp.i)(i,n);Object(Dp.c)(o,n);Object(Dp.b)(s,n);Object(Dp.j)(c,n)}),a=bm()(["richTextEditorResults","editorState"],t)||Object(ou.e)(e);return Object(Dp.e)(a)(n)};n.d(t,"default",function(){return jm});var vm=C()(Ad),jm=function(e){Object(l.a)(t,e);function t(e){var n;Object(i.a)(this,t);n=Object(s.a)(this,Object(c.a)(t).call(this,e));x(e.AsyncFileManager,e.hasVideoAccess);n.state={minimized:!1};n.handleAttach=n.handleAttach.bind(Object(u.a)(n));n.handleChange=n.handleChange.bind(Object(u.a)(n));n.handleCheckIntegration=n.handleCheckIntegration.bind(Object(u.a)(n));n.handleRemoveAttachments=n.handleRemoveAttachments.bind(Object(u.a)(n));n.handleSend=n.handleSend.bind(Object(u.a)(n));n.handleToggleMinimize=n.handleToggleMinimize.bind(Object(u.a)(n));return n}Object(o.a)(t,[{key:"handleCheckIntegration",value:function(){return!1}},{key:"handleToggleMinimize",value:function(){var e=this;this.setState(function(e){return{minimized:!e.minimized}},function(){e.state.minimized&&Object(L.e)(_p.a)})}},{key:"handleSend",value:function(e){var t=this.props;(0,t.onSend)(t.reply,{html:e.get("html"),plainText:e.get("plainText")})}},{key:"handleAttach",value:function(e){var t=this.props,n=t.onChange,a=t.reply,r=Object(ou.a)(a).push(e);n(Object(Dp.a)(r,a))}},{key:"handleRemoveAttachments",value:function(e){var t=this.props,n=t.onChange,a=t.reply,r=Object(ou.a)(a);p.List.isList(e)||(e=Object(p.List)([e]));var i=S()(function(t){return e.contains(t.get("id"))},r);n(Object(Dp.a)(i,a))}},{key:"handleChange",value:function(e){var t=e.interaction,n=this.props,a=n.onChange,r=n.reply;a(Om(r,t))}},{key:"getDecoratorProps",value:function(){var e=this.props,t=e.connectedAccounts,n=e.conversationsInteract,a=e.isReply,r=e.reply,i=e.threadId,o=e.fetchEmailHistory;return Object(p.Map)({email:Object.assign({checkIntegration:this.handleCheckIntegration,connectedAccounts:vm(t),conversationsInteract:n,isReply:a,onAttach:this.handleAttach,onChange:this.handleChange,onRemoveAttachment:this.handleRemoveAttachments,onSend:this.handleSend,reply:r,threadId:i,disableUnsubscribeLink:!0,fetchEmailHistory:o},!!o&&{saveLabel:Object(d.jsx)(T.a,{message:"customerDataCommunicator.Communicator.Email.interaction.forward"})})})}},{key:"render",value:function(){var e=this.props,t=e.AsyncFileManager,n=e.AsyncSalesModal,a=e.className,r=e.connectedAccounts,i=e.gates,o=e.onClose,s=e.reply,c=e.userEmail,u=this.state.minimized,l=Rd(Object(ou.q)(s)),p=v()("email-communicator",a),m=this.getDecoratorProps();return Object(d.jsx)(Mp,{connectedAccounts:r,onClose:o,reply:s,children:Object(d.jsx)(fm,{gates:i,className:p,connectRte:Re,handleCloseCommunicator:o,handleToggleMinimize:this.handleToggleMinimize,InteractionConfig:Id,interactionDescriptors:Sd(),interactionPassThruProps:m,isFullScreenEnabled:!1,isMinimized:u,LocalSettings:R,objectType:A.CONTACT,ownerId:1,subject:l,gdprDisabled:!0,AsyncFileManager:t,AsyncSalesModal:n,userEmail:c})})}}]);return t}(m.Component);jm.displayName="EmailCommunicator";jm.propTypes={AsyncFileManager:f.a.func.isRequired,AsyncSalesModal:f.a.func.isRequired,className:f.a.string,connectedAccounts:Object(g.mapOf)(Object(I.a)("ConnectedEmailAccount"),f.a.any),conversationsInteract:f.a.bool,fetchEmailHistory:f.a.func,gates:Object(g.setOf)(f.a.string),hasVideoAccess:f.a.bool,isReply:f.a.bool,onChange:f.a.func.isRequired,onClose:f.a.func,onSend:f.a.func,reply:Object(I.a)("CommonReplyRecord"),threadId:f.a.oneOfType([f.a.number,f.a.oneOf([k.a])]).isRequired,userEmail:f.a.string.isRequired};jm.defaultProps={gates:Object(p.Set)(),hasVideoAccess:!1}},KknD:function(e,t,n){"use strict";var a=n("QYOI"),r=n("U0V+"),i=n.n(r),o=n("wBEU"),s=n.n(o),c=n("MQNR"),u=n("hr0l"),l=n("dxYZ"),d={associations:null,subject:null,to:Object(a.List)(),cc:Object(a.List)(),bcc:Object(a.List)(),from:Object(a.Map)({name:null,email:null}),sender:Object(a.Map)({email:null}),html:"",plainText:"",attachments:Object(a.List)(),templateId:null,shouldAddSignalsTracking:!0,shouldLogToCrm:!0,trackerKey:null,legalBases:Object(a.List)(),isForward:!1},p=Object(a.Record)(d,"EmailRecord"),m=Object.assign({},d,{associations:Object(a.List)(),connectedAccountAddress:"",replyToEngagementId:void 0,isForward:!1}),h=Object(a.Record)(m,"HubSpotHostedEmailRecord"),f=n("c2Nv"),g=n("h7ha"),b=n("cHKa"),O=(n("Ig8d"),n("EvX1")),v=n.n(O),j=n("omic"),S=n.n(j),y=n("N7iy"),C=n("e0QY");n.d(t,"f",function(){return x});n.d(t,"l",function(){return M});n.d(t,"n",function(){return _});n.d(t,"m",function(){return D});n.d(t,"p",function(){return P});n.d(t,"h",function(){return w});n.d(t,"a",function(){return B});n.d(t,"g",function(){return F});n.d(t,"b",function(){return q});n.d(t,"e",function(){return V});n.d(t,"o",function(){return H});n.d(t,"j",function(){return z});n.d(t,"i",function(){return W});n.d(t,"k",function(){return K});n.d(t,"c",function(){return J});n.d(t,"d",function(){return X});var E=Object(a.Seq)(["firstname","lastname","email","hs_additional_emails"]),T=i()("to"),I={contactIds:"CONTACT",companyIds:"COMPANY",dealIds:"DEAL",ticketIds:"TICKET"},R=function(e){return"string"==typeof e&&0===e.indexOf("owner.")&&e.split(".")[1]},A=function(e){var t=e.email;return new b.a({to:new f.a({id:e.ownerId,firstName:e.firstName,lastName:e.lastName,address:t}),emailAddresses:Object(a.Set)([t])})},N=function(e,t,n){var a,r,i=e.get("email").toLowerCase(),o=t.getDefaultIntegratedAliasAddress(i,n),s=t.getAccount(o,!1);if(!s)return new f.a({id:e.get("user_id")});try{r=y.a.toAliasAddress(o);a=s.getAliasWithAddress(r)}catch(e){Object(C.a)({error:new Error("Could not find Alias in ConnectedAccount record"),extraData:{aliasAddress:r,connectedAccount:s,connectedAccounts:t,defaultSenderEmailAddressId:o}})}var c={};a&&(c={addressId:o,address:r,firstName:e.get("first_name"),lastName:e.get("last_name"),friendlyName:S()(["friendlyFromName"],s),sendAsAddress:S()(["sendFromEmail"],s),resolvedFromName:S()(["resolvedFromName"],s)});return new f.a(Object.assign({id:e.get("user_id")},c))};function x(e){return e?new b.a({to:e,emailAddresses:Object(a.Set)([e.address])}):new b.a}var L=function(e,t,n){var a=e.get("email").toLowerCase();return new g.a({from:N(e,t,n),signature:t.getPrimarySignature(a),aliasEmailAddresses:t.getFacsimileInboxAliases(a),hasPrimaryAccount:t.hasPrimaryAccount(a),hasEnabledAccounts:t.isIntegrated(),hasGoogleIntegration:t.hasIntegration(u.a),hasOffice365Integration:t.hasIntegration(u.c),hasImapIntegration:t.hasIntegration(u.b)})},k=function(e){return Object(a.Map)({fileId:e.get("id")})};function M(e){return!!R(e)}function _(e){if("string"!=typeof e||0!==e.indexOf(c.CONTACT))return{id:e};var t=e.split(" ");return{id:t[1],emailAddress:t[2]}}function D(e,t){return c.CONTACT+" "+e+" "+t}function P(e){return"owner."+e}function w(e){var t=Object(l.d)(e,"email"),n=Object(a.Set)([t]),r=Object(l.d)(e,"hs_additional_emails");return r?n.concat(r.split(";")):n}function B(e,t){var n=function(n){return Object(l.d)(e,n)!==Object(l.d)(t,n)};return s()(n,E)}function F(e,t,n){return L(e,t,n)}function U(e,t){t||(t=Object(l.d)(e,"email"));return new f.a({id:Object(l.a)(e),firstName:Object(l.d)(e,"firstname"),lastName:Object(l.d)(e,"lastname"),address:t})}function q(e,t){return new b.a({to:U(e,t),emailAddresses:w(e)})}function G(e){return new b.a({to:new f.a({address:e}),emailAddresses:Object(a.Set)([e])})}function V(e,t,n){if(n&&n instanceof b.a)return n;if(!n||n instanceof f.a)return x(n);var a=n,r=R(a);if(r)return A(t.get(r));var i=_(a),o=e.get(i.id);return o?q(o,i.emailAddress):G(i.id&&i.id.toLowerCase())}function H(e,t,n){var r=t.subject,i=t.recipient,o=t.to,s=t.ccs,c=t.bccs,u=t.from,l=t.templateId,d=t.hasEmailBrandingBanner,p=t.replyEngagementId,m=t.replyEngagementType,h=t.shouldLogToCrm,f=t.isForward,g=e.metadata.merge({subject:r,to:i?Object(a.List)([i.to]):T(o),ccs:T(s),bccs:T(c),from:u,templateId:l,hasEmailBrandingBanner:d,replyEngagementId:p,replyEngagementType:m,shouldLogToCrm:void 0===h||h,isForward:f});return e.mergeIn(["associations"],n).set("metadata",g)}function z(e){var t=e.recipient,n=e.to,r=e.bccs,i=e.ccs;return(t?Object(a.Seq)([t]):n).concat(i,r).toList().filter(function(e){return v()(e.to.address)})}function W(e){return z(e).map(function(e){return e.get("to").get("address")})}function K(e){var t=Object(a.List)();e.hasGoogleIntegration&&(t=t.push(u.a));e.hasOffice365Integration&&(t=t.push(u.c));e.hasImapIntegration&&(t=t.push(u.b));return t}var Y=function(e){var t=e.get("engagementsV2UniversalAssociations");if(!t||0===t.size)return null;var n=Object(a.List)([]);t.forEach(function(e,t){e.get("associationOptionRecordsMap").keySeq().forEach(function(e){n=n.push(Object(a.Map)({objectId:e,objectTypeId:t}))})});return n};function Q(e){var t=e.interactionRecord,n=e.attachments,r=e.connectedAccounts,i=e.nameFormatter,o=e.trackerKey,s=e.legalBases,c=t.metadata,u=t.associations,l=c.get("from"),d=c.get("isForward"),p=c.get("to");a.List.isList(p)||(p=new a.List([p]));return{associations:Y(u),subject:c.get("subject"),to:p.map(function(e){return e.formatted(i)}),cc:c.get("ccs").map(function(e){return e.formatted(i)}),bcc:c.get("bccs").map(function(e){return e.formatted(i)}),from:Object(a.Map)({name:l.getFriendlyName(i),email:l.getSendAsAddress()}),sender:Object(a.Map)({name:l.getFriendlyName(i),email:r.getAccountEmailAddress(l.addressId)}),html:c.get("body"),plainText:c.get("plainText"),templateId:c.get("templateId"),attachments:n.map(k),shouldLogToCrm:c.get("shouldLogToCrm"),trackerKey:o,legalBases:s,isForward:d}}function J(e){var t=Q({interactionRecord:e.interactionRecord,attachments:e.attachments,connectedAccounts:e.connectedAccounts,nameFormatter:e.nameFormatter,trackerKey:e.trackerKey,legalBases:e.legalBases});return new p(t)}function X(e){var t=e.interactionRecord,n=e.attachments,r=e.connectedAccounts,o=e.nameFormatter,s=e.replyToEngagementId,c=e.legalBases,u=t.associations,l=Q({interactionRecord:t,attachments:n,connectedAccounts:r,nameFormatter:o,legalBases:c}),d=l.associations;if(!d&&u&&u.size){d=Object(a.List)([]);u.forEach(function(e,t){e&&e.size&&I[t]&&e.forEach(function(e){"number"==typeof e&&(d=d.push(Object(a.Map)({id:e,type:I[t]})))})})}var p=i()("id")(n),m=Object.assign({},l,{connectedAccountAddress:l.sender.get("email"),associations:d,attachments:p,replyToEngagementId:s});return new h(m)}},L9KA:function(e,t,n){"use strict";n.r(t);n.d(t,"LOCAL_SETTINGS_PREFIX",function(){return l});n.d(t,"makePrefixedKey",function(){return d});n.d(t,"deleteFrom",function(){return p});n.d(t,"getFrom",function(){return m});n.d(t,"getFromSafe",function(){return h});n.d(t,"getFromBatch",function(){return f});n.d(t,"hasFrom",function(){return g});n.d(t,"setFrom",function(){return b});n.d(t,"setFromSafe",function(){return O});var a=n("QYOI"),r=n("LZPL"),i=n.n(r),o=n("emzX"),s=n.n(o),c=n("DLPV"),u=n.n(c),l="LocalSettings:Sales:";function d(e){s()(u()(e)&&e.length>1,"expected `key` to be a non-empty string but got `%s`",e);return l+e}function p(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];try{delete e[n?d(t):t]}catch(e){i.a.isProd()||console.error("Error: deleteFrom:",e)}}function m(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];try{var a=e[n?d(t):t];return void 0===a?a:JSON.parse(a)}catch(e){i.a.isProd()||console.error("Error: getFrom:",e);return}}var h=m;function f(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return t.reduce(function(t,a){return t.set(a,m(e,a,n))},Object(a.Map)())}function g(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];try{return Object.prototype.hasOwnProperty.call(e,n?d(t):t)}catch(e){i.a.isProd()||console.error("Error: hasFrom:",e);return}}function b(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];try{e[a?d(t):t]=JSON.stringify(n);return n}catch(e){i.a.isProd()||console.error("Error: setFrom:",e);return}}var O=b},M2y5:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return r});var a=n("8h+W"),r=Object(a.a)({UNBOUNCE:"UNBOUNCE"}).UNBOUNCE;e&&e.exports&&(e.exports.default=Object.assign({},e.exports))}).call(this,n("ABwO")(e))},M76c:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n("vTCD"),r=n("k8Et"),i=n("mNyx"),o=n("txVw"),s=n("pGTB"),c=n("QYOI"),u=function(e){Object(s.a)(t,e);function t(){Object(a.a)(this,t);return Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}Object(r.a)(t,[{key:"getRteConfigType",value:function(e){return this.type||e}},{key:"concatPlugins",value:function(e){return this.set("plugins",this.plugins.concat(e))}},{key:"concatPluginComposers",value:function(e){return this.set("pluginComposers",this.pluginComposers.concat(e))}},{key:"extendPluginGroupConfig",value:function(e){return this.set("pluginGroupConfig",this.pluginGroupConfig.merge(e))}}]);return t}(Object(c.Record)({type:null,plugins:Object(c.Seq)(),pluginComposers:Object(c.Seq)(),pluginGroupConfig:Object(c.Map)()},"PassthruRtePlugins"))},Nm19:function(e,t,n){"use strict";n.d(t,"a",function(){return d});n.d(t,"b",function(){return m});var a=n("nDpY"),r=n.n(a),i=n("CbQ+"),o=n("0qrK"),s=n("e0QY"),c=r.a.get(),u="variationi18n",l="acquisition-077-002",d="editWithHubSpot",p=[d,"variationFomo","variationFree","variationVoiceOfTheUser","variationSocialProof","variationValueProp"],m=function(){return Object(i.a)({key:l,identifier:c}).then(function(e){return e.parameters}).catch(function(e){Object(s.a)({error:new Error("Failed fetch to Laboratory for experiment treatment ACQ077 (Email Branding Copy)."),extraData:{message:e.status}});return[]}).then(function(e){return Object(o.d)(e,u,p).value})}},"O/Gz":function(e,t,n){"use strict";n.d(t,"b",function(){return u});n.d(t,"a",function(){return l});var a,r={},i=[],o={},s=null,c=function(e){window.newrelic&&Object.keys(r).forEach(function(t){window.newrelic.addPageAction("longInputTasks",{inputName:t,longTaskCount:r[t],didReceiveEvents:i.includes(t),hasPluginStacks:e})})},u=function(e){if(window.PerformanceObserver)try{if(!a){a=new window.PerformanceObserver(function(e){e.getEntries().forEach(function(e){var t=o[s];t&&e.startTime<t&&e.startTime+e.duration>t&&r[s]++})});window.addEventListener("beforeunload",function(){c(e)})}a.observe({entryTypes:["longtask"]})}catch(e){}},l=function(e){r[e]=0;var t=!1;return function(n){if(!t){i.push(e);t=!0}s=e;o[e]=n.timeStamp}}},OnVB:function(e,t,n){"use strict";n.r(t);n.d(t,"format",function(){return p});n.d(t,"formatWithEmail",function(){return m});var a=n("mDbF"),r=n.n(a),i=n("37ae"),o=n.n(i),s=n("aitF"),c=n.n(s),u=n("U4kd"),l=function(e){var t=e.firstName,n=e.lastName,a=e.email;return t||n||a?t||n?o()({firstName:t,lastName:n}):a:""},d=function(e){var t=e.firstName,n=e.lastName,a=e.email||o()({firstName:t,lastName:n});return r.a.text("customerDataObjects.OwnerName.deactivated",{name:a})},p=c()(function(e){if(e){if(!e.active)return d(e);if("__hs__ME"===e.ownerId)return r.a.text("customerDataObjects.OwnerIdSelect.me");var t=l(e);t&&Object(u.b)(e)&&(t+=" (Salesforce)");return t}}),m=c()(function(e){if(e){if("__hs__ME"===e.ownerId)return r.a.text("customerDataObjects.OwnerIdSelect.me");var t=e.email,n=e.active,a=p(e);if(!e||!n||Object(u.b)(e))return a;t&&a&&a!==t&&(a+=" ("+t+")");return a}})},OuMQ:function(e,t,n){"use strict";n.d(t,"b",function(){return l});n.d(t,"a",function(){return d});var a=n("sx3F"),r=n.n(a),i=n("WYIs"),o=n("e0QY"),s=n("nDpY"),c=n.n(s);function u(e){return e&&(e.substring(e.indexOf("<")+1,e.indexOf(">"))||e)}var l=function(e){if(!r()("customerDataEmail.Email.api.errors."+e)){Object(o.a)({error:new Error("[EmailApi] Error Message Key not found for errorType: "+e)});return"customerDataEmail.Email.api.errors."+i.f}return"customerDataEmail.Email.api.errors."+e},d=function(e){var t=e.errorType,n=e.emailRecord,a=e.defaultMessage,r=void 0===a?"customerDataEmail.Email.api.errors."+i.f:a,o=e.isUngatedForEmailSettingsMigration,s=void 0!==o&&o,d={_defaultMessage:r},p=r;if(t){var m=t.toUpperCase();if(t===i.a){d.toAddress=n&&n.to&&n.to.first()&&u(n.to.first());m=d.toAddress?t:i.b}m.includes(i.c)&&(d.settingsUrl=s?"/settings/"+c.a.get()+"/user-preferences/email":"/crm-settings-email/"+c.a.get()+"/email/connectedEmails");p=l(m)}return{message:p,options:d}}},PeaV:function(e,t,n){"use strict";n.r(t);var a=n("YM6t"),r=n("OwGx"),i=n("zJzf"),o=n("bn2T"),s=n("a7/P"),c=n("XInU"),u=n("gYIA"),l=n("5BVj"),d=Object(l.a)({}),p=n("tk4I"),m=n("Sx0/"),h=n.n(m),f=n("qz7Q"),g=n("weJi"),b=n("G6Zk"),O=n("vltt"),v=n("ByNx"),j=n("IxZu"),S=n("g+dq"),y=n.n(S),C=n("/1+p"),E=n.n(C),T=n("nDpY"),I=n.n(T),R=n("bmGp"),A=n("oMbb"),N=n("QgEn"),x=n("EvX1"),L=n.n(x),k=n("QYOI"),M=n("emzX"),_=n.n(M),D=n("jqvl"),P=n.n(D),w=n("YQui"),B=n("vt8U"),F="knowledge-content/v1/knowledge-articles",U=function(e){return e.filter(function(e){return"PUBLISHED"===e.currentState})},q=function(e){var t=e.objects,n=e.offset,a=e.count,r=e.total,i=e.hasMore;return Object(k.Map)({hasMore:i||!1,offset:n||0,count:a||t.length,total:r||t.length,results:Object(k.List)(U(t)).map(function(e){return Object(k.fromJS)(e)})})},G=function(e){return{fetchRenderedContent:function(t){var n=t.id;return e.get(F,{query:{id:n}}).then(function(e){var t=e.objects[0],n=t.absoluteUrl,a=t.title;return{body:a,htmlBody:"<a href="+n+">"+a+"</p>"}})},searchArticles:function(t){var n=t.count,a=t.offset,r=t.query;return e.get(F,{query:{limit:n,offset:a,name__icontains:r,order:"-updated",state__eq:"PUBLISHED",archived:!1}}).then(q)}}},V=function(e){var t=e.count,n=e.offset,a=e.query;return y.a.get(F,{query:{limit:t,offset:n,name__icontains:a,order:"-updated",state__eq:"PUBLISHED",archived:!1}}).then(q)},H=n("VfuR"),z=n.n(H),W=n("DJRK"),K=n("K7xC"),Y=function(e){var t=e.portalId;return Object(N.jsx)(K.a,{portalId:t,image:"knowledge-base",title:"draftPlugins.knowledgeArticlesPlugin.popover.emptyState.title",description:"draftPlugins.knowledgeArticlesPlugin.popover.emptyState.description",buttonLabel:"draftPlugins.knowledgeArticlesPlugin.manage",buttonLink:Object(W.b)(t)})};Y.propTypes={portalId:z.a.number.isRequired};var Q,J=Y,X=n("46u0"),Z=n.n(X),$=n("i5eR"),ee=n("sld6"),te=function(){return Object(N.jsx)(ee.a,{direction:"column",align:"center",className:"p-all-10",children:Object(N.jsx)($.a,{className:"text-center",children:Object(N.jsx)(Z.a,{message:"draftPlugins.knowledgeArticlesPlugin.fetchError"})})})},ne=n("fwDr"),ae=function(e){return e?e.get("results").map(function(e){return{text:e.get("title"),value:String(e.get("id")),help:Object(N.jsx)(ne.a,{children:e.get("articleSummary")})}}).toArray():[]},re=Object(k.List)([w.c]),ie=Object(B.a)({icon:"bulb",toolTip:Object(N.jsx)(P.a,{message:"draftPlugins.knowledgeArticlesPlugin.tooltip"})}),oe=function(e){var t=e.apiClient,n=void 0===t?y.a:t,a=e.outputType,r=void 0===a?w.c:a,i=e.tracker,o=void 0===i?L.a:i,c=e.onInsertContent,u=void 0===c?L.a:c,l=e.portalId,d=void 0===l?I.a.get():l,p=e.button,m=void 0===p?ie:p,h=e.onOpenPopover,f=void 0===h?function(){}:h,g=e.popoverPlacement;_()(re.includes(r),"KnowledgeArticlesPlugin: expected out to be "+re.join(", "));var b=G(n),O={outputType:r,apiFunctions:b};return Object(s.createPlugin)({buttons:m&&Object(A.a)(Object(R.a)({tracker:o,portalId:d,onInsertContent:u,Button:m,onOpenPopover:f,PopoverEmptyState:J,PopoverErrorState:te,popoverPlacement:g,searchPlaceHolder:"draftPlugins.knowledgeArticlesPlugin.popover.search.placeholder",search:b.searchArticles||V,transformData:ae}),O)})},se=n("EZY7"),ce=n("mMHr"),ue=n("d2uU"),le=n("1Mur"),de=n("MMdr"),pe=function(e){return E.a.staticDomainPrefix+"/salesImages/"+E.a.depVersions.salesImages+"/"+e}("sales-pro-onboarding/pql-modal/pql-meetings.png"),me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Q||(Q=Object(j.a)());var t=G(y.a),n={outputType:g.c,apiFunctions:t},a=(e.snippets.apiWrapper||se.a)(y.a),r={outputType:g.c,apiFunctions:a},i=Object.assign({onFetchMeetingsError:h.a,onInsertMeetingsLink:h.a,zeroStateImageUrl:pe},e.meetings),o=I.a.get(),s={knowledgeArticles:{plugin:oe(e.knowledgeArticles),component:Object(A.a)(Object(R.a)(Object.assign({dataProp:"KNOWLEDGE_ARTICLES",portalId:o,onInsertContent:h.a,PopoverEmptyState:J,PopoverErrorState:te,search:t.searchArticles,searchPlaceHolder:"draftPlugins.knowledgeArticlesPlugin.popover.search.placeholder",onlyRenderContent:!0,transformData:ae},e.knowledgeArticles)),n),trackClick:e.knowledgeArticles.trackClick},snippets:{plugin:Object(ce.a)(e.snippets),component:Object(A.a)(Object(R.a)(Object.assign({portalId:o,onInsertContent:h.a,optionsMapping:{text:"name",help:"body",value:"id"},PopoverEmptyState:ue.a,PopoverErrorState:le.a,search:a.searchSnippets,searchPlaceHolder:"draftPlugins.snippetsPlugin.popover.search.placeholder",onlyRenderContent:!0,transformData:de.a},e.snippets)),r),trackClick:e.snippets.trackClick},meetings:{plugin:Object(b.a)(i)},meetingsProTips:{plugin:Object(O.a)(e.meetingsProTips)}};if(e.video){s.video={plugin:Object(v.a)(e.video),component:f.a,trackClick:e.video.trackClick};e.signature&&(s.signature=e.signature)}return s},he=n("eVil"),fe=n.n(he),ge=n("3o4F"),be=n("c8Yo"),Oe=n("QZ0p"),ve=n("8B+i"),je=n("vTCD"),Se=n("k8Et"),ye=n("mNyx"),Ce=n("txVw"),Ee=n("pGTB"),Te=n("FGZp"),Ie=n("Ktcs"),Re=n("fFSu"),Ae=n("r1tY"),Ne=n("9f1P"),xe=n.n(Ne),Le=n("195h"),ke=n("jF/D"),Me=n("tQGq"),_e=n("EipP"),De=n("OW66"),Pe=n("vuW9"),we=xe()(De.a).withConfig({displayName:"UITextToolbarSplitSelect__StyledButtonGroup",componentId:"sc-131ooqq-0"})(["& > *[aria-disabled='true']{border-color:transparent !important;}"]),Be=function(e){Object(Ee.a)(t,e);function t(){var e,n;Object(je.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];(n=Object(ye.a)(this,(e=Object(Ce.a)(t)).call.apply(e,[this].concat(r)))).refCallback=function(e){n._popoverTarget=Object(Ae.findDOMNode)(e)};return n}Object(Se.a)(t,[{key:"render",value:function(){var e=this.props,t=e.active,n=e.open,a=e.options,r=e.onButtonClick,i=e.placement,o=e.tooltip,s=e.value,c=e.splitButtonTestId,u=e.disabled,l=Object(Re.a)(e,["active","open","options","onButtonClick","placement","tooltip","value","splitButtonTestId","disabled"]),d=a.find(function(e){return e.value===s}),p=d?Object(N.jsx)(Me.a,{disabled:u,name:d.icon}):null,m={target:this._popoverTarget};return Object(N.jsx)(Pe.a,{open:!n&&void 0,placement:i,title:o,disabled:u,children:Object(N.jsxs)(we,{disabled:u,children:[Object(N.jsx)(ke.a,{"data-test-id":c,hovered:!!n||void 0,onClick:r,ref:this.refCallback,selected:t,disabled:u,children:p}),Object(N.jsx)(Le.a,Object.assign({open:n,options:a,popoverProps:m,value:s,disabled:u},l))]})})}}]);return t}(Ie.Component);Be.propTypes=Object.assign({},Le.a.propTypes,{active:z.a.bool,onButtonClick:z.a.func,placement:Pe.a.propTypes.placement,tooltip:Pe.a.propTypes.title,splitButtonTestId:z.a.string});Be.defaultProps=Object.assign({},Le.a.defaultProps,{active:!1,placement:"bottom"});Be.displayName="UITextToolbarSplitSelect";var Fe=Object(_e.a)(Be,["open","value"]),Ue=n("6ePo"),qe=n("qHAs"),Ge=function(e){var t=e.style;return{icon:e.icon,value:t}},Ve=function(e){return e.getCurrentContent().getBlockForKey(e.getSelection().getStartKey()).getType()},He=function(e){return function(t){Object(Ee.a)(n,t);function n(t){var a;Object(je.a)(this,n);(a=Object(ye.a)(this,Object(Ce.a)(n).call(this,t))).getIsActive=function(){var e=a.props.editorState,t=a.state.currentValue;return Ve(e)===t};a.getSelectedValue=function(){var t=a.props.editorState,n=Ve(t),r=e.find(function(e){return e.value===n});return r?r.value:void 0};a.handleStyleToggle=function(){var e=a.props,t=e.editorState,n=e.onChange,r=a.state.currentValue,i=Te.RichUtils.toggleBlockType(t,r);n(Te.EditorState.forceSelection(i,i.getSelection()))};a.handleStyleChange=function(e){var t=a.getIsActive();a.setState({currentValue:e.target.value},function(){t&&a.handleStyleToggle()})};a.state={currentValue:a.getSelectedValue()||e[0].value};return a}Object(Se.a)(n,[{key:"componentDidUpdate",value:function(e){var t=this.props.editorState.getSelection(),n=this.getSelectedValue();t.equals(e.editorState.getSelection())||null==n||this.setState({currentValue:n})}},{key:"render",value:function(){var t=this.props.editorState,n=this.state.currentValue,a=t.getSelection().getHasFocus();return Object(N.jsx)(Fe,{active:this.getIsActive()&&a,onButtonClick:this.handleStyleToggle,onChange:this.handleStyleChange,options:e,value:n})}}]);return n}(Ie.Component)},ze=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).listStyles,t=void 0===e?null:e,n=[];if(Array.isArray(t)){var r=Ue.k.filter(function(e){return t.includes(e.style)});n.push.apply(n,Object(a.a)(r.map(Ge)))}else n.push.apply(n,Object(a.a)(Ue.k.map(Ge)));var i=He(n);return Object(s.createPlugin)({keyCommandListener:qe.a,buttons:i,blockToHTML:{blockquote:{start:"<blockquote>",end:"</blockquote>"},"code-block":{start:"<pre>",end:"</pre>"}}})},We=n("AEm3"),Ke=n("jJOs"),Ye=n("Bc58"),Qe=n("eP/i"),Je=Object(N.jsx)(P.a,{message:"draftPlugins.highlightPlugin.tooltip"}),Xe=Object(Ye.a)({colors:[[Qe.MARIGOLD]],getStyleName:function(e){return"BACKGROUND-COLOR-"+e},cssProperty:"background-color",tooltip:Je,iconName:"highlight"}),Ze=n("f9wP"),$e=n("gCfs"),et=n("o22v"),tt=n("aZCz"),nt=n("SkPU"),at=n("T64O"),rt=n("sROq"),it=n("xTso"),ot=n("fgA7"),st=n("xL8J"),ct=n("5U7M"),ut=n("R93e"),lt=function(e){var t=e.icon,n=e.tooltip,a=e.tooltipPlacement,r=void 0===a?"bottom":a,i=function(e){var a=e.active,i=void 0!==a&&a,o=e.onClick;return Object(N.jsx)(ut.a,{active:i,icon:t,tooltip:n,tooltipPlacement:r,onClick:o})};i.propTypes={active:z.a.bool,onClick:z.a.func.isRequired};return i},dt=n("DnSe"),pt=n("XjX8"),mt=function(e){return e.getLength()>0||e.getType().indexOf("list-item")>-1||"atomic"===e.getType()&&["IMAGE","VIDEO"].includes(e.getData().get("atomicType"))};function ht(e){return e.getCurrentContent().getBlockMap().some(mt)}function ft(e,t){return"span"===e&&t.hasAttribute("data-at-mention")?{value:parseInt(t.getAttribute("data-owner-id"),10),text:t.textContent}:null}function gt(e){return"<span data-at-mention data-token data-owner-id="+e.value+">"+e.text+"</span>"}var bt,Ot=n("MQNR"),vt="snippets/v1/render",jt=function(e){return{fetchRenderedContent:function(t){var n=t.id,a=t.contactEmail,r=t.contactVid,i=t.supplementalObjects;!r&&i&&i[Ot.CONTACT]&&(r=i[Ot.CONTACT]);return e.post(vt,{data:{snippetId:n,toEmail:a,contactId:r,supplementalObjects:i}})},fetchUnrenderedContent:function(t){var n=t.id;return e.get("snippets/v1/snippets/"+n)},searchSnippets:function(t){var n=t.count,a=t.offset,r=t.query;return e.post("salescontentsearch/v2/search",{data:{contentTypesToHydrate:["SNIPPET"],filters:[{field:"content_type",values:["SNIPPET"]}],limit:n,offset:a,query:r}}).then(function(e){return Object(k.fromJS)(e)})}}},St={advancedBackgroundColor:"advancedBackgroundColor",advancedTextColor:"advancedTextColor",atMention:"atMention",backgroundColor:"backgroundColor",blockAlignment:"blockAlignment",blockQuote:"blockQuote",blockStyles:"blockStyles",fontStyles:"fontStyles",hightlight:"hightlight",highlightBeta:"highlightBeta",image:"image",inlineStyles:"inlineStyles",inlineStylesOverride:"inlineStylesOverride",link:"link",listStyles:"listStyles",separator:"separator",sizeStyles:"sizeStyles",textColor:"textColor",unstyledAsDiv:"unstyledAsDiv",knowledgeArticles:"knowledgeArticles",snippets:"snippets",documentLinkPreview:"documentLinkPreview",video:"video"},yt={atMentions:{dataProp:"owners",tracker:function(){},enabled:!0},snippets:{tracker:function(){},enabled:!0},knowledgeArticles:{tracker:function(){},enabled:!1}},Ct=function(e){return Object.assign({},yt,e)},Et=function(e){var t={advancedBackgroundColor:Object.assign({ColorPicker:pt.a,cssProperty:"background-color",defaultColor:"#fff",iconName:"highlight"},e.advancedBackgroundColor),advancedTextColor:Object.assign({ColorPicker:pt.a},e.advancedTextColor),atMention:Object.assign({dataProp:null,useInviteZeroState:null,inviteZeroStateOpts:null,tokenToHTML:gt,htmlToToken:ft,tokenClassName:"at-mention-token",tokenStyle:{}},e.atMentions),blockAlignment:{tagName:"div",tooltipPlacement:"top",empty:"<br>"},blockQuote:{headerStyles:[],listStyles:[],miscStyles:["blockquote"]},blockStyles:{headerStyles:[],listStyles:["ordered-list-item","unordered-list-item"],miscStyles:["blockquote"]},fontStyles:{},highlightBeta:{applyColorOnClick:!0,ColorPicker:pt.a,cssProperty:"background-color",defaultColor:Qe.MARIGOLD,iconName:"highlight"},image:{Button:Object(ge.a)(Object.assign({tooltipPlacement:"top"},e.image,{httpClient:y.a}))},link:Object.assign({showTarget:!0,tooltipPlacement:"top",popoverPlacement:"top right"},e.link),inlineStyles:{},sizeStyles:{},snippets:Object.assign({outputType:w.c,button:lt({icon:"textSnippet",tooltip:Object(N.jsx)(P.a,{message:"customerDataRte.plugins.snippet"}),tooltipPlacement:"top"}),apiWrapper:jt,popoverPlacement:"top right"},e.snippets),knowledgeArticles:Object.assign({outputType:w.c,tracker:e.knowledgeArticles.tracker,button:lt({icon:"cap",tooltip:Object(N.jsx)(P.a,{message:"customerDataRte.plugins.knowledgeArticle"}),tooltipPlacement:"top"}),popoverPlacement:"top"},e.knowledgeArticles),video:{usePopover:e.hasShepherdVideoUngated,handleVideoTracking:e.handleVideoTracking}},n={advancedBackgroundColor:Object(ct.a)(t.advancedBackgroundColor),advancedTextColor:Object(ct.a)(t.advancedTextColor),atMention:Object(ot.a)(t.atMention),backgroundColor:be.a,blockAlignment:Object(Oe.a)(t.blockAlignment),blockQuote:Object(ve.a)(t.blockQuote),blockStyles:Object(ve.a)(t.blockStyles),fontStyles:Object(Ke.a)(t.fontStyles),hightlight:Xe,highlightBeta:Object(ct.a)(t.highlightBeta),image:Object(Ze.a)(t.image),inlineStyles:Object(et.a)(t.inlineStyles),inlineStylesOverride:Object($e.a)(),link:Object(st.a)(t.link),listStyles:ze(),separator:nt.a,sizeStyles:Object(at.a)(t.sizeStyles),textColor:rt.a,unstyledAsDiv:it.a,knowledgeArticles:oe(t.knowledgeArticles),snippets:Object(ce.a)(t.snippets),documentLinkPreview:Object(We.a)({outputType:dt.b}),video:Object(v.a)(t.video)};return{pluginConfig:t,plugins:n,commonPluginsGroup:Object(tt.a)({useDropdown:!0,dropdownText:Object(N.jsx)(P.a,{message:"customerDataRte.plugins.tooltips.more"}),dropdownButtonClassName:"p-right-0"},n.fontStyles,n.sizeStyles,n.advancedTextColor,n.advancedBackgroundColor,n.separator,n.blockQuote,n.listStyles,n.blockAlignment)}},Tt=n("Peb5");n.d(t,"initializeRteConfig",function(){return Mt});n.d(t,"getRteConfig",function(){return _t});n.d(t,"createRteConfig",function(){return Dt});var It="default",Rt="Unknown RichTextEditor config type %s",At="RichTextEditorDefaultConfigurations not initialized",Nt=k.Seq.of(u.a,d),xt={hasContent:ht,pluginComposers:Nt},Lt=Object(k.Map)((bt={},Object(r.a)(bt,It,null),Object(r.a)(bt,o.i,null),Object(r.a)(bt,o.g,null),Object(r.a)(bt,o.a,null),Object(r.a)(bt,o.c,null),Object(r.a)(bt,o.h,null),Object(r.a)(bt,i.b,null),Object(r.a)(bt,i.a,null),Object(r.a)(bt,i.c,null),bt)),kt=function(e){var t,n=Ct(e),u=Et(n),l=u.plugins,d=u.pluginConfig,p=u.commonPluginsGroup,m=n.hasVideo,h=n.usePluginStack,f=void 0!==h&&h,g=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return Object(k.Seq)(t).filter(function(e){return!n[e]||!1!==fe()("enabled",n[e])}).map(function(e){return l[e]})},b=new Tt.a({type:It,plugins:g(St.atMention),pluginComposers:Nt,hasContent:ht}).configureWith(s.compose),O=new Tt.a({type:o.g,plugins:k.Seq.of.apply(k.Seq,Object(a.a)(g(St.atMention,St.inlineStyles,St.inlineStylesOverride,St.link,St.snippets)).concat([p])),pluginComposers:Nt,hasContent:ht}).configureWith(s.compose),v=new Tt.a({type:o.i,plugins:k.Seq.of.apply(k.Seq,Object(a.a)(g(St.atMention,St.inlineStyles,St.inlineStylesOverride,St.image,St.link,St.snippets)).concat([p])),pluginComposers:Nt,hasContent:ht}).configureWith(s.compose),j=new Tt.a({type:o.a,plugins:k.Seq.of.apply(k.Seq,Object(a.a)(g(St.atMention,St.inlineStyles,St.inlineStylesOverride)).concat([p],Object(a.a)(g(St.separator,St.link,St.image,St.snippets)))),pluginComposers:Nt,hasContent:ht}).configureWith(s.compose),S=k.Seq.of.apply(k.Seq,Object(a.a)(g(St.inlineStyles,St.inlineStylesOverride)).concat([p],Object(a.a)(g(St.separator,St.link,St.image,St.unstyledAsDiv,St.documentLinkPreview)))),y={type:o.c,plugins:S,pluginComposers:Nt,hasContent:ht},C={knowledgeArticles:Object.assign({},d.knowledgeArticles,{trackClick:d.knowledgeArticles.onOpenPopover}),snippets:Object.assign({},d.snippets,{trackClick:d.snippets.onOpenPopover}),meetings:{}};if(m){var E=d.video&&d.video.handleVideoTracking&&d.video.handleVideoTracking.openVideo;C.video=Object.assign({},d.video,{useInsertPopover:!0,trackClick:E})}y.pluginGroupConfig=C;var T,I=s.compose;if(f){I=c.a;T=c.b}var R=new Tt.a(y).configureWith(I,T),A=new Tt.a({plugins:k.Seq.of.apply(k.Seq,Object(a.a)(g(St.atMention,St.inlineStyles,St.inlineStylesOverride)).concat([p],Object(a.a)(g(St.link,St.image,St.snippets,St.knowledgeArticles)))),pluginComposers:Nt,hasContent:ht}).configureWith(s.compose),N=new Tt.a({type:o.h,plugins:k.Seq.of.apply(k.Seq,Object(a.a)(g(St.atMention,St.inlineStyles,St.inlineStylesOverride)).concat([p],Object(a.a)(g(St.separator,St.link,St.image,St.knowledgeArticles,St.snippets)))),pluginComposers:Nt,hasContent:ht}).configureWith(s.compose);Lt=Object(k.Map)((t={},Object(r.a)(t,It,b),Object(r.a)(t,o.i,v),Object(r.a)(t,o.g,O),Object(r.a)(t,o.a,j),Object(r.a)(t,o.c,R),Object(r.a)(t,o.h,N),Object(r.a)(t,i.b,A.set("type",i.b)),Object(r.a)(t,i.a,A.set("type",i.a)),Object(r.a)(t,i.c,A.set("type",i.c)),t))};function Mt(e){kt(e)}function _t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:It;_()(Lt.has(e),Rt,e);var t=Lt.get(e);_()(t,At);return t}function Dt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(k.Seq)(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(k.Seq)(),a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Object(k.Map)(),r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=Lt.get(e);_()(null!==i,At);if(!i){var u=Object.assign({type:e},xt);i=new Tt.a(u)}t=Object(k.Seq)(t);n=Object(k.Seq)(n);if(!(a=a.merge(i.pluginGroupConfig)).isEmpty()){var l=Object(p.a)(me(a.toJS()));t=t.concat([l])}var d,m=s.compose;if(r&&e===o.c){m=c.a;d=c.b}t.isEmpty()&&n.isEmpty()||(i=i.enhanceWith(Date.now(),t,n).configureWith(m,d));return i}},Peb5:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var a=n("YM6t"),r=n("vTCD"),i=n("k8Et"),o=n("mNyx"),s=n("txVw"),c=n("pGTB"),u=n("QYOI"),l=n("EvX1"),d=n.n(l),p=function(e){Object(c.a)(t,e);function t(){Object(r.a)(this,t);return Object(o.a)(this,Object(s.a)(t).apply(this,arguments))}Object(i.a)(t,[{key:"enhanceWith",value:function(e,t,n){return this.merge({type:this.type+"-"+e,plugins:this.plugins.concat(t),pluginComposers:this.pluginComposers.concat(n)})}},{key:"configureWith",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=this.plugins.toArray();if(this.pluginComposers.size>0){var r=t.apply(void 0,Object(a.a)(this.pluginComposers.toArray()));return this.set("composed",r.apply(void 0,Object(a.a)(n)))}return this.set("composed",e.apply(void 0,Object(a.a)(n)))}}]);return t}(Object(u.Record)({type:null,plugins:Object(u.Seq)(),pluginComposers:Object(u.Seq)(),pluginGroupConfig:Object(u.Map)(),composed:d.a,hasContent:null}))},QmtD:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return o});var a=n("QYOI"),r=n("xHov"),i="filemanager/api/v2/files/multiple";function o(e){return Object(r.c)(i,{id:e.toJS()},function(e){return Object(a.fromJS)(e).reduce(function(e,t){return t?e.set(""+t.get("id"),t):e},Object(a.Map)())})}e&&e.exports&&(e.exports.default=Object.assign({},e.exports))}).call(this,n("ABwO")(e))},ROLi:function(e,t,n){"use strict";n.r(t);var a=n("PeaV"),r=n("MBJP"),i=n("5jmW"),o=n("+Jpx"),s=Object(r.a)(o.a,function(e){return e.includes(i.c)}),c=n("qvRI");n.d(t,"initRteConfig",function(){return l});var u=function(e){c.a.log("communicatorInteraction",{action:e,activity:"email",channel:"email",source:"inbox"})};function l(e,t){a.initializeRteConfig({atMentions:{useInviteZeroState:!0,inviteZeroStateOpts:{}},hasVideo:t,link:{onOpenPopover:function(){return u("click link")},hideNoFollowConfiguration:!0},snippets:{tracker:function(){return u("insert snippet")},onOpenPopover:function(){return u("click snippet")}},knowledgeArticles:{tracker:function(){return u("insert knowledge article")},enabled:s,onOpenPopover:function(){return u("click knowledge article")}},formattingPluginGroup:{onOpenPopover:function(){return u("click to format text")}},image:{FileManager:e,drawerType:"IMAGE",useOptionsPopover:!0}})}},RaRG:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return a});n.d(t,"b",function(){return r});var a="hubspot:fiscalyear",r="GDPRComplianceEnabled";e&&e.exports&&(e.exports.default=Object.assign({},e.exports))}).call(this,n("ABwO")(e))},TvEW:function(e,t,n){"use strict";var a=n("QYOI"),r=n("c+8p"),i=n.n(r),o=n("emzX"),s=n.n(o),c=(n("aeBh"),n("RRvD")),u=n("ok3s"),l=(n("xHov"),n("Ly8s")),d=n("P4dz"),p=(n("bC4p"),n("MQNR")),m=n("7gk9");n("9Z7B"),n("vCNV"),n("WJYQ"),n("Nw75"),n("ZoqR"),n("u7ju");n.d(t,"a",function(){return f});n.d(t,"b",function(){return g});n.d(t,"c",function(){return b});n.d(t,"d",function(){return O});var h=function(e,t){return Object(a.Map)({objectId:e,objectType:p.CONTACT,associationType:t})};function f(e){return u.fetchByEmail(e).then(function(e){Object(l.a)(c.q,e);return e})}function g(e){Object(l.b)(c.r,Object(a.Set)(e));Object(l.b)(c.b,Object(a.Set)([h(e[0],m.n),h(e[0],m.o),h(e[0],m.s)]))}function b(e,t,n){var a=""+Object(d.a)(e),r=t.map(function(t,n){return Object(d.d)(e,n)});Object(l.a)(c.v,{id:a,properties:r,nextProperties:t});return u.updateContactProperties(e,t).then(function(){return Object(l.a)(c.w,{id:a,properties:t,prevProperties:r,contact:e})},function(e){Object(l.a)(c.u,{id:a,properties:r,nextProperties:t,error:e});i()(n)&&n(t,e);throw e})}function O(e){s()(a.Map.isMap(e),'ContactsActions: expected contacts to be a Map but got "%s"');return Object(l.a)(c.t,e)}},VFun:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return a});n.d(t,"b",function(){return r});n.d(t,"c",function(){return i});n.d(t,"d",function(){return o});n.d(t,"e",function(){return s});n.d(t,"f",function(){return c});n.d(t,"g",function(){return u});var a="COMPANY_TO_ADVISOR",r="COMPANY_TO_BOARD_MEMBER",i="COMPANY_TO_CONTRACTOR",o="COMPANY_TO_MANAGER",s="COMPANY_TO_OWNER",c="COMPANY_TO_PARTNER",u="COMPANY_TO_RESELLER";e&&e.exports&&(e.exports.default=e.exports)}).call(this,n("ABwO")(e))},VcCP:function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return a});n.d(t,"a",function(){return r});var a="UNKNOWN",r="PREVIOUSLY_BOUNCED";e&&e.exports&&(e.exports.default=Object.assign({},e.exports))}).call(this,n("ABwO")(e))},W2dw:function(e,t,n){"use strict";var a=n("QYOI");t.a=Object(a.Record)({fetchEmailRecipientDeliverabilityStatus:function(){throw new Error("EmailActions: fetchEmailRecipientDeliverabilityStatus(emailAddress, options) not defined")},sendConfirmationEmail:function(){throw new Error("EmailActions: sendConfirmationEmail() not defined")},sendEmail:function(){throw new Error("EmailActions: sendEmail(emailRecord, associations, options) not defined")},sendEmailUsingHubSpot:function(){throw new Error("EmailActions: sendEmailUsingHubSpot(emailRecord, options) not defined")},sendReplyEmail:function(){throw new Error("EmailActions: sendReplyEmail(emailRecord, associations, replyEngagementId, options) not defined")},scheduleEmail:function(){throw new Error("EmailActions: scheduleEmail(email, scheduledTime, associations, options,replyEngagementId) not defined")},provideLegalBasisForCommunication:function(){throw new Error("EmailActions: provideLegalBasisForCommunication(payload) not defined")},updateLocalLawfulBasis:function(){throw new Error("EmailActions: updateLocalLawfulBasis(lawfulBasis) not defined")},completeLocalLawfulBasis:function(){throw new Error("EmailActions: completeLocalLawfulBasis(subjectId) not defined")}},"EmailActions")},WJYQ:function(e,t,n){"use strict";n.d(t,"a",function(){return f});n.d(t,"b",function(){return g});n.d(t,"c",function(){return b});n("YM6t");var a=n("QYOI"),r=n("THQ/"),i=n.n(r),o=(n("eCP4"),n("emzX")),s=n.n(o),c=(n("nDpY"),n("RRvD")),u=n("Ly8s"),l=n("wfCi"),d=n("P4dz"),p=n("7gk9"),m=n("MQNR"),h=(i()([]),function(e,t){return Object(a.Map)({objectId:e,objectType:m.DEAL,associationType:t})});function f(e){Object(u.b)(c.I,Object(a.Set)(e));Object(u.b)(c.b,Object(a.Set)([h(e[0],p.w),h(e[0],p.x),h(e[0],p.y),h(e[0],p.z),h(e[0],p.A)]))}function g(e,t,n){null==n&&(n={});var a=""+Object(d.a)(e),r=Object(d.d)(e,"pipeline"),i=t.map(function(t,n){return Object(d.d)(e,n)});if(t.has("dealstage")&&!n.updatedValues){Object(u.a)(c.Q,{id:a,pipeline:r,nextProperties:t,prevProperties:i,options:n});return Promise.resolve()}Object(u.a)(c.L,{id:a,nextProperties:t,properties:i});return l.e(e,t).then(function(e){return Object(u.a)(c.M,{id:a,prevProperties:i,properties:t,deal:e})},function(e){Object(u.a)(c.K,{error:e,id:a,nextProperties:t,properties:i});throw e})}function b(e){s()(a.Map.isMap(e),"DealsActions: expected deals to be a Map but got `%s`",e);return Object(u.a)(c.J,e)}},WYIs:function(e,t,n){"use strict";(function(e){n.d(t,"f",function(){return a});n.d(t,"a",function(){return r});n.d(t,"b",function(){return i});n.d(t,"d",function(){return o});n.d(t,"e",function(){return s});n.d(t,"c",function(){return c});var a="GENERIC",r="BLACKLISTED_EMAIL_IN_RECIPIENTS",i="BLACKLISTED_EMAIL_IN_RECIPIENTS_NO_EMAIL",o="EMAIL_SEND_ERROR",s="ENGAGEMENT_CREATION_INTERNAL_ERROR",c="EMAILSENDINGAPIERROR";e&&e.exports&&(e.exports.default=Object.assign({},e.exports))}).call(this,n("ABwO")(e))},Wumz:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var a=n("MQNR"),r=n("kJ/w"),i=n("G/lG"),o=[a.COMPANY,a.CONTACT,a.DEAL,a.TICKET],s=function(e){return o.includes(e)},c={},u=[a.COMPANY,a.CONTACT,a.DEAL,a.TICKET],l=function(e){return u.includes(e)||c[e]&&Object(r.a)(c[e],i.a.get(c[e]))},d=function(e,t){return!!t||s(e)&&l(e)}},X3fw:function(e,t,n){"use strict";var a=n("QYOI"),r=n("KLfa"),i=n("1RCs"),o="Prospects",s=n("Zwtj"),c=n("ap+s"),u=n("xHov"),l=n("J92U"),d=n("emzX"),p=n.n(d),m=Object(a.fromJS)({id:[],ignoreDeletes:!0,includeAllValues:!0,associatedObjectFetch:!0}),h=function(e,t){p()(a.List.isList(e),"CompaniesAPIQuery: expected "+t+" to be a List but got %s",e)};function f(e){h(e,"companyIds");return m.merge({id:e})}n.d(t,"a",function(){return j});n.d(t,"b",function(){return S});n.d(t,"c",function(){return C});n.d(t,"f",function(){return E});n.d(t,"g",function(){return T});n.d(t,"d",function(){return I});n.d(t,"e",function(){return R});var g="companies/v2/companies",b="companies/v2/domains",O=g+"/batch",v={"X-Properties-Source":i.c,"X-Properties-SourceId":i.e};i.c;function j(e){return Object(u.f)({headers:v,type:c.d},g,{properties:e},function(e){return Object(a.Map)().set(e.companyId,s.a.fromJS(e))})}function S(e){return l.a(g+"/"+e)}var y=function(e){return e.reduce(function(e,t,n){return e.set(n,s.a.fromJS(t))},Object(a.Map)())};function C(e){return Object(u.c)(O,f(e)).then(y)}function E(e){return Object(u.f)({headers:v,type:c.e},g+"/"+e.get("companyId"),e)}function T(e,t){var n=e.get("companyId");return Object(u.f)({headers:v,type:c.e},g+"/"+n,{companyId:n,properties:t.reduce(function(e,t,n){e.push({name:n,value:t,source:i.e,sourceId:r.a.get().get("email")});return e},[])})}function I(e,t,n){null==t&&(t=5);null==n&&(n={companyId:null,isPrimary:!0});var r={requestOptions:{properties:["name","domain","hubspot_owner_id","hubspot_team_id"]},limit:t,offset:n};return Object(u.d)(b+"/"+encodeURIComponent(e)+"/companies",r).then(function(e){var t=e.get("results").reduce(function(e,t){return e.set(t.get("companyId"),s.a.fromJS(t))},Object(a.Map)());return e.set("results",t)})}function R(e,t){var n=e.get("companyId");return Object(u.a)(g+"/"+n+"/domains/"+encodeURIComponent(t))}},Ykb2:function(e,t,n){"use strict";n.d(t,"b",function(){return a});n.d(t,"c",function(){return r});n.d(t,"a",function(){return i});var a=200,r=10,i=3},ZoqR:function(e,t,n){"use strict";n.d(t,"a",function(){return c});n.d(t,"b",function(){return u});var a=n("QYOI"),r=n("emzX"),i=n.n(r),o=n("RRvD"),s=n("Ly8s");function c(e){return Object(s.a)(o.rc,Object(a.Set)(e))}function u(e){i()(a.Map.isMap(e),'VisitsActions: expected companies to be a Map but got "%s"');return Object(s.a)(o.sc,e)}},ZsE6:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return i});var a=n("nDpY"),r=n.n(a).a.get(),i="defaultPipelineId:"+r;e&&e.exports&&(e.exports.default=Object.assign({},e.exports))}).call(this,n("ABwO")(e))},"Zwz/":function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n("MBJP"),r=n("KXN9"),i=n("x1JE"),o=n("JWeH"),s=function(e,t){return t.threadId},c=Object(a.a)([s,o.a],function(e,t){var n=e&&Object(i.b)(e,t);return n&&Object(r.a)(n)})},aZYI:function(e,t,n){"use strict";n.d(t,"a",function(){return a});function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!=t.searchText?t.searchText:e.state&&e.state.searchText&&e.state.searchText.length?e.state.searchText:e.searchText?e.searchText:void 0}},bC4p:function(e,t,n){"use strict";n.d(t,"a",function(){return O});var a=n("YM6t"),r=n("Ly8s"),i=n("Sx0/"),o=n.n(i),s=n("emzX"),c=n.n(s),u=n("k6JV"),l=n.n(u),d=n("c+8p"),p=n.n(d),m=n("pPiP"),h=n.n(m),f=n("bI0L"),g=n.n(f);function b(e){var t=e.accept,n=e.commit,a=e.operation,r=e.rollback;c()(p()(a),"expected `options.operation` to be a function but got `%s`",a);c()(!t||l()(t)||p()(t),"expected `options.accept` to be an optional array or function but got `%s`",t);c()(l()(n),"expected `options.commit` to be an array but got `%s`",n);c()(l()(r),"expected `options.rollback` to be an array but got `%s`",r);return e}function O(e){var t=b(e),n=t.accept,i=t.commit,s=t.operation,u=t.rollback;r.a.apply(void 0,Object(a.a)(i));var d=s();c()(g()(d),"expected operation to return a promise but got `%s`",d);d.then(function(e){return l()(n)?r.a.apply(void 0,Object(a.a)(n)):p()(n)?n(e):o.a}).catch(h.a.apply(void 0,[r.a].concat(Object(a.a)(u)))).done();return d}},bn2T:function(e,t,n){"use strict";(function(e){n.d(t,"c",function(){return a});n.d(t,"d",function(){return r});n.d(t,"i",function(){return i});n.d(t,"g",function(){return o});n.d(t,"a",function(){return s});n.d(t,"h",function(){return c});n.d(t,"f",function(){return u});n.d(t,"e",function(){return l});n.d(t,"b",function(){return d});var a="EMAIL",r="EMAIL_ACTIVITY",i="TASK",o="MEETING",s="CALL",c="NOTE",u="INCOMING_EMAIL",l="FORWARDED_EMAIL",d="CONVERSATION_SESSION";e&&e.exports&&(e.exports.default=Object.assign({},e.exports))}).call(this,n("ABwO")(e))},bsBP:function(e,t,n){"use strict";var a,r=n("OwGx"),i=n("MQNR"),o=n("d29O"),s=n("nDpY"),c=n.n(s).a.get(),u=(a={EMAIL_CLIENT_SETTINGS:["EMAIL_CLIENT_SETTINGS"],EMAIL_TRACKING_SETTINGS:["EMAIL_TRACKING_SETTINGS"],EMAIL_UNSUBSCRIBE_LINK_TYPE:["hubspot","gdpr","unsubscribe-link"],ONBOARDING_SETTINGS:["onboarding","onboarding-settings"],SALES_SEGMENTATION:["onboarding","sales-segmentation"],SEGMENTS_FOLDERS_LAST_VIEWED:["segments-folders-last-viewed"],SEGMENTS_DISMISSED_STALE_LIST_EXPLANATION:["segments-folders-dismissed-stale-list-explanation"],SIGNEDUP_VIA_SPACESWORD:["viaSpacesword"],TIP_POPOVER_SETTINGS:["onboarding","onboarding-tip-popovers"]},Object(r.a)(a,"COLUMN_FAVS_"+i.TASK,[o.a[i.TASK],"FavoriteColumns_V2"]),Object(r.a)(a,"COLUMN_FAVS_"+i.VISIT,[o.a[i.VISIT],"FavoriteColumns"]),Object(r.a)(a,"RECENTLY_USED_PROPERTIES_"+i.VISIT,[o.a[i.VISIT],"recently-used-properties"]),Object(r.a)(a,"HIDE_EMAIL_IMPORT_FOR_CONTACT",["hide-email-import-for-contact"]),Object(r.a)(a,"HIDE_EMAIL_IMPORT_FOR_ALL",["hide-email-import-for-all"]),Object(r.a)(a,"TASKS_SIDEBAR_COLLAPSED",["Tasks","sidebar-collapsed"]),Object(r.a)(a,"DISMISSED_RECORD_REDIRECT_FROM_TABLE_ONBOARDING",["Tasks","dismissed-record-redirect-from-table-onboarding"]),Object(r.a)(a,"DISMISSED_NEW_TASKS_TODAY_SHEPHERD",["Tasks","dismissed-new-tasks-onboarding"]),a);[i.CONTACT,i.COMPANY,i.DEAL,i.TICKET].forEach(function(e){u["TIMELINE_FAVS_"+e]=[o.a[e],"FavoriteTimelineEvents"];u["COLUMN_FAVS_"+e]=[o.a[e],"FavoriteColumns"];u["PROPERTY_EDITOR_HIDE_BLANK_"+e]=[o.a[e],"property_editor_hide_blank"];u["PROPERTY_EDITOR_OPEN_GROUPS_"+e]=[o.a[e],"property_editor_open_groups"];u["RECENTLY_USED_PROPERTIES_"+e]=[o.a[e],"recently-used-properties"]});Object.keys(u).forEach(function(e){var t=u[e];u[e]=t.join(":")+":"+c});t.a=u},cHKa:function(e,t,n){"use strict";var a=n("QYOI"),r=n("c2Nv"),i=Object(a.Record)({to:new r.a,emailAddresses:Object(a.Set)()},"Recipient");t.a=i},cxUl:function(e,t,n){"use strict";var a=n("QYOI"),r=n("emzX"),i=n.n(r),o=n("MQNR"),s=n("mzNV"),c=Object(a.fromJS)({offset:0,count:10,filterGroups:[],sorts:[]}),u=Object(a.fromJS)({property:"name",order:"ASC"}),l={associatedWithContact:function(e,t){null==t&&(t=c);i()("number"==typeof e,'expected contactId to be a number but got "%s" instead',e);return t.merge(Object(a.fromJS)({filterGroups:{filters:[{operator:"EQ",property:"associations.contact",value:e}]}}))},associatedWithChidren:function(e,t,n){return Object(a.fromJS)({filterGroups:[{filters:[{operator:"EQ",property:"hs_parent_company_id",value:e}]}],count:t,query:n})},default:function(e){var t=c.merge(Object(a.fromJS)(e)).updateIn(["sorts"],function(e){return e.push(u)});return Object(s.a)({objectType:o.COMPANY,query:t})}};t.a=l},d0Ul:function(e,t,n){"use strict";var a=n("mzNV"),r=n("QYOI"),i=n("MQNR"),o=Object(r.fromJS)({offset:0,count:10,filterGroups:[],sorts:[]}),s=Object(r.fromJS)({property:"dealId",order:"DESC"}),c={default:function(e){var t=o.merge(Object(r.fromJS)(e)).updateIn(["sorts"],function(e){return e.push(s)});return Object(a.a)({objectType:i.DEAL,query:t})},associatedDeal:function(e,t,n,a){return Object(r.fromJS)({filterGroups:[{filters:[{operator:"EQ",property:"associations."+e.toLowerCase(),value:t}]}],count:n,offset:0,query:a})}};t.a=c},d1d8:function(e,t,n){"use strict";var a=n("vTCD"),r=n("k8Et"),i=n("mNyx"),o=n("txVw"),s=n("pGTB"),c=n("QYOI"),u=n("FGZp"),l=n("jNxY"),d=n("6ePo"),p=d.s.DRAFT_ATOMIC_TYPE_VIDEO,m=function(e,t){var n=[],a=e.getCurrentContent(),r=a.getBlockMap();r.filter(function(e){return"atomic"===e.getType()&&e.getData().get("atomicType")===p}).forEach(function(e){var a=e.getData(),i=a.toJS(),o=i.uuid,s=i.customId,c=Object(l.a)(o,t,s);n.push(c);c.then(function(t){var n=t.sharing_page,i=a.set("url",n),o=e.set("data",i);r=r.set(e.getKey(),o)})});var i=function(){var e=a.set("blockMap",r);return u.EditorState.createWithContent(e)};return Promise.all(n).then(i).catch(i)},h=d.s.DRAFT_ATOMIC_TYPE_VIDEO,f=/\?vyetoken=[^&]*/g,g=function(e){var t=e.getCurrentContent(),n=t.getBlockMap();n.filter(function(e){return"atomic"===e.getType()&&e.getData().get("atomicType")===h}).forEach(function(e){var t=e.getData(),a=t.get("url"),r=document.createElement("a");r.href=a;r.search=r.search.replace(f,"");var i=t.set("url",r.href),o=e.set("data",i);n=n.set(e.getKey(),o)});var a=t.set("blockMap",n);return u.EditorState.createWithContent(a)};n.d(t,"a",function(){return b});var b=function(e){Object(s.a)(t,e);function t(){Object(a.a)(this,t);return Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}Object(r.a)(t,[{key:"hasState",value:function(){return!!this.editorState}},{key:"hasContent",value:function(){return this.hasState()&&this.contentMediator.hasContent(this.editorState)}},{key:"toRawEditorContent",value:function(){return Object(c.fromJS)(this.contentMediator.toJson(this.editorState.getCurrentContent()))}},{key:"pushRawEditorContent",value:function(e){c.Map.isMap(e)&&(e=e.toJS());var t=this.contentMediator.fromJson(e),n=this.contentMediator.setContent(this.editorState,t);return this.setEditorState(n)}},{key:"pushContent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.contentMediator.fromHtml(e),a=this.contentMediator.setContent(this.editorState,n,t);return this.setEditorState(a)}},{key:"resetEditorState",value:function(){var e=this.contentMediator.resetContent();return this.setEditorState(e)}},{key:"setEditorState",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.merge({editorState:e,contentChanged:t})}},{key:"manageVideoTokens",value:function(e,t){if(0===this.numberOfVideos())return Promise.resolve(this);if(1===e&&t)return m(this.editorState,t).then(this.setEditorState.bind(this));var n=g(this.editorState);return Promise.resolve(this.setEditorState.call(this,n))}},{key:"html",value:function(){this._html||(this._html=this.contentMediator.toHtml(this.editorState.getCurrentContent()));return this._html}},{key:"plainText",value:function(){this._plainText||(this._plainText=this.editorState.getCurrentContent().getPlainText());return this._plainText}},{key:"atMentions",value:function(){this._atMentions||(this._atMentions=this.contentMediator.getAtMentions(this.editorState.getCurrentContent()));return this._atMentions}},{key:"numberOf",value:function(e,t){this[e]||(this[e]=t(this.editorState.getCurrentContent()));return this[e]}},{key:"numberOfImages",value:function(){return this.numberOf("_numberOfImages",this.contentMediator.getNumberOfImages)}},{key:"numberOfVideos",value:function(){return this.numberOf("_numberOfVideos",this.contentMediator.getNumberOfVideos)}},{key:"numberOfLinks",value:function(){return this.numberOf("_numberOfLinks",this.contentMediator.getNumberOfLinks)}},{key:"transform",value:function(e,t){delete this._html;delete this._plainText;delete this._atMentions;return this.setEditorState(e(this.editorState,t),this.contentChanged)}}]);return t}(Object(c.Record)({editorState:null,contentChanged:!1,contentMediator:null},"RichTextEditorResultsRecord"))},d29O:function(e,t,n){"use strict";var a,r=n("OwGx"),i=n("MQNR"),o=(a={},Object(r.a)(a,i.COMPANY,"Companies"),Object(r.a)(a,i.CONTACT,"Contacts"),Object(r.a)(a,i.CONVERSATION,"Conversation"),Object(r.a)(a,i.DEAL,"Deals"),Object(r.a)(a,i.ENGAGEMENT,"Engagements"),Object(r.a)(a,i.FEEDBACK_SUBMISSION,"Feedback Submissions"),Object(r.a)(a,i.FORM,"Form"),Object(r.a)(a,i.LINE_ITEM,"Line Item"),Object(r.a)(a,i.OBJECT_LIST,"Lists"),Object(r.a)(a,i.PRODUCT,"Product"),Object(r.a)(a,i.QUOTE,"Quotes"),Object(r.a)(a,i.QUOTE_MODULE,"Quote modules"),Object(r.a)(a,i.QUOTE_MODULE_FIELD,"Quote module fields"),Object(r.a)(a,i.QUOTE_TEMPLATE,"Quote templates"),Object(r.a)(a,i.TASK,"Tasks"),Object(r.a)(a,i.TICKET,"Tickets"),Object(r.a)(a,i.VISIT,"Visits"),a);t.a=o},duMR:function(e,t,n){"use strict";var a=n("QYOI");t.a=Object(a.Record)({dependency:null,create:function(){throw new Error("RecipientResolverFactory: create(subjectId, type, options) not defined")}},"RecipientResolverFactory")},folk:function(e,t,n){"use strict";var a=n("YM6t"),r=n("QYOI"),i=n("LljG"),o=n.n(i),s=n("bn2T"),c=n("vNYB"),u=n("5mx2"),l=n("RRvD"),d=n("3y0f"),p=n("bkwg"),m=n("U0r4"),h=n("MQNR"),f=n("P4dz");Object(r.List)(),f.b,f.a,f.c;function g(e){switch(e){case h.COMPANY:return["associations","companyIds"];case h.CONTACT:return["associations","contactIds"];case h.DEAL:return["associations","dealIds"];case h.TICKET:return["associations","ticketIds"];default:return}}var b=n("57l5"),O=n("emzX"),v=n.n(O),j=Object(r.fromJS)({property:[]});function S(e){v()(r.List.isList(e),"EngagementsAPIQuery: expected engagementIds to be a List but got %s",e);return j.merge({engagementId:e})}var y=n("AgF4"),C=n("aORY"),E=n.n(C),T=new r.Map({addressChange:"addressChange",BOUNCE:"bounce",BOUNCED:"bounce",CLICK:"click",DELIVERED:"delivered",DROPPED:"dropped",SUPPRESSED:"suppressed",EMAIL_CLICK:"click",EMAIL_OPEN:"open",EMAIL_REPLY:"reply",EMAIL_TRACKER_CREATE:"sent",FORWARD:"forward",FAILED:"failed",INCOMING_EMAIL:"reply",OPEN:"open",PRINT:"print",SENT:"sent",SENDING:"sent",SPAMREPORT:"spamReport",SCHEDULED:"scheduled"}),I=(E()({ADDRESS_LIST_BOMBED:null,BOUNCE:null,BOUNCED:null,CLICK:null,DELIVERED:null,DROPPED:null,FAILED:null,SUPPRESSED:null,MTA_DROPPED:null,OPEN:null,SPAMREPORT:null,STATUSCHANGE:null,UNBOUNCE:null,UNSUBSCRIBED:null,GLOBALLY_BLOCKED_RECIPIENT_ADDRESS:null,RECIPIENT_PREVIOUSLY_BOUNCED_GLOBALLY:null,GLOBALLY_BLOCKED_RECIPIENT_DOMAIN:null,RECIPIENT_PREVIOUSLY_BOUNCED_ON_PORTAL:null,PREVIOUSLY_MARKED_AS_SPAM:null,UNSUBSCRIBED_PORTAL:null,OTHER_SEND_REJECTED:null,PERMANENT_FAIL:null,UNSUBSCRIBED_PERSONAL:null,SEND_AS_PERMISSIONS_DENIED:null,RATE_LIMITED:null,RATE_LIMITED_BY_CLIENT:null,RATE_LIMITED_BY_PROVIDER:null,PREVIOUSLY_BOUNCED:null,PREVIOUS_SPAM:null,PREVIOUSLY_UNSUBSCRIBED_MESSAGE:null,PREVIOUSLY_UNSUBSCRIBED_MESSAGE_GDPR:null,PREVIOUSLY_UNSUBSCRIBED_PORTAL:null,PREVIOUSLY_UNSUBSCRIBED_PORTAL_GDPR:null,INVALID_TO_ADDRESS:null,INVALID_FROM_ADDRESS:null,BLOCKED_DOMAIN:null,BLOCKED_ADDRESS:null,EMAIL_UNCONFIRMED:null,CAMPAIGN_CANCELLED:null,MTA_IGNORE:null,PORTAL_OVER_LIMIT:null,PORTAL_SUSPENDED:null,CANCELLED_ABUSE:null,UNKNOWN_REASON:null,QUARANTINED_ADDRESS:null,GRAYMAIL_SUPPRESSED:null,RECIPIENT_FATIGUE_SUPPRESSED:null,REPLY:null}),E()({SUBSCRIBED:null,UNSUBSCRIBED:null}),T.get("SENT"),T.get("DELIVERED"),T.get("OPEN"),T.get("CLICK"),T.get("REPLY"),new r.List([T.get("SCHEDULED"),T.get("SENT"),T.get("DELIVERED"),T.get("OPEN"),T.get("CLICK"),T.get("INCOMING_EMAIL"),T.get("BOUNCE"),T.get("DROPPED"),T.get("SUPPRESSED"),T.get("FAILED")]),E()({EMAIL:null,INCOMING_EMAIL:null}),E()({EMAIL_CLICK:null,EMAIL_OPEN:null,EMAIL_REPLY:null}),E()({CLICK:null,OPEN:null,DELIVERED:null}),new r.Map({CALL:"ENGAGEMENTS_CALLS",EMAIL_OLD:"ENGAGEMENTS_EMAILS",EMAIL:"ENGAGEMENTS_EMAILS_TRIMMED",FORWARDED_EMAIL:"ENGAGEMENTS_EMAILS_TRIMMED",INCOMING_EMAIL:"ENGAGEMENTS_EMAILS_TRIMMED",MEETING:"ENGAGEMENTS_MEETINGS",NOTE:"ENGAGEMENTS_NOTES",TASK:"ENGAGEMENTS_TASKS",FEEDBACK_SUBMISSION:"ENGAGEMENTS_FEEDBACK_SUBMISSIONS",CONVERSATION_SESSION:"ENGAGEMENTS_CONVERSATION_SESSIONS"}),"eventEngagement"),R=(E()({ERROR:null}),Object(r.Map)({ASSIGNED_OWNER:["eventData","engagement","ownerId"],ASSOCIATED_COMPANIES:["eventData","associations","companyIds"],ASSOCIATED_CONTACTS:["eventData","associations","contactIds"],ASSOCIATED_DEALS:["eventData","associations","dealIds"],BODY:["eventData","metadata","body"],END_TIME:["eventData","metadata","endTime"],HTML:["eventData","metadata","html"],OWNERS:["eventData","associations","ownerIds"],START_TIME:["eventData","metadata","startTime"],SUBJECT:["eventData","metadata","subject"],TIMESTAMP:["eventData","engagement","timestamp"],TITLE:["eventData","metadata","title"],ENGAGEMENT_TYPE:["eventData","engagement","type"]}),new r.Map({etype:"eventMonth",hasEvents:!1,id:null,timestamp:null}),new r.Map({DAYS:"days",MONTHS:"months",WEEKS:"weeks"}),n("omic")),A=n.n(R),N=n("eVil"),x=n.n(N),L=function(e){return!!r.Map.isMap(e)&&(e.get("etype")===I&&(r.Map.isMap(A()(["eventData","engagement"],e))||r.Map.isMap(x()("engagement",e))))},k=Object(r.Seq)([s.g,s.a,s.h,s.i,s.b]),M=function(e){return!!e.getIn(["eventData","engagement","isSample"])},_=function(e){return k.contains(e.getIn(["eventData","engagement","type"]))},D=function(e){return L(e)&&(_(e)||M(e))},P=function(e,t){return e?e.filter(function(e){return!t.includes(e)}):Object(r.List)()},w=function(e,t,n,r){var i=""+t,o=e.get(i);if(!o)return e;var s=o.getIn(r),c=P(s,n);return e.setIn([i].concat(Object(a.a)(r)),c)},B=function(e,t,n,i){var o=""+t,s=e.getIn([o].concat(Object(a.a)(i)))||Object(r.List)();return e.setIn([o].concat(Object(a.a)(i)),s.concat(n).toSet().toList())},F=function(e,t){var n=t.sampleEvents,a=n&&n.size?n:t.get("events");return a?a.reduce(function(e,t){if(!D(t))return e;var n=t.getIn(["eventData","engagement","id"]),a=Object(c.a)(t.get("eventData"));return e.set(""+n,a)},e):e};Object(m.a)({actionTypePrefix:u.i,fetcher:o()(b.e,S)});t.a=Object(p.a)({actionTypePrefix:u.i}).defineName("EngagementsStore").defineResponseTo([d.n,d.k,d.o,d.p],function(e,t){var n=t.subjectId,a=t.objectIds,r=g(t.objectType);return w(e,n,a,r)}).defineResponseTo([d.f,d.c,d.g,d.h],function(e,t){var n=t.subjectId,a=t.objectIds,r=g(t.objectType);return B(e,n,a,r)}).defineResponseTo([l.ib,l.Ib,l.a,l.hb],F).defineResponseTo(l.R,function(e,t){var n=t.engagementId;return e.setIn([""+n,"metadata","recordingUrl"],null)}).defineResponseTo(l.X,function(e,t){var n=t.first(),a=n.getIn(["engagement","id"]);return e.setIn([""+a,"attachments"],n.get("attachments"))}).defineResponseTo([d.a],function(e,t){var n=t.engagementId,a=t.universalAssociationMap;return e.setIn([""+n,"associations","universalAssociations"],a)}).defineResponseTo([d.i,d.q],function(e,t){var n=t.engagementId,a=t.updatedAssociationRecord,r=a.get("toObjectTypeId");return e.setIn([""+n,"associations","universalAssociations",r],a)}).register(y.a)},h7ha:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var a=n("vTCD"),r=n("k8Et"),i=n("mNyx"),o=n("txVw"),s=n("pGTB"),c=n("QYOI"),u=n("c2Nv"),l=function(e){Object(s.a)(t,e);function t(){Object(a.a)(this,t);return Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}Object(r.a)(t,[{key:"hasIntegration",value:function(){return this.hasGoogleIntegration||this.hasOffice365Integration||this.hasImapIntegration}}]);return t}(Object(c.Record)({from:new u.a,aliasEmailAddresses:Object(c.Set)(),signature:null,hasPrimaryAccount:!0,hasEnabledAccounts:!0,hasGoogleIntegration:!1,hasOffice365Integration:!1,hasImapIntegration:!1},"Sender"))},ihRn:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return a});n.d(t,"b",function(){return r});n.d(t,"c",function(){return i});n.d(t,"e",function(){return o});n.d(t,"d",function(){return s});n.d(t,"f",function(){return c});n.d(t,"g",function(){return u});var a="EMAIL_ALIAS_SIGNATURE_CHANGED",r="EMAIL_QUOTE_LINK_INSERTED",i="EMAIL_RESET",o="EMAIL_SEND_WITH_BRANDING_BANNER",s="EMAIL_SEND_FAILED",c="EMAIL_SEND_WITH_USER_ENTERED_ALIAS",u="EMAIL_TRACKING_TOOLTIP_DISMISSED";e&&e.exports&&(e.exports.default=Object.assign({},e.exports))}).call(this,n("ABwO")(e))},kEfQ:function(e,t,n){"use strict";n.r(t);(function(e){n.d(t,"EMAIL",function(){return a});n.d(t,"LOGGED_EMAIL",function(){return r});n.d(t,"NOTE",function(){return i});n.d(t,"CALL",function(){return o});n.d(t,"LOGGED_CALL",function(){return s});n.d(t,"SCHEDULE",function(){return c});n.d(t,"LOGGED_MEETING",function(){return u});n.d(t,"TASK",function(){return l});n.d(t,"LINKED_IN_MESSAGE",function(){return d});n.d(t,"LINKED_IN_CONNECT",function(){return p});var a="email",r="logged-email",i="note",o="call",s="logged-call",c="schedule",u="logged-meeting",l="task",d="linked-in-message",p="linked-in-connect";e&&e.exports&&(e.exports.default=Object.assign({},e.exports))}).call(this,n("ABwO")(e))},lRoN:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return a});var a="FLOATING_COMMUNICATOR_FULLSCREEN_SAVE";e&&e.exports&&(e.exports.default=Object.assign({},e.exports))}).call(this,n("ABwO")(e))},lTBm:function(e,t,n){"use strict";(function(e){n.d(t,"c",function(){return a});n.d(t,"b",function(){return r});n.d(t,"a",function(){return i});var a="sendTo",r="cc",i="bcc";e&&e.exports&&(e.exports.default=Object.assign({},e.exports))}).call(this,n("ABwO")(e))},lpDa:function(e,t,n){"use strict";var a=n("AgF4"),r=n("nDpY"),i=n.n(r),o=n("yMxc"),s=n("5mx2"),c=n("RRvD"),u=n("F0In"),l=n("QYOI"),d=n("xHov"),p=n("emzX"),m=n.n(p);function h(e){m()("number"==typeof e,"SettingsAPI: expected portalId to be a number but got %s",e)}var f=n("e0QY"),g=Object(l.fromJS)({length:500,internal:!1});function b(e,t){return e.set(t.get("key"),t.get("value"))}function O(e){return e.get("settings").reduce(b,Object(l.Map)())}function v(e){return"hubs/v1/hubs/"+e+"/settings"}function j(e){h(e);return d.c(v(e),g.toJS()).then(O)}function S(e){var t=u.a.getRequestStateByName("hubSettingsQuickFetch");return t?new Promise(function(e,n){t.whenFinished(function(t){u.a.removeEarlyRequest("hubSettingsQuickFetch");e(O(Object(l.fromJS)(t)))});t.onError(function(e,t){Object(f.a)({error:new Error("SettingsAPI: Settings early requester failed"),extraData:{request:e,error:t},tags:{requestName:"Hub Settings"}});u.a.removeEarlyRequest("hubSettingsQuickFetch");n(Object(l.Map)())})}).catch(function(){return j(e)}):j(e)}t.a=Object(o.a)({fetch:function(){return S(i.a.get())},namespace:s.p}).defineName("SettingsStore").defineResponseTo([c.Mb,c.Qb],function(e,t){var n=t.key,a=t.value;return e.setIn(["value",n],a)}).defineResponseTo([c.S],function(e,t){var n=t.key;return e.deleteIn(["value",n])}).register(a.a)},"mTb/":function(e,t,n){"use strict";n.d(t,"a",function(){return i});n.d(t,"b",function(){return s});var a="id",r="type";function i(e){return"interaction-"+e}function o(e,t,n){return e+"-"+t+"-"+n}function s(e,t,n,s){var c=s(arguments.length>4&&void 0!==arguments[4]?arguments[4]:localStorage,i(e));return!(!c||c[a]!==o(e,t,n))&&c[r]}},mzNV:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var a=n("eVil"),r=n.n(a),i=n("6l6v"),o=n.n(i),s=n("nDpY"),c=n.n(s),u=n("QYOI"),l=n("Wumz"),d=Object(u.Map)({allPropertiesFetchMode:"latest_version",includeAllValues:!0}),p=function(e){var t=e.isCrmObject,n=e.objectType,a=e.query;return Object(l.a)(n,t)?a.withMutations(function(e){return e.update("requestOptions",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=r()("properties",a);return o()(t)?e:e.delete("allPropertiesFetchMode").delete("includeAllValues").set("properties",t)}).delete("properties").update("objectTypeId",function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:n}).update("portalId",function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.a.get()})}):a}},oo3K:function(e,t,n){"use strict";var a=n("QYOI");t.a=Object(a.Record)({connectFn:function(){throw new Error("ProviderBranding: connectFn() not defined")},connectPromptLogo:null,syncLogo:null,tooltip:null},"ProviderBranding")},pZnI:function(e,t,n){"use strict";n.d(t,"b",function(){return c});n.d(t,"l",function(){return u});n.d(t,"a",function(){return l});n.d(t,"c",function(){return d});n.d(t,"f",function(){return m});n.d(t,"g",function(){return h});n.d(t,"h",function(){return f});n.d(t,"i",function(){return g});n.d(t,"k",function(){return b});n.d(t,"j",function(){return O});n.d(t,"e",function(){return v});n.d(t,"d",function(){return j});var a=n("q57L"),r=n("LdnN"),i=n("aitF"),o=/[^\s]/,s=function(e,t){return!!e&&t.test(e)};function c(e){return s(e,o)}function u(e,t){return c(e)&&t.hasContent()}function l(e,t){return!c(e)&&!t.hasContent()}function d(e,t){var n=t.get(e);return!n||(!n.hasStatus()||n.deliverable())}function p(e,t,n){return!(t.to.exists()&&!t.to.hasAddress())&&(!!e.hasIntegration()||d(t.to.address,n))}function m(e){return e("verified-email")}function h(e,t,n){return p(e,t,n)}function f(e,t,n,a){return m(a)&&p(e,t,n)}function g(e,t,n,a,r,i){return t.to.hasAddress()&&u(r,a)&&f(e,t,n,i)}function b(e,t){return e.isIntegrated(t)?e.isDisabled(t)?a.c:!!e.isDisconnected(t)&&a.d:a.a}function O(e){return!e.hasEnabledAccounts&&a.b}function v(e){return r.a.test(e)}var j=n.n(i)()(function(e,t){return e&&e.find(function(e){if("DOMAIN"===e.get("type")){var n=t.indexOf("@"),a=t.slice(n+1);return e.get("value")===a}return e.get("value")===t})})},pzuj:function(e,t){e.exports="//static.hsappstatic.net/draft-email-branding-plugin/static-2.6948/images/sprocket-web-color.png"},q57L:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return a});n.d(t,"b",function(){return r});n.d(t,"c",function(){return i});n.d(t,"d",function(){return o});var a="connectAccountInbox",r="connectInbox",i="enable",o="reconnect";e&&e.exports&&(e.exports.default=Object.assign({},e.exports))}).call(this,n("ABwO")(e))},"qL+2":function(e,t,n){"use strict";var a=n("MQNR"),r=n("d29O"),i=n("nDpY"),o=n.n(i).a.get(),s=[a.CONTACT,a.COMPANY,a.DEAL,a.TICKET,a.VISIT],c=[a.DEAL,a.TASK,a.TICKET],u=["0-1","0-2","0-3","0-5"],l={COZY_CARD_PREFERENCES:["CRM","Index","Board","CozyCardPreferences"],CLOSE_COUNT_IMPORT_KB_MODAL:["closed-import-kb-modal"],DISMISSED_SHOW_ALL_EMAIL_REPLIES_ONBOARDING:["dismissed-show-all-email-replies-onboarding"],DISMISSED_THREAD_EMAIL_REPLIES_ONBOARDING:["dismissed-thread-email-replies-onboarding"],DISMISSED_EXPAND_COLLAPSE_TIMELINE_ONBOARDING:["dismissed-expand-collapse-timeline-onboarding"],DONT_SHOW_CONFIRM_ACCOUNT_SWITCH:["no-show-confirm-account-switch"],DONT_SHOW_FOLLOW_UP_TASK:["Tasks","Queues","FollowUpTasks","hide"],HAS_CHECKED_SEQUENCE_STEP_SKIP_TASK:["Tasks","Queues","has-checked-sequence-step-skip-task"],HAS_CHECKED_SEQUENCE_STEP_COMPLETE_TASK:["Tasks","Queues","has-checked-sequence-step-complete-task"],EMAIL_COMMUNICATOR_TRACKING_TOOLTIP_SHOWN:["has-viewed-email-communicator-tracking-tooltip"],GOOGLE_CALENDAR:["integrations:google-calendar-v2:portal-"+o],HAS_CHECKED_ASSOCIATION_DEAL_BOX_COMPANY:["has-checked-association-deal-box-company"],HAS_CHECKED_ASSOCIATION_DEAL_BOX_CONTACT:["has-checked-association-deal-box-contact"],HAS_CHECKED_ASSOCIATION_TICKET_BOX_COMPANY:["has-checked-association-ticket-box-company"],HAS_CHECKED_ASSOCIATION_TICKET_BOX_CONTACT:["has-checked-association-ticket-box-contact"],HAS_CLOSED_KILL_SENDGRID_ALERT:["has-closed-kill-sendgrid-alert"],HAS_CLOSED_THREAD_REPLY_MESSAGE:["has-closed-ticket-reply-message"],HAS_COLLAPSED_RIGHT_SIDEBAR:["has-collapsed-right-sidebar"],HAS_COMPLETED_INDEX_ONBOARDING:["CRM","Index","Onboarding"],HAS_SEEN_COBJECT_ONBOARDING_SHEPHERD:["CRM","Index","CobjectsOnboarding",o,"HasSeenShepherd"],HAS_SEEN_COBJECT_ONBOARDING_MODAL:["CRM","Index","CobjectsOnboarding",o,"HasSeenModal"],HAS_COMPLETED_RECORD_ONBOARDING:["CRM","ObjectRecord","Onboarding"],HAS_SEEN_ILS_LIST_MIGRATION_TOUR:["CRM","Segments",o,"HasSeenMigrationTour"],HAS_SEEN_ILS_FOLDER_MIGRATION_TOUR:["CRM","Segments",o,"HasSeenFolderTour"],HAS_SEEN_PINNED_NOTE:["CRM","hasSeenNotePopover"],HAS_TRIGGERED_INDEX_REDESIGN_FINAL_ROLLOUT_ALERT:["has-triggered-index-redesign-final-rollout-alert"],HAS_VIEWED_CARD_CUSTOMIZATION_FEATURE_ALERT:["CRM","Index","card-customization-feature-alert"],HAS_VIEWED_CUSTOMIZABLE_CARDS_ONBOARDING_TOUR:["CRM","onboarding","customizable-cards-tour"],HAS_VIEWED_DEAL_EMPTY_STATE:["Deals","viewed","emptyState"],HAS_VIEWED_DEALS_CHICKLET_ONBOARDING:["Deals","viewed","chickletOnboarding"],HAS_VIEWED_DEALS_CELEBRATION_MODAL:["Deals","viewed","celebration-modal"],HAS_VIEWED_DEAL_STAGE_PROPERTIES_ONBOARDING:["CRM","DealStageProperties","Onboarding"],HAS_VIEWED_IMPORT_CHANGE_BANNER:["has-viewed-import-change-banner"],HAS_VIEWED_IMPORT_UPDATE_SHEPHERD:["has-viewed-import-update-shepherd"],HAS_VIEWED_INDEX_REDESIGN_FIRST_TIME_ALERT:["has-viewed-index-redesign-first-time-alert"],HAS_VIEWED_LINE_ITEMS_REDESIGN_SHEPHERD:["has-viewed-line-items-redesign-shepherd"],HAS_VIEWED_SMART_TASK_ONBOARDING:["Tasks","SmartTasks","ViewedOnboarding"],HAS_VIEWED_TASKS_EMPTY_STATE:["Tasks","viewed","emptyState"],HIDE_ASSOCIATE_PANEL_ONBOARDING_ALERT:["hide-associate-panel-onboarding-alert"],HIDE_IMPORT_INFO_STEP:["hide-import-info-step"],HIDE_LINE_ITEM_COLUMN_CONFIRM_MODAL:["hide-line-item-column-confirm-modal"],HIDE_MEETINGS_PRO_TIP:["hide-meetings-pro-tip"],HIDE_QUOTE_DRAFTED_MODAL:["hide-quotes-drafted-modal"],HIDE_QUOTE_EXPIRED_MODAL:["hide-quotes-expired-modal"],HIDE_QUOTES_SENDER_COMPANY_POPOVER:["hide-quotes-sender-company-popover"],HIDE_PROPOSAL_CUSTOMIZATION_ALERT:["hide-proposal-customization-alert"],IS_TIMELINE_EXPANDED_BY_DEFAULT:["is-timeline-expanded-by-default"],JOB_TITLE:["jobtitle"],LINKEDIN_SALES_NAVIGATOR:["LINKEDIN_SALES_NAVIGATOR"],NPS_SETTINGS:["NPS_SURVEY","nps_survey_completed"],PICKED_PORTAL_MODAL:["PickedPortalModal"],QUOTES_TEMPLATE_PREFERENCE:["quotes-template-preference"],THREE_COLUMN_PROFILES_VIEWED:["3-column-profiles-viewed"],VIDEO_INTEGRATION_HAS_CREATED_VIDEO:["video-integration-has-created-video"],VIEW_ALL_PROPERTIES_CLICKED:["view-all-properties-clicked"],VIEWED_RECORDS_COUNT:["viewed-records-count"]};s.forEach(function(e){l["PROFILE_SIDEBAR_"+e]=[r.a[e],"sidebar_settings"];l["PROFILE_SIDEBAR_"+e+"_ORDER"]=[r.a[e],"sidebar_order"];l["PROFILE_RIGHT_SIDEBAR_"+e+"_ORDER"]=[r.a[e],"right_sidebar_order"];l["PROFILE_LEFT_SIDEBAR_"+e+"_ORDER"]=[r.a[e],"left_sidebar_order"]});u.forEach(function(e){l["SIDEBAR_COLLAPSE_STATE"+e]=[e,"sidebar_settings"]});c.forEach(function(e){l[e+"_VIEWTYPE_DEFAULT"]=[""+e,"viewtype","default"]});c.forEach(function(e){l[e+"_INACTIVE_IS_TURNED_ON"]=[""+e,"board_inactive_is_turned_on"];l[e+"_INACTIVE_LIMIT"]=[""+e,"board_inactive_limit"];l[e+"_INACTIVE_LIMIT_UNIT"]=[""+e,"board_inactive_limit_unit"]});Object.keys(l).forEach(function(e){var t=l[e];l[e]=""+t.join(":")});t.a=l},rCVw:function(e,t,n){"use strict";n.d(t,"b",function(){return a});n.d(t,"c",function(){return r});n.d(t,"d",function(){return i});n.d(t,"a",function(){return o});var a="INACTIVE",r="NEEDS_PERMISSION",i="RECONNECT",o="DISABLED"},rEFu:function(e,t,n){"use strict";var a=n("QYOI");t.a=Object(a.Record)({emailSettings:null,emailWizard:null,emailWizardImap:null,redirect:null},"EmailIntegrationLinks")},"t3/f":function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return a});n.d(t,"b",function(){return r});n.d(t,"c",function(){return i});n.d(t,"d",function(){return o});n.d(t,"e",function(){return s});n.d(t,"f",function(){return c});n.d(t,"g",function(){return u});var a="ADVISOR_TO_COMPANY",r="BOARD_MEMBER_TO_COMPANY",i="CONTRACTOR_TO_COMPANY",o="MANAGER_TO_COMPANY",s="OWNER_TO_COMPANY",c="PARTNER_TO_COMPANY",u="RESELLER_TO_COMPANY";e&&e.exports&&(e.exports.default=e.exports)}).call(this,n("ABwO")(e))},txDU:function(e,t,n){"use strict";n.r(t);var a=n("vTCD"),r=n("k8Et"),i=n("mNyx"),o=n("txVw"),s=n("pGTB"),c=n("QgEn"),u=n("VfuR"),l=n.n(u),d=n("r1tY"),p=n.n(d),m=n("Sx0/"),h=n.n(m),f=n("t6nY"),g=n.n(f),b=n("a7/P"),O=n("FGZp"),v=n("muUi"),j=n("Peb5"),S=n("d1d8"),y=n("QYOI"),C=n("sbZX"),E=n.n(C),T=n("WW83"),I=n("uYow"),R={config:function(e){return e.composed},toHtml:function(e){return e.composed(T.convertToHTML)},fromHtml:function(e){return e.composed(T.convertFromHTML)},hasContent:!0},A=function(e){return new I.default(E()(R,e))},N=Object(y.Map)();function x(e){var t=e.type;if(!N.has(t)){var n=A(e);N=N.set(t,n)}return N.get(t)}var L=n("46u0"),k=n.n(L),M=n("k6JV"),_=n.n(M);function D(e,t){var n=t.keyCode;_()(e)||(e=[e]);return e.forEach(function(e){var t=e.keys,a=e.cb,r=e.validationFn;if(_()(t)){if(!Array.from(t).includes(n))return}else if(n!==t)return;r&&!r()||a()})}var P=n("pPiP"),w=n.n(P),B=n("aitF"),F=n.n(B),U=n("IQ+J"),q=n("OwGx"),G=n("soyi"),V=n("JyZI"),H=n("EHlm"),z=n("vuW9"),W=n("DqRu"),K={ControlsAreaComponent:l.a.func,cancelLabel:l.a.node.isRequired,children:l.a.array,controlSize:l.a.oneOf(["default","small","extra-small"]),controlsAreaComponentProps:l.a.object,controlsButtonsClassName:l.a.string,controlsClassName:l.a.string,insetUseClassName:l.a.string,onCancel:l.a.func.isRequired,onSave:l.a.func.isRequired,onSecondarySave:l.a.func,open:l.a.bool,overrideDrawStyle:l.a.bool,renderSaveButtons:l.a.func,saveDisabled:l.a.bool,saveLabel:l.a.node.isRequired,saveOnEnter:l.a.bool,saveTooltip:l.a.shape({headingText:l.a.string,onClose:l.a.func,open:l.a.bool,placement:l.a.string,title:l.a.string,use:l.a.string,disabled:l.a.bool}),secondarySaveButtonContent:l.a.func,showCancel:l.a.bool,showControlsBorder:l.a.bool,use:l.a.oneOf(["inset","flush"]),useTertiaryButtons:l.a.bool,wrapperClassName:l.a.string,useStickyControls:l.a.bool},Y=Object(c.jsx)(k.a,{message:"customerDataRte.actions.save"}),Q=Object(c.jsx)(k.a,{message:"customerDataRte.actions.cancel"}),J={cancelLabel:Q,className:"m-top-0",controlSize:"extra-small",insetUseClassName:"p-x-5",open:!1,saveDisabled:!1,saveLabel:Y,saveOnEnter:!0,saveTooltip:{open:!1},showControlsBorder:!1,use:"inset",showCancel:!0},X=function(e){Object(s.a)(t,e);function t(){var e;Object(a.a)(this,t);(e=Object(i.a)(this,Object(o.a)(t).call(this))).partial=F()(w.a);return e}Object(r.a)(t,[{key:"getConditionalClasses",value:function(){return Object(q.a)({},this.props.insetUseClassName,"inset"===this.props.use)}},{key:"renderControlsAreaComponent",value:function(){var e=this.props,t=e.ControlsAreaComponent,n=e.controlsAreaComponentProps;return t?Object(c.jsx)(t,Object.assign({},n)):null}},{key:"renderPrimarySaveButton",value:function(){var e=this.props,t=e.controlSize,n=e.saveLabel,a=e.saveDisabled,r=e.onSave,i=e.saveTooltip;return Object(c.jsx)("span",{className:"m-x-2",children:Object(c.jsx)(z.a,Object.assign({},i,{children:Object(c.jsx)(W.a,{disabled:a,onClick:r,size:t,use:"primary","data-selenium-test":"rich-text-editor-controls__save-btn",children:n})}))})}},{key:"renderControls",value:function(){var e=this.props,t=e.controlsClassName,n=e.controlSize,a=e.cancelLabel,r=e.onCancel,i=e.secondarySaveButtonContent,o=e.onSecondarySave,s=e.showCancel,u=e.renderSaveButtons,l=g()("rich-text-editor-controls",t),d=u?u({onSecondarySave:o}):Object(c.jsxs)("span",{children:[this.renderPrimarySaveButton(),i&&i(o)]});return Object(c.jsxs)("div",{className:l,children:[d,s&&Object(c.jsx)(W.a,{onClick:r,size:n,use:"secondary",children:a})]})}},{key:"renderRedesignedButtons",value:function(){var e=this.props,t=e.saveDisabled,n=e.onSave,a=e.onCancel,r=e.saveTooltip,i=e.secondarySaveButtonContent,o=e.onSecondarySave,s=e.controlsClassName;return Object(c.jsxs)("div",{className:g()(s),children:[Object(c.jsx)(z.a,Object.assign({},r,{children:Object(c.jsx)(W.a,{disabled:t,onClick:n,use:"tertiary",size:"xs","data-selenium-test":"rich-text-editor-controls__save-btn",children:Y})})),i&&i(o),Object(c.jsx)(W.a,{onClick:a,use:"tertiary-light",size:"xs",children:Q})]})}},{key:"renderRedesignedControls",value:function(){return Object(c.jsxs)(V.a,{children:[Object(c.jsx)(G.a,{children:this.renderRedesignedButtons()}),this.renderControlsAreaComponent()]})}},{key:"render",value:function(){var e=this.props,t=e.open,n=e.controlsButtonsClassName,a=e.useTertiaryButtons,r=e.overrideDrawStyle,i=this.getConditionalClasses(),o=!a&&!r,s=g()("width-100",i,n,o&&"draw-controls-container");return a?this.renderRedesignedControls():Object(c.jsx)(H.a,{open:t,className:"communicator-slide-out"+(this.props.useStickyControls?" floating-communicator-sticky-footer":""),children:Object(c.jsxs)(V.a,{align:"center",className:s,children:[Object(c.jsx)(G.a,{children:this.renderControls()}),this.renderControlsAreaComponent()]},"emailDrawerButtonsContainer")})}}]);return t}(v.a);X.propTypes=K;X.defaultProps=J;var Z=X,$={ControlsAreaComponent:l.a.func,cancelLabel:l.a.node.isRequired,children:l.a.array,controlSize:l.a.oneOf(["default","small","extra-small"]),controlsAreaComponentProps:l.a.object,controlsButtonsClassName:l.a.string,controlsClassName:l.a.string,insetUseClassName:l.a.string,onCancel:l.a.func.isRequired,onSave:l.a.func.isRequired,onSecondarySave:l.a.func,open:l.a.bool,overrideDrawStyle:l.a.bool,renderSaveButtons:l.a.func,saveDisabled:l.a.bool,saveLabel:l.a.node.isRequired,saveOnEnter:l.a.bool,saveTooltip:l.a.shape({headingText:l.a.string,onClose:l.a.func,open:l.a.bool,placement:l.a.string,title:l.a.string,use:l.a.string,disabled:l.a.bool}),secondarySaveButtonContent:l.a.func,showCancel:l.a.bool,use:l.a.oneOf(["inset","flush"]),useTertiaryButtons:l.a.bool,wrapperClassName:l.a.string,useStickyControls:l.a.bool},ee=Object(c.jsx)(k.a,{message:"customerDataRte.actions.save"}),te={cancelLabel:Object(c.jsx)(k.a,{message:"customerDataRte.actions.cancel"}),className:"m-top-0",controlSize:"extra-small",insetUseClassName:"p-x-5",open:!1,saveDisabled:!1,saveLabel:ee,saveOnEnter:!0,saveTooltip:{open:!1},showControlsBorder:!1,use:"inset",showCancel:!0},ne=function(e){Object(s.a)(t,e);function t(){var e;Object(a.a)(this,t);(e=Object(i.a)(this,Object(o.a)(t).call(this))).handleEnter=function(){var t=e.props,n=t.saveOnEnter,a=t.onSave;n&&a()};e.partial=F()(w.a);return e}Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.ControlsAreaComponent,n=e.cancelLabel,a=e.controlSize,r=e.controlsAreaComponentProps,i=e.controlsButtonsClassName,o=e.controlsClassName,s=e.insetUseClassName,u=e.onCancel,l=e.onSave,d=e.onSecondarySave,p=e.open,m=e.overrideDrawStyle,h=e.saveDisabled,f=e.saveLabel,g=e.saveTooltip,b=e.secondarySaveButtonContent,O=e.showCancel,v=e.use,j=e.useStickyControls,S=e.useTertiaryButtons,y=e.wrapperClassName,C=e.renderSaveButtons;return Object(c.jsxs)("div",{"data-selenium-test":"rich-text-editor",className:y,onKeyUp:this.partial(D,[{keys:U.a,cb:this.handleEnter}]),children:[this.props.children,Object(c.jsx)(Z,{ControlsAreaComponent:t,cancelLabel:n,controlSize:a,controlsAreaComponentProps:r,controlsButtonsClassName:i,controlsClassName:o,insetUseClassName:s,onCancel:u,onSave:l,onSecondarySave:d,open:p,overrideDrawStyle:m,saveDisabled:h,saveLabel:f,renderSaveButtons:C,saveTooltip:g,secondarySaveButtonContent:b,showCancel:O,use:v,useStickyControls:j,useTertiaryButtons:S})]})}}]);return t}(v.a);ne.propTypes=$;ne.defaultProps=te;var ae=ne,re=n("P4dz"),ie=n("MQNR"),oe=n("bn2T"),se=n("tPYf"),ce=n("6dOn"),ue=n.n(ce),le=n("os+u"),de=n.n(le),pe=n("O/Gz"),me={associations:de.a.map,cancelLabel:l.a.node,children:l.a.node,className:l.a.string,config:l.a.instanceOf(j.a).isRequired,contactVid:l.a.oneOfType([l.a.string,l.a.number]),ControlsAreaComponent:l.a.func,controlsAreaComponentProps:l.a.object,controlsButtonsClassName:l.a.string,controlsClassName:l.a.string,controlSize:l.a.string,controlsUse:l.a.string,editorOptions:l.a.object,editorState:l.a.instanceOf(O.EditorState),focus:l.a.bool,ignoreMoveFocus:l.a.bool,inputClassName:l.a.string,interactionType:l.a.string,objectType:se.b,onCancel:l.a.func,onChange:l.a.func,onContentChange:l.a.func,onPaste:l.a.func,onSave:l.a.func,onSecondarySaveButtonClick:l.a.func,onStateCreated:l.a.func,overrideDrawStyle:l.a.bool,owners:l.a.array.isRequired,placeholder:l.a.string,readOnly:l.a.bool,renderTray:l.a.func,resetInitialStateOnSave:l.a.bool,renderSaveButtons:l.a.func,saveDisabled:l.a.bool,saveLabel:l.a.node,saveOnEnter:l.a.bool,saveTooltip:l.a.shape({open:l.a.bool,onClose:l.a.func,placement:l.a.string,headingText:l.a.string,title:l.a.string,use:l.a.string,disabled:l.a.bool}),secondarySaveButtonContent:l.a.func,showCancel:l.a.bool,showControls:l.a.bool,showControlsBorder:l.a.bool,showRTEBorder:l.a.bool,subject:se.a,unstyled:l.a.bool,useTertiaryButtons:l.a.bool,useStickyControls:l.a.bool,onPluginOpenModal:l.a.func,onPluginCloseModal:l.a.func,recipientEmail:l.a.string,defaultFont:l.a.string,defaultSize:l.a.string,defaultColor:l.a.string},he={associations:Object(y.Map)(),editorOptions:{spellCheck:!0},ignoreMoveFocus:!1,onCancel:h.a,onChange:h.a,onContentChange:h.a,onPaste:h.a,onSave:h.a,onStateCreated:h.a,overrideDrawStyle:!1,readOnly:!1,resetInitialStateOnSave:!0,saveDisabled:!1,saveOnEnter:!1,showCancel:!0,showControls:!1,showControlsBorder:!1,unstyled:!1,useTertiaryButtons:!1,useStickyControls:!1,onPluginOpenModal:h.a,onPluginCloseModal:h.a,defaultStyle:Object(y.OrderedSet)()},fe=function(e){Object(s.a)(t,e);function t(e){var n;Object(a.a)(this,t);(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).handleChange=function(e){var t=n.props,a=t.onChange,r=t.onContentChange,i=n.state.hasContent,o=n.createRichTextEditorResults(e);a(o);o.contentChanged&&r(o);i?n.debouncedHasContent():i=n.hasContent(e);n.setState({editorState:e,hasContent:i})};n.handlePastedText=function(e,t){null!=t&&null!=e&&n.props.onPaste(t);return!0};n.handleSave=function(){var e=n.props,t=e.saveDisabled,a=e.resetInitialStateOnSave;if(!t){var r=n.state.editorState,i=n.createRichTextEditorResults(r);a&&n.setState({initialEditorState:r});n.props.onSave(i)}};n.handleCancel=function(){n.setState({editorState:n.state.initialEditorState});n.props.onCancel()};n.handleSecondarySave=function(){var e=n.createRichTextEditorResults(n.state.editorState);n.props.onSecondarySaveButtonClick(e)};n.debouncedHasContent=ue()(2e3,function(){n.setState({hasContent:n.hasContent()})});n.rteContentMediator=x(e.config);n.state=n.createInitialComponentState(e);n.EditorWithPlugins=n.rteContentMediator.config(b.Editor);return n}Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.interactionType,n=e.defaultFont,a=e.defaultSize,r=e.defaultColor,i=this.state.editorState;this.setState({hasContent:this.hasContent()});n&&a&&r&&this.setState({defaultStyle:Object(y.OrderedSet)([n,a,r])});this.props.onStateCreated(this.createRichTextEditorResults(i));this.props.focus&&this.refs.richTextEditor.focus();if(this.refs.richTextEditor){var o=p.a.findDOMNode(this.refs.richTextEditor).querySelector(".public-DraftEditor-content");this.perfListener=Object(pe.a)("communicator:"+t);o.addEventListener("textInput",this.perfListener)}}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.editorState!==this.props.editorState&&e.editorState!==this.state.editorState&&this.setState(this.createComponentState(e));if(this.props.config!==e.config){this.rteContentMediator=x(e.config);this.EditorWithPlugins=this.rteContentMediator.config(b.Editor)}}},{key:"componentDidUpdate",value:function(e,t){null==e.focus&&this.props.focus&&this.refs.richTextEditor.focus();if(e.editorState!==this.props.editorState&&t.editorState!==this.props.editorState&&this.isContentChanged(t.editorState)){var n=this.state.editorState,a=this.createRichTextEditorResults(n);this.props.onContentChange(a)}var r=this.props,i=r.defaultFont,o=r.defaultSize,s=r.defaultColor;e.defaultFont===i&&e.defaultColor===s&&e.defaultSize===o||(i&&o&&s?this.setState({defaultStyle:Object(y.OrderedSet)([i,o,s])}):this.setState({defaultStyle:Object(y.OrderedSet)()}))}},{key:"componentWillUnmount",value:function(){this.debouncedHasContent.cancel();if(this.refs.richTextEditor){p.a.findDOMNode(this.refs.richTextEditor).querySelector(".public-DraftEditor-content").removeEventListener("textInput",this.perfListener)}}},{key:"createInitialComponentState",value:function(e){var t=this.createComponentState(e);t.initialEditorState=t.editorState;return t}},{key:"createComponentState",value:function(e){var t=e.editorState;t?this.props.interactionType===oe.c||this.props.ignoreMoveFocus||(t=O.EditorState.moveFocusToEnd(t)):t=O.EditorState.createEmpty();return{editorState:t,hasContent:t&&this.hasContent(t)}}},{key:"isContentChanged",value:function(e){return this.state.editorState.getCurrentContent().getBlockMap()!==e.getCurrentContent().getBlockMap()}},{key:"createRichTextEditorResults",value:function(e){return new S.a({editorState:e,contentChanged:this.isContentChanged(e),contentMediator:this.rteContentMediator})}},{key:"getWrapperClassName",value:function(){return g()("rich-text-editor",this.props.className)}},{key:"getInputClassName",value:function(){return g()("rich-text-editor-input has--email-style-reset",this.props.inputClassName,this.props.unstyled&&"unstyled",this.props.showRTEBorder&&"rte-border")}},{key:"getContactVid",value:function(){var e=this.props,t=e.subject,n=e.objectType,a=e.contactVid,r=t?Object(re.a)(t):null,i=Number(a);return i||(n===ie.CONTACT?Number(r):null)}},{key:"getSubjectId",value:function(){var e=this.props.subject;return e?""+Object(re.a)(e):null}},{key:"hasContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.editorState;return e&&this.rteContentMediator.hasContent(e)}},{key:"getSupplementalObjects",value:function(){var e={contactIds:ie.CONTACT,companyIds:ie.COMPANY,dealIds:ie.DEAL,ticketIds:ie.TICKET};return this.props.associations.reduce(function(t,n,a){var r=n.first(),i=e[a];i&&r&&(t[i]=r);return t},{})}},{key:"render",value:function(){var e=this.props,t=e.overrideDrawStyle,n=e.useTertiaryButtons,a=e.editorOptions,r=e.saveLabel,i=e.cancelLabel,o=e.saveDisabled,s=e.saveOnEnter,u=e.showControls,l=e.saveTooltip,d=e.controlsClassName,p=e.controlsButtonsClassName,m=e.ControlsAreaComponent,h=e.controlsAreaComponentProps,f=e.controlSize,g=e.controlsUse,b=e.showControlsBorder,O=e.owners,v=e.readOnly,j=e.secondarySaveButtonContent,S=e.showCancel,y=e.objectType,C=e.renderTray,E=e.useStickyControls,T=e.onPluginOpenModal,I=e.onPluginCloseModal,R=e.recipientEmail,A=e.renderSaveButtons,N=this.state,x=N.defaultStyle,L=N.editorState,k=this.EditorWithPlugins;return Object(c.jsxs)(ae,{ControlsAreaComponent:m,cancelLabel:i,controlSize:f,controlsAreaComponentProps:h,controlsButtonsClassName:p,controlsClassName:d,onCancel:this.handleCancel,onSave:this.handleSave,onSecondarySave:this.handleSecondarySave,open:u,overrideDrawStyle:t,renderSaveButtons:A,saveDisabled:o,saveLabel:r,saveOnEnter:s,saveTooltip:l,secondarySaveButtonContent:j,showCancel:S,showControlsBorder:b,use:g,useTertiaryButtons:n,useStickyControls:E,wrapperClassName:this.getWrapperClassName(),children:[Object(c.jsx)(k,Object.assign({ref:"richTextEditor",className:this.getInputClassName(),defaultStyle:x,editorState:L,onChange:this.handleChange,handlePastedText:this.handlePastedText,placeholder:this.props.placeholder,owners:O,contactVid:this.getContactVid(),subjectId:this.getSubjectId(),objectType:y,readOnly:v,renderTray:C,supplementalObjects:this.getSupplementalObjects(),onPluginOpenModal:T,onPluginCloseModal:I,recipientEmail:R},a)),this.props.children]})}}]);return t}(v.a);fe.propTypes=me;fe.defaultProps=he;t.default=fe},u7ju:function(e,t,n){"use strict";n.d(t,"c",function(){return m});n.d(t,"b",function(){return h});n.d(t,"a",function(){return f});n("OwGx");var a=n("QYOI"),r=n("emzX"),i=n.n(r),o=(n("nDpY"),n("MQNR")),s=n("RRvD"),c=n("Ly8s"),u=n("H3JF"),l=n("P4dz"),d=n("7gk9"),p=function(e,t){return Object(a.Map)({objectId:e,objectType:o.TICKET,associationType:t})};function m(e){i()(a.Map.isMap(e),"TicketsActions: expected tickets to be a Map but got `%s`",e);return Object(c.a)(s.Zb,e)}function h(e,t,n){null==n&&(n={});var a={id:""+l.a(e),nextProperties:t,properties:t.map(function(t,n){return l.d(e,n)}),options:n};if(t.has("hs_pipeline_stage")&&!n.updatedValues){Object(c.a)(s.ic,a);return Promise.resolve()}Object(c.a)(s.bc,a);return u.e(e,t).then(function(e){Object(c.a)(s.cc,{id:""+l.a(e),nextProperties:t})}).catch(function(e){Object(c.a)(s.ac,Object.assign({},a,{error:e}));throw e})}function f(e){Object(c.b)(s.Yb,Object(a.Set)(e));Object(c.b)(s.b,Object(a.Set)([p(e[0],d.N),p(e[0],d.O),p(e[0],d.P)]))}},uEQG:function(e,t,n){"use strict";(function(e){n.d(t,"i",function(){return a});n.d(t,"k",function(){return r});n.d(t,"g",function(){return i});n.d(t,"f",function(){return o});n.d(t,"c",function(){return s});n.d(t,"b",function(){return c});n.d(t,"a",function(){return u});n.d(t,"h",function(){return l});n.d(t,"l",function(){return d});n.d(t,"j",function(){return p});n.d(t,"e",function(){return m});n.d(t,"d",function(){return h});n.d(t,"m",function(){return f});n.d(t,"n",function(){return g});var a="MEETING_SIDEBAR",r="SALES_EXTENSION_SIDEBAR",i="LIVECHAT_SIDEBAR",o="LEADFLOWS_SIDEBAR",s="FORMS_SIDEBAR",c="DOCUMENTS_SIDEBAR",u="CRM_EMAIL_SIDEBAR",l="MARKETING_FREE_EMAIL_SIDEBAR",d="SKIP_SETUP",p="PARTNER_ID",m="LANDING_PAGE_TYPE",h="LANDING_PAGES_SIDEBAR",f="VIRAL_SOURCE_PORTAL_ID",g="VIRAL_SOURCE_USER_ID";e&&e.exports&&(e.exports.default=Object.assign({},e.exports))}).call(this,n("ABwO")(e))},uYow:function(e,t,n){"use strict";n.r(t);n.d(t,"default",function(){return O});var a=n("vTCD"),r=n("k8Et"),i=n("mNyx"),o=n("txVw"),s=n("pGTB"),c=n("QYOI"),u=n("FGZp"),l=n.n(u),d=n("a7/P"),p=n("K6mX"),m=n("vR9V"),h=n("6ePo"),f="VIDEO",g=function(e,t){e.findEntityRanges(function(e){return null!==e.getEntity()},t)},b=function(e,t){return u.EditorState.set(e,{allowUndo:t})},O=function(e){Object(s.a)(t,e);function t(){Object(a.a)(this,t);return Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}Object(r.a)(t,[{key:"getAtMentions",value:function(e){var t=[];e.getBlocksAsArray().forEach(function(e){return g(e,function(n){return t.push(e.getEntityAt(n))})});return t.reduce(function(t,n){var a=(e.getEntity||u.Entity.get)(n);if(a){var r=a.get("data");if(r){var i=parseInt(r.value,10);!i||isNaN(i)||t.has(i)||(t=t.push(i))}}return t},Object(c.List)())}},{key:"getNumberOfImages",value:function(e){return e.getBlockMap().filter(function(e){return e.getData().get("atomicType")===h.f}).count()}},{key:"getNumberOfVideos",value:function(e){return e.getBlockMap().filter(function(e){return e.getData().get("atomicType")===f}).count()}},{key:"getNumberOfLinks",value:function(e){var t=Object(c.List)();if("function"!=typeof e.getEntity)return t;e.getBlockMap().filter(function(e){return e.getText()}).forEach(function(n){n.findEntityRanges(function(n){n.getEntity()&&(t=t.push(e.getEntity(n.getEntity())))})});return t.filter(function(e){return e.getType()===h.j}).size}},{key:"setContent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n||(e=b(e,!1));e=u.EditorState.push(e,t);n||(e=b(e,!0));return e}},{key:"resetContent",value:function(){return u.EditorState.createEmpty()}},{key:"toJson",value:function(e){return Object(u.convertToRaw)(e)}},{key:"fromJson",value:function(e){return Object(u.convertFromRaw)(e).update("blockMap",function(e){return e.map(function(e){if("atomic"===e.get("type")&&[h.f,f].includes(e.getIn(["data","atomicType"]))){var t=Object(c.fromJS)(e.get("data").toJS());return e.set("data",t)}return e})})}}]);return t}(Object(c.Record)({config:null,toHtml:null,fromHtml:null,hasContent:null,draft:l.a,utils:{changeBlockData:p.a,insertAtomicBlockWithData:m.a,pluginUtils:d.pluginUtils}}))},ufkj:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a,r=n("OwGx"),i=n("QYOI"),o=n("MQNR"),s=n("duMR"),c="CRM_OBJECT";t.b=Object(i.Record)((a={},Object(r.a)(a,o.CONTACT,Object(s.a)()),Object(r.a)(a,o.COMPANY,Object(s.a)()),Object(r.a)(a,o.DEAL,Object(s.a)()),Object(r.a)(a,o.TICKET,Object(s.a)()),Object(r.a)(a,c,Object(s.a)()),a),"RecipientResolverFactories")},v95M:function(e,t,n){"use strict";var a={};n.r(a);n.d(a,"associatedWithCompany",function(){return b});n.d(a,"associatedWithDeal",function(){return O});n.d(a,"defaultQuery",function(){return v});var r=n("OwGx"),i=n("d0Ul"),o=n("2TCK"),s=n("QYOI"),c=Object(s.Map)({offset:0,count:10,filterGroups:Object(s.List)(),sorts:Object(s.List)()}),u=Object(s.Map)({operator:"EQ",property:"engagement.type",value:"TASK"}),l=Object(s.Map)({property:"engagement.id",order:"DESC"}),d={default:function(e){return c.merge(Object(s.fromJS)(e)).updateIn(["sorts"],function(e){return e.push(l)}).updateIn(["filterGroups"],function(e){0===e.size&&(e=e.push(Object(s.Map)({filters:Object(s.List)()})));return e.map(function(e){var t=e.get("filters").push(u);return e.set("filters",t)})})}},p=n("/cKn"),m=n("mzNV"),h=n("MQNR"),f=Object(s.fromJS)({offset:0,count:10,filterGroups:[],properties:[],sorts:[]}),g=Object(s.fromJS)({property:"vid",order:"DESC"});function b(e,t,n){return Object(s.fromJS)({filterGroups:[{filters:[{operator:"EQ",property:"associatedcompanyid",value:e}]}],count:t,query:n})}function O(e,t,n){return Object(s.fromJS)({filterGroups:[{filters:[{operator:"IN",property:"vid",values:e}]}],count:t,query:n})}function v(e){var t=f.merge(Object(s.fromJS)(e)).updateIn(["sorts"],function(e){return e.push(g)});return Object(m.a)({objectType:h.CONTACT,query:t})}var j,S=n("cxUl"),y=Object(s.fromJS)({offset:0,count:10,filterGroups:[],sorts:[]}),C=Object(s.fromJS)({property:"domain",order:"DESC"}),E={default:function(e){return y.merge(Object(s.fromJS)(e)).updateIn(["sorts"],function(e){return e.push(C)})}},T=Object(s.fromJS)({count:10,filterGroups:[],offset:0,sorts:[]}),I=Object(s.fromJS)({order:"DESC",property:"hs_createdate"}),R={default:function(e,t){var n=T.merge(Object(s.fromJS)(t)).updateIn(["sorts"],function(e){return e.push(I)});return Object(m.a)({isCrmObject:!0,objectType:e,query:n})}},A=(j={},Object(r.a)(j,h.CONTACT,a),Object(r.a)(j,h.COMPANY,S.a),Object(r.a)(j,h.DEAL,i.a),Object(r.a)(j,h.ENGAGEMENT,o.a),Object(r.a)(j,h.TASK,d),Object(r.a)(j,h.TICKET,p.a),Object(r.a)(j,h.VISIT,E),j),N={default:function(e,t,n){var a=A[t];return a?a.defaultQuery?a.defaultQuery(e):a.default(e):n?R.default(t,e):void 0}};t.a=N},vCNV:function(e,t,n){"use strict";var a=n("QYOI"),r=n("emzX"),i=n.n(r),o=n("Ly8s"),s=n("RRvD"),c=function(e){return e.objectId+"-"+e.objectTypeId},u=n("P4dz"),l=(n("fzi9"),n("YM6t"),n("KLfa")),d=n("1RCs"),p=n("xHov"),m=n("ap+s"),h=n("ihjl"),f="inbounddb-objects/v1/crm-objects";function g(e,t){var n=e.get("objectId"),a=e.get("objectTypeId");return p.f({headers:{"X-Properties-SourceId":d.e},type:m.e},f+"/"+encodeURIComponent(a)+"/"+encodeURIComponent(n)+"?allPropertiesFetchMode=latest_version",[t.reduce(function(e,t,n){e.push({name:n,value:t,source:d.e,sourceId:l.a.get().get("email")});return e},[])],h.a.fromJS)}n.d(t,"b",function(){return b});n.d(t,"c",function(){return O});n.d(t,"a",function(){return v});function b(e,t,n){null==n&&(n={});var a={id:c({objectId:u.a(e),objectTypeId:e.objectTypeId}),nextProperties:t,properties:t.map(function(t,n){return u.d(e,n)}),options:n};Object(o.a)(s.G,a);return g(e,t).then(function(e){Object(o.a)(s.H,{id:c({objectId:u.a(e),objectTypeId:e.objectTypeId}),nextProperties:t})}).catch(function(e){Object(o.a)(s.F,Object.assign({},a,{error:e}))})}function O(e,t){i()(a.Map.isMap(e),"CrmObjectActions: expected crmObjects to be a Map but got `%s`",e);var n=e.mapKeys(function(e,n){return c({objectId:e,objectTypeId:t||n.objectTypeId})});return o.a(s.E,n)}function v(e,t){o.b("CRM_OBJECTS_REFRESH_QUEUED",Object(a.Set)(e.map(function(e){return c({objectId:e,objectTypeId:t})})))}},wfCi:function(e,t,n){"use strict";var a=n("QYOI"),r=n("KLfa"),i=n("1RCs"),o=n("Q6fd"),s=n("xHov"),c=n("J92U"),u=n("P4dz"),l=n("ap+s"),d=n("emzX"),p=n.n(d),m=n("D2Y9"),h="dealId";function f(e){p()(a.List.isList(e),"DealsAPIQuery: expected dealIds to be a List but got %s",e);return Object(a.Map)().set(h,e)}function g(e){return Object(m.stringify)(f(e).toJS())}var b=n("MQNR");n("E7+s");n.d(t,"a",function(){return y});n.d(t,"b",function(){return C});n.d(t,"c",function(){return E});n.d(t,"d",function(){return I});n.d(t,"e",function(){return R});var O={"X-Properties-Source":i.c,"X-Properties-SourceId":i.e},v="deals/v1/deal",j=v+"/batch",S=function(e){return j+"?"+e};function y(e){return Object(s.f)({headers:O,type:l.d},v,e,function(e){return Object(a.Map)().set(e.dealId,o.a.fromJS(e))})}function C(e){var t=e.propertyValues,n=e.requestedAssociatedObjects;return Object(s.f)({headers:O,type:l.d},"inbounddb-objects/v1/create-and-bulk-associate",{createObjectType:b.DEAL,propertyValues:t,requestedAssociatedObjects:n},function(e){e.dealId=e.objectId;return Object(a.Map)().set(e.dealId,o.a.fromJS(e))})}function E(e){return Object(c.a)(v+"/"+e)}var T=function(e){return e.reduce(function(e,t){var n=o.a.fromJS(t),a=Object(u.a)(n);return e.set(String(a),n)},Object(a.Map)())};function I(e){return Object(s.c)(S(g(e))).then(T)}function R(e,t){var n=e.get("dealId");return Object(s.f)({headers:O,type:l.e},v+"/"+n,{dealId:n,properties:t.reduce(function(e,t,n){e.push({name:n,value:t,source:i.e,sourceId:r.a.get().get("email")});return e},[])},o.a.fromJS)}},wrRD:function(e,t,n){"use strict";n.r(t);var a=n("LljG"),r=n.n(a),i=n("Xdd2"),o=n("AgF4"),s=n("vTCD"),c=n("k8Et"),u=n("mNyx"),l=n("txVw"),d=n("pGTB"),p=n("QgEn"),m=n("VfuR"),h=n.n(m),f=n("Ktcs"),g=n("vNYB"),b=n("QYOI"),O=n("Ig8d");n("L9KA"),n("mTb/");function v(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"body";return e!==t&&!t.metadata.get(n)}function j(e){return new O.a({richTextEditorResults:e})}function S(e,t,n){return new O.a(Object(b.fromJS)({metadata:{body:e.html(),plainText:e.plainText()},associations:{ownerIds:Object(b.Set)(e.atMentions())},engagement:{source:n,sourceId:t}}))}var y=Object(b.List)(["hubspot.customerdata.rte.config.RichTextEditorDefaultConfigurations","hubspot.customerdata.rte.state.RichTextEditorContentMediator"]),C=y.push("hubspot.customerdata.rte.components.RichTextEditor").toSeq(),E=(y.push("hubspot.customerdata.rte.components.SimpleRichTextEditor").toSeq(),n("Sx0/")),T=n.n(E),I=n("emzX"),R=n.n(I),A=n("aitF"),N=n.n(A),x=n("Y/yC"),L=n.n(x),k=N()(function(e){var t=L()();hubspot.require([e],function(e){t.resolve(e)});return t.promise});function M(){this.isAsyncRequireCancelled=!0}var _=function(e){if(!e.cancelAsyncRequire){e.isAsyncRequireCancelled=!1;e.cancelAsyncRequire=M.bind(e)}};function D(e,t){R()(e instanceof f.Component,"requireAsync: expected `component` to be an React class component instance but got `%s`",e);_(e);var n={};"string"==typeof t?t=Object(b.Seq)(t):R()(t&&t.size>0,"requireAsync: a module name or iterable of names must be provided");return Promise.all(t.map(function(t){R()("string"==typeof t,"requireAsync: module name must be defined");return k(t).then(function(a){if(!e.isAsyncRequireCancelled){var r=t.split(/[./]/),i=r[r.length-1];n[i]=a}})}).toArray()).then(function(){if(e.isAsyncRequireCancelled)throw new Error("requireAsync: cancelled");return n})}var P=function(e,t){var n=function(n){Object(d.a)(a,n);function a(e){var t;Object(s.a)(this,a);(t=Object(u.a)(this,Object(l.a)(a).call(this,e))).handleAsyncRequire=function(e){t.setState({modules:e,pending:!1})};t.state={pending:!0};return t}Object(c.a)(a,[{key:"componentDidMount",value:function(){D(this,t).then(this.handleAsyncRequire,T.a).done()}},{key:"componentWillUnmount",value:function(){this.cancelAsyncRequire()}},{key:"render",value:function(){return this.state.pending?null:Object(p.jsx)(e,Object.assign({},this.props,{},this.state.modules))}}]);return a}(f.Component);n.WrappedComponent=e;n.displayName="RichTextEditable("+e.displayName+")";return n},w=n("xRv3"),B=n("46u0"),F=n.n(B),U=n("rWb3"),q=n("DqRu"),G=n("fLy5"),V=function(e){Object(d.a)(t,e);function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).handleAttemptToRemount=function(){n.props.resetRetryCount();n.props.attemptToRemount()};return n}Object(c.a)(t,[{key:"render",value:function(){var e=this.props.enableManualRetry;return Object(p.jsx)(U.a,{titleText:Object(p.jsx)(F.a,{message:"customerDataCommunicator.richTextEditor.header"}),className:"m-x-5 m-top-3 p-top-4",type:"danger",children:Object(p.jsxs)(G.a,{children:[Object(p.jsx)("div",{className:"m-left-3 m-y-1",children:Object(p.jsx)(F.a,{message:"customerDataCommunicator.richTextEditor.errorRetry"})}),e&&Object(p.jsx)(q.a,{onClick:this.handleAttemptToRemount,use:"tertiary",size:"xs",className:"m-bottom-2",children:Object(p.jsx)(F.a,{message:"customerDataCommunicator.richTextEditor.retryButton"})})]})})}}]);return t}(f.Component);V.propTypes={attemptToRemount:h.a.func.isRequired,resetRetryCount:h.a.func.isRequired,enableManualRetry:h.a.bool.isRequired};var H=3,z=function(e){var t=e.connectRte,n=e.RichTextEditor;return function(e){Object(d.a)(a,e);function a(){var e,t;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=Object(u.a)(this,(e=Object(l.a)(a)).call.apply(e,[this].concat(r)))).state={crashRetryCount:0,enableManualRetry:!0};t.resetRetryCount=function(){t.setState({crashRetryCount:0,enableManualRetry:!1})};t.shouldResetAfterCrash=function(){var e=t.state.crashRetryCount;if(e<H){t.setState({crashRetryCount:e+1});return!0}t.setState({crashRetryCount:0});return!1};return t}Object(c.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.RichTextEditor=t(n)}},{key:"render",value:function(){var e=this.state.enableManualRetry;return Object(p.jsx)(w.a,{shouldAutoReset:this.shouldResetAfterCrash,boundaryName:"EditableInteractionComponent_RichTextEditor",showRefreshAlert:!1,ErrorComponent:V,errorProps:{resetRetryCount:this.resetRetryCount,enableManualRetry:e},children:Object(p.jsx)(this.RichTextEditor,Object.assign({},this.props))})}}]);return a}(f.Component)},W="",K={connectRte:h.a.func.isRequired,initialEditorState:h.a.object,interaction:h.a.oneOfType([h.a.instanceOf(O.a),h.a.instanceOf(g.a)]).isRequired,RichTextEditor:h.a.instanceOf(Function).isRequired},Y=function(e){var t=function(t){Object(d.a)(n,t);function n(e){var t;Object(s.a)(this,n);(t=Object(u.a)(this,Object(l.a)(n).call(this,e))).handleRteStateCreated=function(e){var n=t.props,a=n.initialEditorState,r=n.interaction;t.rteResults=e;if(a)t.setState({editorState:a});else{var i=r.metadata.get("body");if(i){var o=e.pushContent(i);o.hasContent()&&(t.rteResults=o)}else r.rawEditorContent&&(t.rteResults=e.pushRawEditorContent(r.rawEditorContent));t.setState({editorState:t.rteResults.editorState})}};t.handleRteStateChanged=function(e){t.rteResults=e};t.handleRteRestore=function(e){if(t.rteResults){var n=t.rteResults.pushContent(e);if(n.hasContent()){t.rteResults=n;t.setState({editorState:t.rteResults.editorState})}}};t.handleRteReset=function(){if(t.rteResults){t.rteResults=t.rteResults.resetEditorState();t.setState({editorState:t.rteResults.editorState})}};t.state={editorState:null};return t}Object(c.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){var e=this.props,t=e.connectRte,n=e.RichTextEditor;this.RichTextEditor=z({connectRte:t,RichTextEditor:n})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){v(this.props.interaction,e.interaction)&&this.handleRteReset();if(this.props.interaction.metadata.get("body")!==e.interaction.metadata.get("body")){if(!this.rteResults)return;var t=e.interaction.metadata.get("body")||W;this.rteResults=this.rteResults.pushContent(t);this.setState({editorState:this.rteResults.editorState})}}},{key:"render",value:function(){var t=this.state.editorState;return Object(p.jsx)(e,Object.assign({},this.props,{editorState:t,hasRteContent:!!this.rteResults&&this.rteResults.hasContent(),onRteChange:this.handleRteStateChanged,onRteStateCreated:this.handleRteStateCreated,onRteRestore:this.handleRteRestore,onRteReset:this.handleRteReset,RichTextEditor:this.RichTextEditor}))}}]);return n}(f.Component);t.WrappedComponent=e;t.displayName="EditableInteraction("+e.displayName+")";t.propTypes=K;return P(t,C)},Q=n("l52g"),J=n("h7ha"),X=n("StfA"),Z=n("CUpT"),$=n("jqvl"),ee=n.n($),te=function(){return Object(p.jsx)(Z.a,{className:"m-all-3",children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.interaction.problem.loading.message"})})},ne=n("e0QY"),ae=function(e){e.tags=e.tags||{};e.tags.communicatorType="EMAIL"},re=function(e){ae(e);ne.c(e)},ie=function(e){ae(e);ne.a(e)},oe=n("7XTd"),se={connectedAccounts:h.a.instanceOf(X.a),isPaidHub:h.a.bool,sender:h.a.instanceOf(J.a).isRequired,trialState:h.a.oneOfType([h.a.array,h.a.object]),unsubscribeLinkType:h.a.string},ce=function(e){var t=function(t){Object(d.a)(n,t);function n(){var e;Object(s.a)(this,n);(e=Object(u.a)(this,Object(l.a)(n).call(this))).state={loadingError:!1};return e}Object(c.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;this.timeout=16e3;this.loadingTimeout=setTimeout(function(){return e.handleLoadingTimeout()},this.timeout)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.loadingTimeout)}},{key:"isSenderInitialized",value:function(){return!!this.props.sender.from.id}},{key:"isUnsubscribeInitialized",value:function(){return!!this.props.unsubscribeLinkType&&this.props.unsubscribeLinkType!==oe.c}},{key:"isPaidHubInitialized",value:function(){return null!=this.props.isPaidHub}},{key:"isTrialStateInitialized",value:function(){return null!=this.props.trialState}},{key:"isSenderInError",value:function(){return"error"===this.props.sender.from.id}},{key:"isLoading",value:function(){return!(this.state.loadingError||this.isSenderInitialized()&&this.isUnsubscribeInitialized()&&this.isTrialStateInitialized()&&this.isPaidHubInitialized())}},{key:"hasLoadingErrors",value:function(){return this.state.loadingError||this.isSenderInError()}},{key:"getLoadingErrorCodes",value:function(){var e=[],t={error:new Error("Error in EmailWithLoadingIndicator"),extraData:{reasons:[],codes:[]}};if(!this.isSenderInitialized()||this.isSenderInError()){e.push("ca");this.isSenderInitialized()||t.extraData.reasons.push({message:"Sender was never set",detail:this.props.sender});this.isSenderInError()&&t.extraData.reasons.push({message:"Sender contains an error",detail:this.props.sender})}if(!this.isUnsubscribeInitialized()){e.push("unsub");t.extraData.reasons.push({message:"Unsubscribe link type is not set",detail:this.props.unsubscribeLinkType})}this.state.loadingError&&t.extraData.reasons.push({message:"Component did not load in "+this.timeout+"ms",detail:{loadingError:this.state.loadingError,isSenderInitialized:this.isSenderInitialized(),isUnsubscribeInitialized:this.isUnsubscribeInitialized(),isTrialStateInitialized:this.isTrialStateInitialized(),isPaidHubInitialized:this.isPaidHubInitialized()}});if(0===e.length){e.push("unk");t.extraData.reasons.push({message:"Unknown error",detail:this.props})}t.extraData.codes=e;t.extraData.connectedAccounts=this.props.connectedAccounts;ie(t);return e.join(",")}},{key:"handleLoadingTimeout",value:function(){this.isLoading()&&this.setState({loadingError:!0})}},{key:"renderLoading",value:function(){return Object(p.jsx)(Q.a,{grow:!0,minHeight:200})}},{key:"renderLoadingErrors",value:function(){return Object(p.jsx)(te,{codes:this.getLoadingErrorCodes()})}},{key:"render",value:function(){return this.isLoading()?this.renderLoading():this.hasLoadingErrors()?this.renderLoadingErrors():Object(p.jsx)(e,Object.assign({},this.props))}}]);return n}(f.Component);t.propTypes=se;return t},ue=n("pZnI"),le={className:h.a.string,onClick:h.a.func.isRequired},de={className:"p-x-5"},pe=function(e){var t=e.className,n=e.onClick;return Object(p.jsx)("footer",{className:t,children:Object(p.jsx)(q.a,{onClick:n,size:"small",use:"secondary",children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.interaction.cancel"})})})};pe.propTypes=le;pe.defaultProps=de;var me=pe,he={children:h.a.node,className:h.a.string,onClick:h.a.func.isRequired,showFooter:h.a.bool.isRequired},fe=function(e){var t=e.children,n=e.className,a=e.onClick,r=e.showFooter;return Object(p.jsxs)("div",{children:[t,r&&Object(p.jsx)(me,{className:n,onClick:a})]})};fe.propTypes=he;var ge=fe,be=n("VHfn"),Oe=n.n(be),ve=n("OwGx"),je=n("mDbF"),Se=n.n(je),ye=n("os+u"),Ce=n.n(ye),Ee=n("hr0l"),Te=n("a9fy"),Ie=n.n(Te),Re=n("q57L"),Ae=n("pPiP"),Ne=n.n(Ae),xe=n("muUi"),Le=n("sld6"),ke=n("WvEe"),Me=n("rOiA"),_e=n("yI0U"),De=n("QhRM"),Pe=n("oo3K"),we=n("rEFu"),Be=n("G/lG"),Fe={connectedEmailAddress:h.a.string,emailAddress:h.a.string,links:h.a.instanceOf(we.a).isRequired,onUseConnectedEmailAddress:h.a.func.isRequired,openHelpWidget:h.a.func.isRequired,providerBranding:Object(ye.mapOf)(h.a.instanceOf(Pe.a).isRequired).isRequired,use:h.a.oneOf([Re.a,Re.b,Re.c,Re.d]).isRequired,InboxConnectWizardDialog:h.a.func},Ue={onUseConnectedEmailAddress:T.a,InboxConnectWizardDialog:null},qe={mustConnect:"//knowledge.hubspot.com/articles/kcs_article/email-notifications/why-must-i-connect-my-inbox-to-send-email-with-hubspot-sales"},Ge=Object(ve.a)({},Re.b,qe.mustConnect),Ve=Ie()(function(){return Se.a.text("customerDataCommunicator.Communicator.Email.integrateEmail.title.default")}),He=function(e){return Se.a.text("customerDataCommunicator.Communicator.Email.integrateEmail.title."+e,{defaultValue:Ve()})},ze=function(e){var t=e.children;return Object(p.jsx)(Le.a,{className:"p-top-3 p-x-10",align:"center",justify:"center",children:t})};ze.propTypes={children:h.a.node.isRequired};var We=function(e){Object(d.a)(t,e);function t(e){var n;Object(s.a)(this,t);(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleConnect=function(e){e(n.props.links.redirect)};n.handleConnectImap=function(){window.location=n.props.links.emailWizardImap};n.partial=N()(Ne.a);n.handleConnectGmail=n.partial(n.handleConnect,e.providerBranding.get(Ee.a).connectFn);n.handleConnectOutlook365=n.partial(n.handleConnect,e.providerBranding.get(Ee.c).connectFn);n.state={isWizardOpen:!1};return n}Object(c.a)(t,[{key:"renderConnectSelectableButton",value:function(e,t,n){return Object(p.jsx)(_e.a,{className:"center-block m-x-2",size:"large",textLabel:Se.a.text("customerDataCommunicator.Communicator.Email.integrateEmail."+t),onClick:n,children:Object(p.jsx)(ke.a,{style:{height:"1.5rem"},src:e})})}},{key:"renderConnectButton",value:function(e,t){return Object(p.jsx)(q.a,{onClick:t,children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.integrateEmail."+e.key,options:e.options})})}},{key:"renderConnectLink",value:function(e,t,n){return Object(p.jsx)(q.a,{use:n,href:t,children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.integrateEmail."+e.key,options:e.options})})}},{key:"renderEnable",value:function(){var e=this.props,t=e.emailAddress,n=e.links,a={key:"visitSettings.enable",options:{emailAddress:t}};return this.renderConnectLink(a,n.emailSettings,"primary")}},{key:"renderConnectAccountInbox",value:function(){var e=this.props,t=e.emailAddress,n=e.connectedEmailAddress,a=e.onUseConnectedEmailAddress,r=e.links,i={key:"visitSettings.connectAccountInbox",options:{emailAddress:t}},o={key:"useAddress",options:{emailAddress:n}};return Object(p.jsxs)(ze,{children:[this.renderConnectLink(i,r.emailWizard,"primary"),n&&this.renderConnectButton(o,a)]})}},{key:"renderConnectInbox",value:function(){var e=this.props.providerBranding;return Object(p.jsxs)(ze,{children:[this.renderConnectSelectableButton(e.get(Ee.a).connectPromptLogo,"gmail",this.handleConnectGmail),this.renderConnectSelectableButton(e.get(Ee.c).connectPromptLogo,"outlook365",this.handleConnectOutlook365),this.renderConnectSelectableButton(e.get(Ee.b).connectPromptLogo,"imap",this.handleConnectImap)]})}},{key:"renderConnectWithInboxConnectWizard",value:function(){var e=this,t=this.props.InboxConnectWizardDialog,n=this.state.isWizardOpen,a=function(){return e.setState({isWizardOpen:!0})},r=function(t){e.setState({isWizardOpen:!1});t&&window.location.reload()};return Object(p.jsxs)(f.Fragment,{children:[n&&Object(p.jsx)(t,{onComplete:r,isExchangeFlowUngated:Be.a.get("CRM:ExchangeInboxFlow"),isUngatedForEmailSettingsMigration:Be.a.get("EmailSettingsMigration")}),Object(p.jsx)(ze,{children:Object(p.jsx)(q.a,{use:"primary",onClick:a,children:Object(p.jsx)(F.a,{message:"customerDataCommunicator.Communicator.Email.integrateEmail.connectInbox"})})})]})}},{key:"renderConnectActions",value:function(e){return e===Re.c?this.renderEnable():this.props.InboxConnectWizardDialog?this.renderConnectWithInboxConnectWizard():e===Re.a?this.renderConnectAccountInbox():this.renderConnectInbox()}},{key:"renderKnowledgeLink",value:function(e){var t=this.props.openHelpWidget,n=Ge[e];return n?Object(p.jsx)(De.a,{onClick:this.partial(t,n),className:"p-x-2",children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.integrateEmail.knowledgePrompt."+e})}):null}},{key:"renderMessage",value:function(e){var t=this.props.emailAddress;return Object(p.jsxs)("p",{className:"m-bottom-5 p-x-10",children:[Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.integrateEmail.usage."+e,options:{emailAddress:t}}),this.renderKnowledgeLink(e)]})}},{key:"render",value:function(){var e=this.props.use;return Object(p.jsxs)("div",{className:"p-top-8 p-bottom-10 p-x-4 text-center",style:{backgroundColor:"inherit"},children:[Object(p.jsx)(Me.a,{children:He(e)}),this.renderMessage(e),this.renderConnectActions(e)]})}}]);return t}(xe.a);We.propTypes=Fe;We.defaultProps=Ue;var Ke=We,Ye=Oe()(["links","openHelpWidget","providerBranding"],Ke.propTypes),Qe=function(e,t,n){var a=e.EmailProviderBranding,r=e.getEmailIntegrationLinks,i=e.openHelpWidget,o=e.InboxConnectWizardDialog,s=r(t,n),c=function(e){return Object(p.jsx)(Ke,Object.assign({},e,{links:s,openHelpWidget:i,providerBranding:a,InboxConnectWizardDialog:Be.a.get("Communicator:EnableInboxConnectModal")?o:null}))};c.propTypes=Ye;c.defaultProps=Ke.defaultProps;return c},Je=n("tPYf"),Xe={objectType:Je.b.isRequired,onCancel:h.a.func.isRequired,replyEngagementId:h.a.number,sender:h.a.instanceOf(J.a).isRequired,subjectId:h.a.string.isRequired},Ze=function(e){return function(t){var n=function(n){Object(d.a)(a,n);function a(t){var n;Object(s.a)(this,a);n=Object(u.a)(this,Object(l.a)(a).call(this,t));var r=t.objectType,i=t.subjectId;n.IntegrateEmailAlertContainer=Qe(e,r,i);return n}Object(c.a)(a,[{key:"renderIntegrateEmailAlert",value:function(t){var n=e.footerClassName,a=this.props,r=a.onCancel,i=a.replyEngagementId,o=this.IntegrateEmailAlertContainer;return Object(p.jsx)(ge,{className:n,onClick:r,showFooter:!!i,children:Object(p.jsx)(o,{use:t})})}},{key:"render",value:function(){var e=Object(ue.j)(this.props.sender);return e?this.renderIntegrateEmailAlert(e):Object(p.jsx)(t,Object.assign({},this.props))}}]);return a}(f.Component);n.propTypes=Xe;return n}},$e=n("nDpY"),et=n.n($e),tt={isJitaUser:h.a.func.isRequired,onCancel:h.a.func.isRequired,replyEngagementId:h.a.number,sender:h.a.instanceOf(J.a).isRequired},nt=function(e){return function(t){var n={isJitaUser:e.isJitaUser},a=function(n){Object(d.a)(a,n);function a(){Object(s.a)(this,a);return Object(u.a)(this,Object(l.a)(a).apply(this,arguments))}Object(c.a)(a,[{key:"renderInvalidUserMessage",value:function(){var t=e.footerClassName,n=e.JitaMessageComponent,a=this.props,r=a.isJitaUser,i=a.onCancel,o=a.replyEngagementId;return r()?n?Object(p.jsx)(ge,{className:t,onClick:i,showFooter:!!o,children:Object(p.jsx)(n,{consoleMessage:"Email sender addresses are established from a user's connected accounts. Because you are logged in with JITA, there is are no connected accounts available.",className:"m-all-8",children:"Emailing is not available when logged in with JITA."})}):Object(p.jsx)(ge,{className:t,onClick:i,showFooter:!!o}):null}},{key:"renderNoAliasesAlert",value:function(){return Object(p.jsx)(U.a,{className:"m-all-3",titleText:Se.a.text("customerDataCommunicator.Communicator.Email.interaction.problem.invalidUser.title"),type:"danger",children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.interaction.problem.invalidUser.description",options:{portalId:et.a.get()}})})}},{key:"render",value:function(){var e=this.props,n=e.isJitaUser,a=e.sender;return n()?this.renderInvalidUserMessage():a.aliasEmailAddresses.count()?Object(p.jsx)(t,Object.assign({},this.props)):this.renderNoAliasesAlert()}}]);return a}(f.Component);a.propTypes=tt;a.defaultProps=n;return a}},at=n("UMxk"),rt=n("37ae"),it=n.n(rt),ot=n("t6nY"),st=n.n(ot),ct=n("SYgn"),ut=n.n(ct),lt=n("9f1P"),dt=n.n(lt),pt=n("RRvD"),mt=n("bC4p"),ht=n("gTuk"),ft=n("/sC9"),gt=n("Ly8s"),bt=function(e){R()("string"==typeof e,'UserSettingsActions: Argument "key" must be of type String (got `%s`)',typeof e)};function Ot(e,t){bt(e);var n=ft.a.get(e);return Object(mt.a)({operation:function(){return ht.b(e,t)},commit:[pt.pc,{key:e,value:t}],rollback:[pt.qc,{key:e,value:n}]})}var vt=n("qL+2"),jt=n("Tqy5"),St=n("MQNR"),yt=n("bn2T"),Ct=n("kEfQ"),Et=n("omic"),Tt=n.n(Et),It=n("eVil"),Rt=n.n(It),At=n("ihRn"),Nt=n("ufkj"),xt=n("N7iy");function Lt(e,t){t.text=t.text||t.url;var n=e.contentMediator.draft,a=n.Modifier,r=n.EditorState,i=e.editorState.getCurrentContent(),o=e.editorState.getSelection(),s=e.editorState.getCurrentContent().createEntity("LINK","MUTABLE",t),c=s.getLastCreatedEntityKey(),u=t.text,l=!0;if(o.getStartKey()===o.getEndKey()&&!o.isCollapsed()){u=i.getBlockForKey(o.getStartKey()).getText().slice(o.getStartOffset(),o.getEndOffset());l=!1}var d=e.editorState.getCurrentInlineStyle(),p=d&&d.filter(function(e){return e&&(e.includes("background-color")||!e.includes("color"))}),m=a.replaceText(s,o,u,p,c);l&&(m=a.insertText(m,m.getSelectionAfter()," ",p,null));return{editorState:r.push(e.editorState,m,"insert-characters"),entityKey:c}}var kt=function(e){return e.replace(/\{\{\s?(?:(contact|company|custom)\.)?(\w*(?:\.\w+)*)\s?\}\}/g,"").replace(/&nbsp;/g," ")};function Mt(e){return{subject:kt(e.get("subject")),html:kt(e.get("html"))}}var _t=n("lTBm"),Dt=n("KknD"),Pt=n("xHov"),wt=n("M76c"),Bt=n("8QMF"),Ft=n.n(Bt),Ut=n("Xm7G"),qt=n("FGZp"),Gt=n("ImZw"),Vt=function(e){var t=e.editorState,n=[];t.getCurrentContent().getBlockMap().valueSeq().forEach(function(e){e.data.get("atomicType")!==Gt.a&&n.push(e)});var a=qt.ContentState.createFromBlockArray(n);return qt.EditorState.push(t,a,"remove-range")},Ht="EMAIL_BRANDING",zt="SIGNATURE",Wt=[zt,oe.a,Ht];function Kt(e){var t=Wt.indexOf(e);return t>=0&&t<Wt.length?Wt.slice(++t):null}var Yt=function(e){return Object(b.Map)({signature:e,atomicType:zt})},Qt=function(e,t,n){return e.EditorState.set(t,{allowUndo:n})},Jt=function(e,t){var n=e.EditorState,a=e.SelectionState;return n.acceptSelection(t,a.createEmpty(t.getCurrentContent().getFirstBlock().getKey()))},Xt=function(e){return new(0,e.ContentBlock)({key:(0,e.genKey)(),type:"unstyled",text:"",characterList:Object(b.List)()})},Zt=function(e){return 1===e.getCurrentContent().getBlockMap().size&&!e.getCurrentContent().getFirstBlock().getText()},$t=function(e,t){return e.getCurrentContent().getBlockMap().find(function(e){return e.data.get("atomicType")===t})},en=function(e){return $t(e,zt)},tn=function(e){return $t(e,oe.a)},nn=function(e,t){var n=e.EditorState,a=e.ContentState,r=t.getCurrentContent().getBlocksAsArray();r.push(Xt(e));r.push(Xt(e));var i=a.createFromBlockArray(r);return n.push(t,i)},an=function(e,t,n,a,r){var i=e.EditorState,o=e.SelectionState,s=t.insertAtomicBlockWithData,c=n.getCurrentContent().getLastBlock();if(r){var u=r.find(function(e){return null!=$t(n,e)});if(u){var l=$t(n,u);l&&(c=n.getCurrentContent().getBlockBefore(l.key))}}var d=c.getKey(),p=c.getLength(),m=o.createEmpty(d);m=m.merge({anchorOffset:p,focusOffset:p});n=i.forceSelection(n,m);var h=Yt(a),f=s(n,h,!0);if(!f.getUndoStack().first())return f;var g=f.getUndoStack().first().getSelectionAfter(),b=f.getCurrentContent().set("selectionBefore",g);return i.set(n,{currentContent:b})},rn=function(e,t,n,a){return(0,e.changeBlockData)({editorState:t,block:n,updatedBlockData:a})},on=function(e,t){var n=e.EditorState,a=e.ContentState,r=[];t.getCurrentContent().getBlockMap().valueSeq().forEach(function(e){e.data.get("atomicType")!==zt&&r.push(e)});var i=a.createFromBlockArray(r);return n.push(t,i,"remove-range")},sn=function(e){var t=e.get("linkType");return t&&t!==oe.b},cn=function(e,t,n,a){return(0,e.changeBlockData)({editorState:t,block:n,updatedBlockData:a})};function un(e,t){var n=e.contentMediator,a=n.draft,r=n.utils,i=e.signature,o=en(t);if(!i)return o?on(a,t):t;if(o)return rn(r,t,o,Object(b.Map)({signature:i}));t=Qt(a,t,!1);Zt(t)&&(t=nn(a,t));t=an(a,r,t,i,Kt(zt));t=Jt(a,t);return t=Qt(a,t,!0)}function ln(e,t){var n=e.contentMediator.draft;return e.signature?on(n,t):t}function dn(e,t){var n=e.contentMediator,a=n.draft,r=n.utils,i=e.unsubscribeLinkData,o=tn(t);if(!sn(i))return o?Vt({editorState:t}):t;if(o)return cn(r,t,o,i);t=Qt(a,t,!1);t=Object(Ut.a)({editorState:t,data:i.toJS()});t=Jt(a,t);return t=Qt(a,t,!0)}function pn(e,t){var n=e.unsubscribeLinkData;return sn(n)?Vt({editorState:t}):t}function mn(e){return!!e&&Object.keys(e).map(function(t){return e[t]}).filter(function(e){return null!=e.inTrial}).length>0}var hn=function(e){return Object(b.Map)({emailBranding:e,atomicType:Ht})},fn=function(e,t,n){return e.EditorState.set(t,{allowUndo:n})},gn=function(e,t){var n=e.EditorState,a=e.SelectionState;return n.acceptSelection(t,a.createEmpty(t.getCurrentContent().getFirstBlock().getKey()))},bn=function(e){return new(0,e.ContentBlock)({key:(0,e.genKey)(),type:"unstyled",text:"",characterList:Object(b.List)()})},On=function(e){return 1===e.getCurrentContent().getBlockMap().size&&!e.getCurrentContent().getFirstBlock().getText()},vn=function(e,t){return e.getCurrentContent().getBlockMap().find(function(e){return e.data.get("atomicType")===t})},jn=function(e){return vn(e,Ht)},Sn=function(e,t){var n=e.EditorState,a=e.ContentState,r=t.getCurrentContent().getBlocksAsArray();r.push(bn(e));r.push(bn(e));var i=a.createFromBlockArray(r);return n.push(t,i)},yn=function(e,t,n,a){var r=e.EditorState,i=e.SelectionState,o=t.insertAtomicBlockWithData,s=n.getCurrentContent().getLastBlock(),c=s.getKey(),u=s.getLength(),l=i.createEmpty(c);l=l.merge({anchorOffset:u,focusOffset:u});return o(n=r.forceSelection(n,l),hn(a),!0)},Cn=function(e,t,n,a){return(0,e.changeBlockData)({editorState:t,block:n,updatedBlockData:a})},En=function(e,t){var n=e.EditorState,a=e.ContentState,r=[];t.getCurrentContent().getBlockMap().valueSeq().forEach(function(e){e.data.get("atomicType")!==Ht&&r.push(e)});var i=a.createFromBlockArray(r);return n.push(t,i,"remove-range")};function Tn(e,t){var n=e.contentMediator,a=n.draft,r=n.utils,i=e.emailBranding,o=e.renderEmailBranding,s=e.isPaidHub,c=mn(e.trialState);if(!s&&!c&&o&&o()){var u=jn(t);if(!i)return u?En(a,t):t;if(u)return Cn(r,t,u,Object(b.Map)({emailBranding:i}));t=fn(a,t,!1);On(t)&&(t=Sn(a,t));t=yn(a,r,t,i);t=gn(a,t);return t=fn(a,t,!0)}return t}function In(e,t){var n=e.contentMediator.draft,a=e.emailBranding,r=e.renderEmailBranding,i=e.isPaidHub,o=mn(e.trialState);return!i&&!o&&r&&r()&&a?En(n,t):t}function Rn(e,t){return Ft()(Ne()(un,e),Ne()(dn,e),Ne()(Tn,e))(t)}function An(e,t){return Ft()(Ne()(ln,e),Ne()(pn,e),Ne()(In,e))(t)}var Nn=n("W2dw"),xn=n("9J8I"),Ln=n("8ctk"),kn=n.n(Ln),Mn=n("E7+s"),_n=n("yTm7"),Dn=n("5mx2"),Pn=n("0dUV"),wn=n("Eha6"),Bn="{{ unsubscribe_link }}",Fn="sales-email-signature/v1/signatures/render",Un=function(e){return Object(Pt.d)(Fn,{emails:[e],signatureHtml:Bn}).then(function(e){return e.get("renderedSignature")})},qn=Object(wn.a)(Un,"EmailUnsubscribeLinkRenderingAPI.fetchRenderedLink");Object(Pn.b)({namespace:Dn.h,fetch:qn});var Gn=Object(Pn.a)({namespace:Dn.h,idIsValid:function(e){return"string"==typeof e}}).defineName("EmailUnsubscribeLinkStore").register(o.a),Vn={stores:[Gn],deref:function(e){var t=e.emailAddress;return Gn.get(t)}},Hn=Object(_n.a)(Vn),zn=kn()(function(e){return e.startsWith("email=")}),Wn=function(e){var t=e.split("?"),n=zn(t[1].split("&"));return t[0]+"?"+n.join("&")},Kn=function(e){return e.to.size+e.cc.size+e.bcc.size>1},Yn=function(e){return Promise.reject({message:"customerDataCommunicator.Email.renderer.errors.unsubscribeLink",options:{emailAddress:e}})},Qn=function(e,t){return e.replace(Gt.d,t)},Jn=function(e){var t=e.get("to").get(0);return Hn({emailAddress:t}).then(function(n){if(Object(Mn.c)(n))return Yn(t);Kn(e)&&(n=Wn(n));return e.set("html",Qn(e.html,n))},Ne()(Yn,t))},Xn=function(e,t){var n=e.EmailActions,a=n.sendEmail,r=n.sendEmailUsingHubSpot,i=n.sendReplyEmail,o=n.scheduleEmail,s=e.associations,c=e.source,u=e.when,l=e.replyId,d=e.isHubSpotHosted,p=e.recommendedSendTimeId,m=e.isShared;return u?o(t,u,s,{source:c},l,p):!l||d||m?d||m?r(t,{source:c}):a(t,s,{source:c}):i(t,s,l,{source:c})},Zn=function(e){return e!==oe.b},$n=function(e){var t=e.email,n=e.unsubscribeLinkType;return Zn(n)?Jn(t):Promise.resolve(t)},ea=function(e){var t=e.onSendError,n=e.onSendSuccess,a=Ne()(Xn,e);return $n(e).then(a).then(n,t).done()},ta=Ie()(function(){return{open:!1}}),na=Ie()(function(){return{placement:"top",use:"longform",headingText:Se.a.text("customerDataCommunicator.Communicator.Email.tooltips.trackingTitle"),title:Se.a.text("customerDataCommunicator.Communicator.Email.tooltips.isTracked"),onClose:null}}),aa=Ie()(function(){return{placement:"bottom",title:Se.a.text("customerDataCommunicator.Communicator.Email.tooltips.mandatoryFields")}}),ra=Ie()(function(){return{open:!0,placement:"left",title:Se.a.text("customerDataCommunicator.Communicator.Email.integrateEmail.tooltips.chooseAnotherAddress")}}),ia=Ie()(function(){return{placement:"bottom",title:Se.a.text("customerDataCommunicator.Communicator.Email.tooltips.noRecipient")}}),oa=Ie()(function(){return{placement:"bottom",title:Se.a.text("customerDataCommunicator.Communicator.Email.tooltips.invalidAttachments")}}),sa=Ie()(function(){return{placement:"bottom",title:Se.a.text("customerDataCommunicator.Communicator.Email.tooltips.invalidEmailAddress")}}),ca=Ie()(function(){return{placement:"bottom",title:Se.a.text("customerDataCommunicator.Communicator.Email.tooltips.unDeliverableEmailAddress")}}),ua=Ie()(function(){return{open:!0,placement:"left",title:Se.a.text("customerDataCommunicator.Communicator.Email.tooltips.noContacts")}}),la=n("a7/P"),da=n("3Yd4"),pa=n("vuW9");function ma(e,t){return e?Object(p.jsx)(da.a,{name:e}):t?Object(p.jsx)(ee.a,{message:t}):null}var ha=Object(f.memo)(function(e){var t=e.tooltip,n=e.tooltipPlacement,a=e.onClick,r=e.icon,i=e.messageKey;return Object(p.jsx)(pa.a,{disabled:!t,title:t,placement:n,children:Object(p.jsx)(q.a,{onClick:a,children:ma(r,i)})})});function fa(e){var t=function(t){Object(d.a)(n,t);function n(){var t,a;Object(s.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];(a=Object(u.a)(this,(t=Object(l.a)(n)).call.apply(t,[this].concat(i)))).handleClick=function(){var t=a.props.closePopover;if(e.onClick){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.onClick.apply(Object(at.a)(a),r)}t&&t()};return a}Object(c.a)(n,[{key:"render",value:function(){var t=e.icon,n=e.tooltip,a=e.tooltipPlacement,r=void 0===a?"bottom":a,i=e.onClick,o=e.messageKey;return Object(p.jsx)(ha,{tooltip:n,placement:r,onClick:i,icon:t,messageKey:o})}}]);return n}(f.Component);t.propTypes={closePopover:h.a.func};return t}function ga(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(la.createPlugin)({displayName:"ToolbarActionPlugin",buttons:fa(e)})}var ba=Object(p.jsx)(ee.a,{message:"customerDataCommunicator.SignatureActionPlugin.tooltip"}),Oa=function(e){return ga(Object.assign({icon:"signature",tooltip:ba,tooltipPlacement:"top"},e))},va=function(e,t,n){var a=t.passthruRtePlugins,r=t.gates,i=n.handleSignatureChange,o=n.handleDeleteBrandingBanner,s=n.handleMountBrandingBanner,c=n.handleEditSignaturePluginButton,u=n.handleEditSignatureInline,l=e.SignaturePlugin,d=e.EmailBrandingPlugin,p=e.SignatureUnsubscribePlugin,m=Object(b.List)(),h=a;if(l){m=m.push(l({onSignatureSaved:i,allowEditing:!0,gates:r,onClick:u}));h=h.extendPluginGroupConfig({signature:{callback:c,plugin:Oa({tooltipPlacement:"top",onClick:c})}})}p&&(m=m.push(p));d&&(m=m.push(d({onMountBanner:s,onDeleteBanner:o})));return h.concatPlugins(m)},ja={emailIntegrations:Object(ye.iterableOf)(h.a.string.isRequired).isRequired};function Sa(e){var t=function(){return null};t.propTypes=ja;var n=function(n){return e?Object(p.jsx)(e,Object.assign({},n)):Object(p.jsx)(t,Object.assign({},n))};n.propTypes=ja;return n}var ya=n("sSdB"),Ca=function(e){var t=e.sendConfirmationEmail;return function(e){Object(d.a)(n,e);function n(){var e;Object(s.a)(this,n);(e=Object(u.a)(this,Object(l.a)(n).call(this))).handleClickResend=function(){e.setState({isSendingEmail:!0});t().then(function(){e.setState({emailWasSent:!0,emailSendError:!1})}).catch(function(){e.setState({isSendingEmail:!1,emailSendError:!0})})};e.handleCloseErrorMessage=function(){e.setState({emailSendError:!1})};e.state={isSendingEmail:!1,emailWasSent:!1,emailSendError:!1};return e}Object(c.a)(n,[{key:"renderVerifyMessage",value:function(){return this.state.emailWasSent?null:Object(p.jsx)(U.a,{type:"warning",children:Object(p.jsxs)("div",{className:"m-y-4",children:[Object(p.jsx)("h5",{children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.verifyEmail.title"})}),Object(p.jsx)("p",{children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.verifyEmail.description"})}),this.renderResendButton(),this.renderLoadingState()]})})}},{key:"renderErrorMessage",value:function(){return this.state.emailSendError?Object(p.jsx)(U.a,{type:"danger",closeable:!0,onClose:this.handleCloseErrorMessage,className:"m-bottom-4",children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.verifyEmail.error"})}):null}},{key:"renderSuccessMessage",value:function(){return this.state.emailWasSent?Object(p.jsx)(U.a,{type:"success",children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.verifyEmail.resent"})}):null}},{key:"renderLoadingState",value:function(){return this.state.isSendingEmail?Object(p.jsx)(Q.a,{grow:!1}):null}},{key:"renderResendButton",value:function(){return this.state.isSendingEmail?null:Object(p.jsx)(q.a,{use:"primary",size:"small",onClick:this.handleClickResend,children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.verifyEmail.resend"})})}},{key:"render",value:function(){return Object(p.jsxs)(ya.a,{className:"m-top-2 m-bottom-8",children:[this.renderSuccessMessage(),this.renderErrorMessage(),this.renderVerifyMessage()]})}}]);return n}(xe.a)},Ea=n("cHKa"),Ta=n("c2Nv"),Ia=n("duMR"),Ra=n("+tDt"),Aa=n("B1aM"),Na=n("fFSu"),xa=n("kZyb"),La=n("fwDr"),ka=dt.a.li.withConfig({displayName:"SenderOption__Item",componentId:"ugin9u-0"})([".is--text--help{margin-top:-9px;}"]),Ma=function(e){Object(d.a)(t,e);function t(){Object(s.a)(this,t);return Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.option,a=Object(Na.a)(e,["children","option"]);if(n.disabledReason){var r=n.disabledReason,i=r.langBasePath,o=r.href,s=r.accountId;return Object(p.jsx)("li",Object.assign({},a,{children:Object(p.jsxs)("div",{className:"display-flex",children:[Object(p.jsxs)(q.a,{use:"transparent",className:"text-left m-left-2",disabled:!0,children:[Object(p.jsx)(La.a,{children:n.text}),Object(p.jsx)(xa.a,{className:"display-block m-left-0 m-top-1",children:Object(p.jsx)(La.a,{children:Object(p.jsx)(F.a,{message:i+".info",options:{accountId:s}})})})]}),Object(p.jsx)("div",{children:Object(p.jsx)(pa.a,{title:Object(p.jsx)(F.a,{message:i+".tooltip"}),children:Object(p.jsx)(q.a,{use:"tertiary-light",size:"small",className:"m-top-3 m-right-3",href:o,children:Object(p.jsx)(F.a,{message:i+".button"})})})})]})}))}return Object(p.jsx)(ka,Object.assign({},a,{children:t}))}}]);return t}(f.PureComponent);Ma.propTypes={children:h.a.node.isRequired,className:h.a.string,onMouseEnter:h.a.func,option:h.a.shape({value:h.a.string.isRequired,text:h.a.string.isRequired,disabled:h.a.bool.isRequired,disabledReason:h.a.shape({langBasePath:h.a.string.isRequired,href:h.a.string.isRequired,accountId:h.a.string}),help:h.a.string}).isRequired};var _a=n("qO7I"),Da="customerDataCommunicator.Communicator.Email.alias",Pa=function(e){if(Be.a.get("EmailSettingsMigration")){var t=e.get("inboxId");return t?Object(_a.d)({inboxId:t}):"/settings/"+et.a.get()+"/user-preferences/email"}return"/crm-settings-email/"+et.a.get()+"/email"},wa=N()(function(e){return e.map(function(e){var t,n=e.get("disabled"),a=e.get("conversationsInboxName"),r=e.get("address").toLowerCase()===e.get("accountId").toLowerCase(),i=n?null:a;n&&(t={langBasePath:r?Da+".GENERIC_MAIN":Da+".GENERIC_ALIAS",href:Pa(e),accountId:e.get("accountId")});r||n||(i=a?Se.a.text(Da+".ENABLED_INBOX",{accountId:e.get("accountId"),inboxName:a}):Se.a.text(Da+".ENABLED",{accountId:e.get("accountId")}));return{text:e.displayableAddress,value:e.getAddressId(),disabled:!!n,disabledReason:t,help:i}})}),Ba={aliasOptions:{stores:[Be.a],deref:function(e){return e.sender&&e.sender.aliasEmailAddresses?wa(e.sender.aliasEmailAddresses):Object(b.Seq)()}}},Fa={allowSenderChange:h.a.bool.isRequired,aliasOptions:h.a.oneOfType([Ce.a.seq,Ce.a.set]),from:h.a.instanceOf(Ta.a).isRequired,onChange:h.a.func.isRequired,sender:h.a.instanceOf(J.a).isRequired,renderSenderWarning:h.a.func.isRequired},Ua={renderSenderWarning:T.a,allowSenderChange:!0},qa=function(e){Object(d.a)(t,e);function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).handleAddressChange=function(e){var t=e.target.value;n.props.onChange(t)};return n}Object(c.a)(t,[{key:"renderSenderFromAddress",value:function(e){var t=e.sendAsAddress||e.address;return Object(p.jsx)("span",{className:"sender-input",children:t})}},{key:"renderSenderAddressSelect",value:function(e,t){var n=this.props.aliasOptions;return Object(p.jsx)(Ra.a,{className:"sender-input",itemComponent:Ma,onChange:this.handleAddressChange,options:n.toArray(),defaultValue:t.address,value:t.addressId,buttonUse:"link",menuWidth:400})}},{key:"renderSenderAddress",value:function(e,t){var n=this.props.allowSenderChange;return 1!==e.aliasEmailAddresses.size&&n?this.renderSenderAddressSelect(e,t):this.renderSenderFromAddress(t)}},{key:"renderSenderLabel",value:function(){var e,t=this.props,n=t.sender,a=t.from;a.hasName()?e=a.getFriendlyName(it.a):n.from.hasName()&&(e=n.from.getFriendlyName(it.a));return e?Object(p.jsxs)("span",{"data-selenium-test":"communicator-from-address",children:[e+" ",Object(p.jsxs)("small",{children:["(",this.renderSenderAddress(n,a),")"," ",this.props.renderSenderWarning()]})]}):Object(p.jsxs)("span",{children:[this.renderSenderAddress(n,a),this.props.renderSenderWarning()]})}},{key:"render",value:function(){return Object(p.jsxs)("div",{className:"p-y-2",children:[Object(p.jsx)(Aa.a,{className:"p-y-0",children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.sender.from"})}),this.renderSenderLabel()]})}}]);return t}(f.Component);qa.propTypes=Fa;qa.defaultProps=Ua;var Ga=Object(i.connect)(Ba,o.a)(qa),Va=n("V4AE"),Ha=n("soyi"),za=n("JyZI"),Wa=n("021V"),Ka={className:h.a.string,onChange:h.a.func.isRequired,value:h.a.string},Ya=function(e){Object(d.a)(t,e);function t(e){var n;Object(s.a)(this,t);(n=Object(u.a)(this,Object(l.a)(t).call(this))).handleChange=function(e){var t=e.target.value;n.setState({value:t});return n.props.onChange(t)};n.state={value:e.value};return n}Object(c.a)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.state.value!==e.value&&this.setState({value:e.value})}},{key:"render",value:function(){var e=this.props.className,t=st()("subject input p-all-0 display-inline-block",e);return Object(p.jsxs)(za.a,{className:"p-y-2 crm-light-border-bottom",children:[Object(p.jsx)(Ha.a,{children:Object(p.jsx)(Aa.a,{className:"p-y-0 display-inline-block",children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.subject.label"})})}),Object(p.jsx)(Wa.a,{children:Object(p.jsx)(Va.a,{autoFocus:!this.state.value,className:t,"data-selenium-test":"email-subject-input",styled:!1,value:this.state.value,onChange:this.handleChange,placeholder:null,style:{height:"auto",fontSize:14}})})]})}}]);return t}(xe.a);Ya.propTypes=Ka;var Qa=Ya,Ja=n("eP/i"),Xa=function(e){var t=e.address,n=e.className,a=e.name;return a&&t?Object(p.jsx)(ee.a,{className:n,message:"customerDataCommunicator.Communicator.Email.address",options:{name:a,address:t}}):Object(p.jsx)("span",{className:n,children:a||t})};Xa.propTypes={address:h.a.string.isRequired,className:h.a.string,name:h.a.string};var Za=Xa,$a=n("dxYZ"),er=n("leqx"),tr=n("Iie8"),nr=n.n(tr),ar=n("hkFy"),rr=n("DSKb"),ir=n("nkcb"),or={allowCreate:h.a.bool.isRequired,allowCreateTextFn:h.a.func.isRequired,defaultOptions:h.a.arrayOf(h.a.shape({key:h.a.string,value:h.a.string,objectType:h.a.string})),defaultValues:h.a.arrayOf(h.a.string),multi:h.a.bool.isRequired,onAdd:h.a.func.isRequired,onBlur:h.a.func.isRequired,onChange:h.a.func.isRequired,onRemove:h.a.func.isRequired,placeholder:h.a.oneOfType([h.a.string,h.a.bool]),resolver:h.a.shape({search:h.a.func.isRequired}).isRequired,resolverSearchProps:h.a.object.isRequired,relatedContacts:h.a.arrayOf(h.a.shape({text:h.a.string,value:h.a.string,record:h.a.object})),value:h.a.string,valueRenderer:h.a.func,disableResultsWhenNoSearchText:h.a.bool},sr={allowCreate:!1,allowCreateTextFn:function(e){return e},autoFocus:!0,minimumSearchCount:0,multi:!1,onBlur:T.a,resolverSearchProps:{},value:void 0},cr=function(e){Object(d.a)(t,e);function t(){var e;Object(s.a)(this,t);(e=Object(u.a)(this,Object(l.a)(t).call(this))).handleBlur=function(){e.props.onBlur()};e.handleClose=function(){e.setState({searchText:"",matches:void 0})};e.handleMultiSelectChange=function(t){var n=t.target.value;if(n.length<e.selectedOptions.length){var a=e.selectedOptions.findIndex(function(e){return-1===n.indexOf(e.value)});-1!==a&&e.props.onRemove(e.selectedOptions[a].value)}else{var r=n[n.length-1];e.props.onAdd(r)}};e.handleChange=function(t){var n=t.target.value;e.props.onChange(n)};e.handleMatches=function(t){if(Object(ir.c)(t)){var n=Rt()("results",t);n=nr()(function(e){return e.referencedObject},n).toJS();e.setState({matches:n})}};e.handleInputChange=function(t){if(e.atom){Object(ar.unwatch)(e.atom,e.handleMatches);delete e.atom}e.setState({searchText:t,matches:void 0});if(t){var n=e.props,a=n.resolver,r=n.resolverSearchProps,i=n.value,o=Object.assign({query:t,count:1/0,offset:0,value:i},r);e.atom=a.search(o);var s=Object(ar.deref)(e.atom);s&&e.handleMatches(s);Object(ar.watch)(e.atom,e.handleMatches)}};e.partial=N()(Ne.a);e.state={searchText:"",matches:void 0};return e}Object(c.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.selectedOptions=this.props.defaultOptions||[];this.defaultValue=this.props.defaultValues||[];this.searchResults=[]}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.selectedOptions=e.defaultOptions||[];this.defaultValue=e.defaultValues||[]}},{key:"componentWillUnmount",value:function(){this.atom&&Object(ar.unwatch)(this.atom,this.handleMatches)}},{key:"getResultsText",value:function(){var e=this.state,t=e.searchText,n=e.matches;if(!n){var a=t?"customerDataObjectsUiComponents.Association.searching":"customerDataObjectsUiComponents.Association.start";return Se.a.text(a)}if(0===n.length&&t)return Se.a.text("customerDataObjectsUiComponents.Association.noResults")}},{key:"getOptions",value:function(){var e=this,t=this.props,n=t.allowCreate,a=t.allowCreateTextFn,r=t.relatedContacts,i=this.state,o=i.searchText,s=i.matches;this.searchResults=s||[];if(!n)return this.searchResults;s&&0===s.length&&o&&this.searchResults.push({text:a(o),value:o});0===this.searchResults.length&&r&&(this.searchResults=r);this.selectedOptions&&this.selectedOptions.length&&this.selectedOptions.forEach(function(t){t.isValid||(t.tagUse="error");e.searchResults.push(t)});return this.searchResults}},{key:"resolveOption",value:function(e){return this.selectedOptions.find(function(t){return t.value===e.value})||e}},{key:"render",value:function(){var e=this,t=this.props,n=t.valueRenderer,a=Object(Na.a)(t,["valueRenderer"]),r=this.state.searchText,i={};this.props.multi||(i.value=null);n&&(i.valueRenderer=this.props.multi?function(t){return n(e.resolveOption(t))}:n);this.props.disableResultsWhenNoSearchText&&(i.open=!!r);return Object(p.jsx)(rr.a,Object.assign({},a,{allowCreate:!1,noResultsText:this.getResultsText(),onBlur:this.handleBlur,onChange:this.props.multi?this.handleMultiSelectChange:this.handleChange,onClose:this.handleClose,onInputChange:this.handleInputChange,options:this.getOptions(),placeholder:this.props.placeholder,value:this.props.defaultValues},i))}}]);return t}(xe.a);cr.propTypes=or;cr.defaultProps=sr;var ur=cr,lr=n("A97v"),dr=function(e){var t=e.type,n=e.source,a=e.hideOptionAvatar,r=e.hideValueAvatar;return function(e){var i=e.className;if(e.option){e=e.option}var o,s=e,c=s.text,u=s.email,l=s.domain,d=s.objectType,m=s.defaultImage,h=s.record,f=s.alertIcon;![St.CONTACT,St.COMPANY].includes(d)||"option"===t&&a||"value"===t&&r||(o=Object(p.jsx)(lr.default,{objectType:d,email:u,domain:l,defaultImage:m,size:"xs",source:"avatar-select-"+n,className:"align-baseline m-right-2",object:h}));var g="association-select-search-option"===n,b=st()("align-center",i,"option"===t&&(g?"p-all-2":"p-left-8 p-right-2 p-y-2"));return Object(p.jsxs)("span",{className:b,children:[o,Object(p.jsx)("span",{className:"truncate-text",title:c,"data-selenium-test":u,children:c}),f]})}},pr=function(e){var t="error"===e?"warning":"info";return Object(p.jsx)(da.a,{name:t,size:"xxs",style:{marginLeft:4}})},mr={align:h.a.string,avatarSelectRenderer:h.a.func,hideValueAvatar:h.a.bool,hideOptionAvatar:h.a.bool,multi:h.a.bool,multiCollapseLimit:h.a.number,objectType:er.a.isRequired,onCancelSearch:h.a.func,placeholder:h.a.oneOfType([h.a.string,h.a.bool]),resolver:h.a.shape({search:h.a.func.isRequired}).isRequired,filterFunc:h.a.func,onOpen:h.a.func},hr={align:"right",avatarSelectRenderer:dr,multi:!0,multiCollapseLimit:3,objectType:St.CONTACT,onCancelSearch:T.a,hideValueAvatar:!0,placeholder:!1},fr=function(e){if(e)return e.map(function(e){var t=e.record;return t?Object.assign({},e,{email:Object($a.d)(t,"email"),domain:Object($a.d)(t,"domain"),objectType:Object($a.c)(t)}):e})},gr=function(e){Object(d.a)(t,e);function t(){Object(s.a)(this,t);return Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}Object(c.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){var e=this.props,t=e.avatarSelectRenderer,n=e.hideValueAvatar,a=e.hideOptionAvatar;if(t){var r=t({type:"option",source:"association-select-search-option",hideOptionAvatar:a});this.itemComponent=function(e){return e&&"__MULTI_DUMMY_OPTION__"===e["data-option-value"]?Object(p.jsx)("span",{className:"p-left-2",children:Se.a.text("customerDataObjectsUiComponents.Association.start")}):r(e)};var i=t({type:"value",source:"association-select-search-value",hideValueAvatar:n});this.valueRenderer=function(e){var t,n=e.alert;if(n){var a=n.type,r=n.message;e.alertIcon=pr(a);t=r||Se.a.text("invalidValue")}var o=Object(p.jsxs)("div",{children:[Object(p.jsxs)("div",{children:[" ",e.email," "]}),t]});return Object(p.jsx)(pa.a,{title:o,children:Object(p.jsxs)("span",{children:[" ",i(e)," "]})})}}}},{key:"render",value:function(){var e={objectType:this.props.objectType,parseFn:fr};return Object(p.jsx)(ur,Object.assign({itemComponent:this.itemComponent,placeholder:this.props.placeholder,resolverSearchProps:e,valueRenderer:this.valueRenderer},this.props))}}]);return t}(xe.a);gr.propTypes=mr;gr.defaultProps=hr;var br=gr,Or="/engagements-emails/v1/blacklist",vr=function(){return Object(Pt.c)(""+Or,{portalId:et.a.get()}).then(function(e){return Object(b.Map)({neverlogList:e})})};Object(Pn.b)({namespace:"NEVER_LOG",fetch:function(){return vr()}});var jr=Object(Pn.a)({namespace:"NEVER_LOG",idIsValid:function(e){return"neverlogList"===e}}).defineName("NeverLogStore").register(o.a),Sr={allowCreate:h.a.bool.isRequired,autoFocus:h.a.bool,contacts:h.a.shape({get:h.a.func.isRequired}).isRequired,deliverability:h.a.instanceOf(b.Map).isRequired,disabled:h.a.bool,maxSelectable:h.a.number.isRequired,onRemoved:h.a.func.isRequired,onSelected:h.a.func.isRequired,owners:h.a.shape({has:h.a.func.isRequired,get:h.a.func.isRequired}).isRequired,resolver:h.a.shape({search:h.a.func.isRequired}).isRequired,relatedContacts:h.a.arrayOf(h.a.shape({text:h.a.string,value:h.a.string,record:h.a.instanceOf(b.Record)})),selected:Object(ye.iterableOf)(Ea.a).isRequired,onOpen:h.a.func,neverLogList:Ce.a.list,emailSelectRef:h.a.object,showNeverLogWarning:h.a.bool.isRequired},yr={disabled:!1,allowCreate:!0,maxSelectable:100,selected:Object(b.List)(),neverLogList:Object(b.List)(),showNeverLogWarning:!0},Cr=function(e){Object(d.a)(t,e);function t(e){var n;Object(s.a)(this,t);(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleSelect=function(e){var t=n.props,a=t.contacts,r=t.owners,i=Object(Dt.e)(a,r,e);n.props.onSelected(i,Object(Dt.l)(e))};n.handleRemove=function(e){var t=n.props,a=t.contacts,r=t.owners,i=Object(Dt.e)(a,r,e);n.props.onRemoved(i)};n.partial=N()(Ne.a);return n}Object(c.a)(t,[{key:"allowCreateTextFn",value:function(e){return e}},{key:"getSelectedValues",value:function(){var e=this.getSelectedOptions();return 0===e.length?[]:e.map(function(e){return e.value})}},{key:"getRecipientAlerts",value:function(e){var t,n=this.props,a=n.deliverability,r=n.showNeverLogWarning,i=function(e,t){return{type:e,message:Se.a.text("customerDataCommunicator.Communicator.Email.validation."+t)}};Object(ue.e)(e)?Object(ue.c)(e,a)?r&&Object(ue.d)(this.props.neverLogList,e)&&(t=i("info","neverlogEmail")):t=i("error","unDeliverable"):t=i("error","invalidEmail");return t}},{key:"getSelectedOptions",value:function(){var e=this,t=this.props.selected;return t.isEmpty()?[]:t.map(function(t){var n=t.get("to"),a=n.get("address"),r=n.get("id"),i=n.get("firstName")?""+n.fullName(it.a):a,o=r?e.props.owners.has(r.toString())?Object(Dt.p)(r):Object(Dt.m)(r,a):a,s=e.getRecipientAlerts(a);return{record:t,objectType:St.CONTACT,email:a,text:i,value:o,tagUse:s&&"error"===s.type?"error":void 0,isValid:!0,alert:s}}).toArray()}},{key:"getRelatedContacts",value:function(){var e=this.props.relatedContacts;if(!e)return[];var t=Object(b.Set)(this.getSelectedValues());return e.filter(function(e){return!t.has(e.value)}).map(function(e){var t=e.record,n=e.value,a=e.text,r=Object(Dt.n)(n).emailAddress;return{record:t,objectType:St.CONTACT,email:r,text:a,value:n}})}},{key:"renderSearch",value:function(){var e=this.props,t=e.allowCreate,n=e.autoFocus,a=e.disabled,r=e.maxSelectable,i=e.resolver,o=e.selected,s={color:"#cbd6e2",fontSize:"14px"},c=Se.a.text("customerDataCommunicator.Communicator.Email.recipients.enterEmail");return o.size>=r?null:Object(p.jsx)(br,{allowCreate:t,allowCreateTextFn:this.allowCreateTextFn,disabled:a,onChange:this.handleSelect,onAdd:this.handleSelect,onRemove:this.handleRemove,resolver:i,relatedContacts:this.getRelatedContacts(),defaultOptions:this.getSelectedOptions(),defaultValues:this.getSelectedValues(),autoFocus:n,onOpen:this.props.onOpen,placeholder:c,style:s,ref:this.props.emailSelectRef})}},{key:"render",value:function(){return Object(p.jsx)("div",{className:"recipientSelect","data-selenium-test":"recipient-select",children:this.renderSearch()})}}]);return t}(xe.a);Cr.propTypes=Sr;Cr.defaultProps=yr;var Er=Object(i.connect)({neverLogList:{stores:[jr],deref:function(){return jr.get("neverlogList")}}},o.a)(Cr),Tr={toList:Object(ye.listOf)(Ea.a),bccList:Object(ye.listOf)(Ea.a).isRequired,ccList:Object(ye.listOf)(Ea.a).isRequired,className:h.a.string,contacts:h.a.shape({get:h.a.func.isRequired}).isRequired,deliverability:h.a.instanceOf(b.Map).isRequired,disabledRecipientFields:Object(ye.setOf)(h.a.oneOf([_t.c,_t.b,_t.a])),makeContactSearchSelect:h.a.func.isRequired,onRecipientChange:h.a.func.isRequired,owners:h.a.shape({get:h.a.func.isRequired}).isRequired,recipient:h.a.instanceOf(Ea.a),recipientResolverFactory:h.a.instanceOf(Ia.a).isRequired,relatedContacts:h.a.arrayOf(h.a.shape({text:h.a.string,value:h.a.string,record:h.a.instanceOf(b.Record)})),sendToType:h.a.oneOf([xn.a,xn.b,xn.c]).isRequired,showCopyTo:h.a.bool.isRequired,showDeliverabilityWarning:h.a.bool.isRequired,showNeverLogWarning:h.a.bool.isRequired,subjectId:h.a.string.isRequired,onOpen:h.a.func,emailSelectRef:h.a.object},Ir={disabledRecipientFields:Object(b.Set)(),showNeverLogWarning:!0},Rr=function(e){return Object(b.Seq)(e.to.hasAddress()?[e]:[])},Ar=function(e){Object(d.a)(t,e);function t(e){var n;Object(s.a)(this,t);(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleSendToChange=function(e){var t=n.props,a=t.onRecipientChange,r=t.contacts,i=t.owners,o=n.state.sendToInitialized;e&&a(_t.c,!0,Object(Dt.e)(r,i,e));o||n.setState({sendToInitialized:!0})};n.handleFixedSendToChange=function(e){var t=e.target.value,a=n.props,r=a.recipient,i=a.onRecipientChange,o=r.setIn(["to","address"],t);i(_t.c,!0,o)};n.partial=N()(Ne.a);n.state={sendToInitialized:n.isSendToFixed()};return n}Object(c.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.searchSelect=this.createSearchSelectResolvers()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.toList,n=e.recipient,a=t?t.size:n.to.hasAddress();this.state.sendToInitialized&&!a&&this.setState({sendToInitialized:!1})}},{key:"isSendToAny",value:function(){return this.props.sendToType===xn.a}},{key:"isSendToFixed",value:function(){return this.props.sendToType===xn.b}},{key:"isSendToScoped",value:function(){return this.props.sendToType===xn.c}},{key:"createSearchSelectResolvers",value:function(){var e=this.props,t=e.subjectId,n=e.recipientResolverFactory;return{SendToComponent:(0,e.makeContactSearchSelect)(n.dependency.get(t,"searchableSelect")),sendToResolver:n.create()}}},{key:"getSendToAddressOptions",value:function(e){return e.emailAddresses.map(function(e){return{text:e,value:e}}).toArray()}},{key:"getRecipientList",value:function(e){var t=this.props,n=t.bccList,a=t.ccList,r=t.toList,i=t.recipient;return e===_t.b?a:e===_t.a?n:r||Rr(i)}},{key:"suppressDeliverabilityWarning",value:function(){return!this.isSendToFixed()&&!this.state.sendToInitialized}},{key:"renderDeliverabilityWarning",value:function(){var e=this.props,t=e.showDeliverabilityWarning,n=e.recipient;return this.suppressDeliverabilityWarning()||!t||!this.isSendToFixed()||n.to.hasAddress()?null:Object(p.jsx)(da.a,{name:"warning",color:Ja.MARIGOLD,className:"p-left-2"})}},{key:"renderRecipientSelect",value:function(e,t,n){var a=this.props,r=a.contacts,i=a.deliverability,o=a.disabledRecipientFields,s=a.owners,c=a.onRecipientChange,u=a.relatedContacts,l=a.onOpen,d=a.emailSelectRef,m=a.showNeverLogWarning,h={},f=o.contains(e);(e===_t.c||f)&&(h.autoFocus=!1);return Object(p.jsx)(Er,Object.assign({contacts:r,deliverability:i,disabled:f,maxSelectable:n,onRemoved:this.partial(c,e,!1),onSelected:this.partial(c,e,!0),owners:s,relatedContacts:u,resolver:t,selected:this.getRecipientList(e),onOpen:this.partial(l,e),emailSelectRef:d,showNeverLogWarning:m},h))}},{key:"renderSendToSearchSelectCreateAddress",value:function(){return Object(p.jsx)("div",{children:this.renderRecipientSelect(_t.c,this.searchSelect.sendToResolver,1)})}},{key:"renderSendToSearchSelectAddress",value:function(e){var t,n=e.to,a=this.searchSelect.SendToComponent;n.id&&(t=this.props.recipientResolverFactory.dependency.toId(n.id,n.address));return Object(p.jsx)(a,{value:t,onChange:this.handleSendToChange,placeholder:Se.a.text("customerDataCommunicator.Communicator.Email.recipients.choose")})}},{key:"renderSendToSelectAddress",value:function(e){var t=e.to;return Object(p.jsxs)("span",{children:[t.fullName(it.a)," ",Object(p.jsxs)("small",{children:["(",Object(p.jsx)(Ra.a,{className:"sender-input",onChange:this.handleFixedSendToChange,options:this.getSendToAddressOptions(e),defaultValue:t.address,value:t.address,buttonUse:"link",menuWidth:400}),")"]})]})}},{key:"renderSingleSendToAddress",value:function(e){var t=e.to;return Object(p.jsx)(Za,{name:t.fullName(it.a),address:t.address})}},{key:"renderSendToAddress",value:function(){var e=this.props.recipient;return this.isSendToFixed()?1===e.emailAddresses.size?this.renderSingleSendToAddress(e):this.renderSendToSelectAddress(e):this.isSendToScoped()?this.renderSendToSearchSelectAddress(e):this.renderSendToSearchSelectCreateAddress()}},{key:"renderSendToInput",value:function(){return this.props.toList?this.renderRecipientSelect(_t.c,this.searchSelect.sendToResolver):this.renderSendToAddress()}},{key:"renderSendToInputAndLinks",value:function(){var e=this.props.toList,t=st()((this.isSendToAny()||e)&&"p-top-2",!this.isSendToAny()&&!e&&"p-y-2");return Object(p.jsxs)(za.a,{className:t,children:[Object(p.jsx)(Ha.a,{className:b.List.isList(e)?"":"align-self-end",children:Object(p.jsx)(Aa.a,{className:"p-y-0",children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.recipients.to"})})}),Object(p.jsx)(Wa.a,{overflow:!0,children:Object(p.jsxs)("span",{children:[this.renderSendToInput(),this.renderDeliverabilityWarning()]})})]})}},{key:"render",value:function(){return Object(p.jsx)("div",{className:this.props.className,children:this.renderSendToInputAndLinks()})}}]);return t}(xe.a);Ar.propTypes=Tr;Ar.defaultProps=Ir;var Nr=Ar,xr={type:h.a.string.isRequired,subjectId:h.a.string.isRequired,recipientResolverFactory:h.a.instanceOf(Ia.a),contacts:h.a.shape({get:h.a.func.isRequired}).isRequired,deliverability:h.a.instanceOf(b.Map).isRequired,owners:h.a.shape({get:h.a.func.isRequired}).isRequired,relatedContacts:h.a.arrayOf(h.a.shape({text:h.a.string,value:h.a.string,record:h.a.instanceOf(b.Record)})),onRemoved:h.a.func.isRequired,onSelected:h.a.func.isRequired,onOpen:h.a.func.isRequired,selected:Object(ye.iterableOf)(Ea.a).isRequired,disabledRecipientFields:Object(ye.setOf)(h.a.oneOf([_t.c,_t.b,_t.a]))},Lr={disabledRecipientFields:Object(b.Set)()},kr=function(e){Object(d.a)(t,e);function t(){Object(s.a)(this,t);return Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}Object(c.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.searchSelect=this.createSearchSelectResolvers()}},{key:"createSearchSelectResolvers",value:function(){var e=this.props,t=e.subjectId;return{copyToResolver:e.recipientResolverFactory.create(t,"searchSelect",{includeOwners:!0})}}},{key:"renderRecipientSelect",value:function(e){var t=this.props,n=t.contacts,a=t.deliverability,r=t.owners,i=t.relatedContacts,o=t.onOpen,s=t.onRemoved,c=t.onSelected,u=t.selected,l=t.disabledRecipientFields,d=t.type,m=l.contains(d);return Object(p.jsx)(Er,{autoFocus:!1,contacts:n,deliverability:a,disabled:m,onOpen:o,onRemoved:s,onSelected:c,owners:r,relatedContacts:i,resolver:e,selected:u})}},{key:"render",value:function(){var e=this.props.type;return Object(p.jsxs)("div",{className:"flex-row align-baseline p-top-2","data-selenium-test":"communicator-"+e+"-input",children:[Object(p.jsx)(Aa.a,{className:"p-y-0 selectRecipientSelect","data-selenium-test":"recipient-select",children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.recipients."+e})}),this.renderRecipientSelect(this.searchSelect.copyToResolver)]})}}]);return t}(xe.a);kr.propTypes=xr;kr.defaultProps=Lr;var Mr=kr,_r={disabledRecipientFields:Object(ye.setOf)(h.a.oneOf([_t.c,_t.b,_t.a])),type:h.a.string.isRequired,onClick:h.a.func.isRequired},Dr={disabledRecipientFields:Object(b.Set)()},Pr=function(e){Object(d.a)(t,e);function t(){Object(s.a)(this,t);return Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.disabledRecipientFields,n=e.type,a=t.contains(n),r=Object(p.jsx)(F.a,{message:"customerDataCommunicator.Communicator.Email.recipients.disabledTooltip",options:{type:Se.a.text("customerDataCommunicator.Communicator.Email.recipients."+n).toLowerCase()}});return Object(p.jsx)(pa.a,{title:r,disabled:!a,children:Object(p.jsx)(q.a,{className:"show-cc m-x-1",disabled:a,use:"link",onClick:this.props.onClick,"data-selenium-test":"communicator-"+n+"-button",children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.recipients."+n})})})}}]);return t}(xe.a);Pr.propTypes=_r;Pr.defaultProps=Dr;var wr,Br=Pr,Fr={toList:Object(ye.listOf)(Ea.a),bccList:Object(ye.listOf)(Ea.a).isRequired,ccList:Object(ye.listOf)(Ea.a).isRequired,contacts:h.a.shape({get:h.a.func.isRequired}).isRequired,deliverability:h.a.instanceOf(b.Map).isRequired,disabledRecipientFields:Object(ye.setOf)(h.a.oneOf([_t.c,_t.b,_t.a])),from:h.a.instanceOf(Ta.a).isRequired,fromTooltip:h.a.shape({open:h.a.bool.isRequired,onClose:h.a.func,placement:h.a.string,headingText:h.a.string,title:h.a.string,use:h.a.string}).isRequired,allowSenderChange:h.a.bool,makeContactSearchSelect:h.a.func.isRequired,objectType:Je.b.isRequired,onRecipientChange:h.a.func.isRequired,onSenderChange:h.a.func.isRequired,onSubjectChange:h.a.func.isRequired,owners:h.a.shape({get:h.a.func.isRequired}).isRequired,readOnly:h.a.bool.isRequired,recipient:h.a.instanceOf(Ea.a),recipientResolverFactory:h.a.instanceOf(Ia.a).isRequired,relatedContacts:h.a.arrayOf(h.a.shape({text:h.a.string,value:h.a.string,record:h.a.instanceOf(b.Record)})),sender:h.a.instanceOf(J.a).isRequired,sendToType:h.a.oneOf([xn.a,xn.b,xn.c]),showDeliverabilityWarning:h.a.bool.isRequired,showNeverLogWarning:h.a.bool,subject:h.a.string,subjectId:h.a.string.isRequired,onOpen:h.a.func,renderSenderWarning:h.a.func,emailSelectRef:h.a.object,isForward:h.a.bool},Ur={fromTooltip:{open:!1},objectType:St.CONTACT,disabledRecipientFields:Object(b.Set)(),showNeverLogWarning:!0},qr=Object(b.Record)((wr={},Object(ve.a)(wr,_t.b,!1),Object(ve.a)(wr,_t.a,!1),wr)),Gr=function(e){return Object(b.Seq)(e.to.hasAddress()?[e]:[])},Vr=function(e){Object(d.a)(t,e);function t(){var e;Object(s.a)(this,t);(e=Object(u.a)(this,Object(l.a)(t).call(this))).handleRecipientChange=function(t,n,a,r){e.hasChangedRecipients=!0;e.props.onRecipientChange(t,n,a,r)};e.handleCopyToClick=function(t){var n=e.state.expanded;e.setState({expanded:n.set(t,!0)})};e.handleRecipientChange=e.handleRecipientChange.bind(Object(at.a)(e));e.selectRelatedContactOnFirstRender=!0;e.hasChangedRecipients=!1;e.partial=N()(Ne.a);e.state={expanded:qr()};return e}Object(c.a)(t,[{key:"componentDidMount",value:function(){this.initializeToList(this.props)}},{key:"UNSAFE_componentWillUpdate",value:function(e){this.initializeToList(e)}},{key:"initializeToList",value:function(e){var t=e.toList,n=e.relatedContacts,a=e.contacts,r=e.owners,i=e.onRecipientChange,o=e.isForward;if(!this.hasChangedRecipients&&t&&0===t.size&&n&&1===n.length&&this.selectRelatedContactOnFirstRender&&!o){this.selectRelatedContactOnFirstRender=!1;var s=n[0].value,c=Object(Dt.e)(a,r,s);i(_t.c,!0,c,Object(Dt.l)(s))}}},{key:"getRecipientList",value:function(e){var t=this.props,n=t.bccList,a=t.ccList,r=t.toList,i=t.recipient;return e===_t.b?a:e===_t.a?n:r||Gr(i)}},{key:"showCopyToInput",value:function(e){var t=!this.props.readOnly,n=this.state.expanded,a=this.getRecipientList(e);return t&&(n[e]||a.size>0)}},{key:"renderRecipients",value:function(){var e=this.props,t=e.bccList,n=e.ccList,a=e.deliverability,r=e.disabledRecipientFields,i=e.toList,o=e.contacts,s=e.makeContactSearchSelect,c=e.owners,u=e.readOnly,l=e.recipient,d=e.recipientResolverFactory,m=e.relatedContacts,h=e.sendToType,f=e.showDeliverabilityWarning,g=e.showNeverLogWarning,b=e.subjectId;return Object(p.jsx)(Nr,{toList:i,bccList:t,ccList:n,disabledRecipientFields:r,contacts:o,deliverability:a,makeContactSearchSelect:s,onRecipientChange:this.handleRecipientChange,owners:c,recipient:l,recipientResolverFactory:d,relatedContacts:m,sendToType:h,showCopyTo:!u,showDeliverabilityWarning:f,showNeverLogWarning:g,subjectId:b,onOpen:this.props.onOpen,emailSelectRef:this.props.emailSelectRef})}},{key:"renderCopyToInput",value:function(e){if(!this.showCopyToInput(e))return null;var t=this.props,n=t.onRecipientChange,a=t.showNeverLogWarning;return Object(p.jsx)(Mr,{contacts:this.props.contacts,deliverability:this.props.deliverability,onOpen:this.partial(this.props.onOpen,e),onRemoved:this.partial(n,e,!1),onSelected:this.partial(n,e,!0),owners:this.props.owners,recipientResolverFactory:this.props.recipientResolverFactory,relatedContacts:this.props.relatedContacts,selected:this.getRecipientList(e),subjectId:this.props.subjectId,type:e,disabledRecipientFields:this.props.disabledRecipientFields,showNeverLogWarning:a})}},{key:"renderSender",value:function(){var e=this.props,t=e.sender,n=e.from,a=e.onSenderChange,r=e.fromTooltip,i=e.allowSenderChange,o=e.renderSenderWarning,s=this.showCopyToInput(_t.a)&&this.showCopyToInput(_t.b)?"":"p-left-4";return Object(p.jsxs)(za.a,{className:"crm-light-border-bottom",children:[Object(p.jsx)(Wa.a,{overflow:!0,children:Object(p.jsx)(pa.a,Object.assign({},r,{children:Object(p.jsx)(Ga,{allowSenderChange:i,from:n,onChange:a,renderSenderWarning:o,sender:t})}))}),Object(p.jsx)(Ha.a,{className:s,children:this.renderCopyToLinks()})]})}},{key:"renderCopyToLinks",value:function(){return Object(p.jsxs)("span",{className:"p-y-2",children:[this.renderCopyToLink(_t.b),this.renderCopyToLink(_t.a)]})}},{key:"renderCopyToLink",value:function(e){return this.props.readOnly||this.showCopyToInput(e)?null:Object(p.jsx)(Br,{type:e,disabledRecipientFields:this.props.disabledRecipientFields,onClick:this.partial(this.handleCopyToClick,e)})}},{key:"renderSubject",value:function(){var e=this.props,t=e.subject,n=e.readOnly,a=e.onSubjectChange;if(!n)return Object(p.jsx)(Qa,{value:t,onChange:a})}},{key:"render",value:function(){return Object(p.jsxs)("div",{className:"m-left-1",children:[this.renderRecipients(),this.renderCopyToInput(_t.b),this.renderCopyToInput(_t.a),this.renderSender(),this.renderSubject()]})}}]);return t}(xe.a);Vr.propTypes=Fr;Vr.defaultProps=Ur;var Hr=function(e){var t=e.subject,n=e.subjectId,a=e.recipientResolverFactory,r={relatedContacts:e.isContact?{stores:[],deref:function(){return Object(Dt.h)(t).filter(function(e){return!!e}).map(function(e){var a=Object(Dt.m)(n,e);return{record:t,text:e,value:a}}).toArray()}}:a.dependency.get(n,"searchableSelect")};return Object(i.connect)(r,o.a)(Vr)},zr=n("47ul"),Wr=n.n(zr),Kr=n("sx3F"),Yr=n.n(Kr),Qr=n("/6Wf"),Jr=n("rCVw"),Xr="customerDataCommunicator.Communicator.Email.alias",Zr=function(e,t){var n=t.get("inboxId");return e===Jr.c?Object(_a.g)():n?Object(_a.d)({inboxId:n}):Object(_a.f)()},$r=function(e,t){switch(e){case Jr.a:case Jr.d:return{langBasePath:Xr+".DISABLED",href:Be.a.get("EmailSettingsMigration")?"/settings/"+et.a.get()+"/user-preferences/email":"/crm-settings-email/"+et.a.get()+"/email"};case Jr.c:case Jr.b:return{langBasePath:Xr+"."+e,href:Zr(e,t)};default:return null}},ei=function(e){Object(d.a)(t,e);function t(e){var n;Object(s.a)(this,t);(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleOpenZorseWindow=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;n.props.isPaidHub&&t.hubspot&&t.hubspot.zorse&&"function"==typeof t.hubspot.zorse.openHelpWidget?t.hubspot.zorse.openHelpWidget():t.open("https://help.hubspot.com/","_blank")};n.state={messageMetadata:n.getMessageMetadata(e)};return n}Object(c.a)(t,[{key:"componentDidMount",value:function(){Object(ne.a)({error:new Error("An account was selected without proper permissions"),extraData:{EmailAlias:this.props.alias}})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.alias.get("disabled")!==this.props.alias.get("disabled")&&this.setState({messageMetadata:this.getMessageMetadata(e)})}},{key:"getSafeLangKey",value:function(e){var t=this.state.messageMetadata.langBasePath+"."+e;if(Yr()(t))return t;Object(ne.a)({error:new Error("Missing Account Access I18n Key"),extraData:{key:t,EmailAlias:this.props.alias}});var n=e;"alert.info"===e&&(n=e+"_jsx");return Xr+".DEFAULT."+n}},{key:"getMessageMetadata",value:function(e){var t=e.alias,n=t.get("disabled"),a=$r(n,t);return a||{langBasePath:Xr+".DEFAULT"}}},{key:"renderCTA",value:function(){var e=this.state.messageMetadata,t=this.getSafeLangKey("button");return e.href&&t?Object(p.jsx)(q.a,{href:e.href,target:"_blank",use:"primary",className:"missing-account-cta",children:Se.a.text(t)}):null}},{key:"renderAlertMessage",value:function(){var e=this.getSafeLangKey("alert.info");return Object(p.jsx)("p",{className:"m-bottom-5 p-x-14 alert-message",children:Object(p.jsx)(Wr.a,{message:e,elements:{UILink:De.a},options:{onClick:this.handleOpenZorseWindow}})})}},{key:"render",value:function(){return Object(p.jsxs)(U.a,{className:"p-top-10 p-bottom-15 m-y-10 p-x-4 text-center",titleText:Se.a.text(this.getSafeLangKey("alert.title")),style:{backgroundColor:"inherit"},children:[this.renderAlertMessage(),this.renderCTA()]})}}]);return t}(xe.a);ei.propTypes={alias:h.a.instanceOf(Qr.a),isPaidHub:h.a.bool.isRequired};var ti=ei,ni=n("CkxV"),ai=n("bCAt"),ri=n("Uh/y"),ii=n("MsNc"),oi=dt()(ii.a).withConfig({displayName:"H3",componentId:"sc-1qohqmn-0"})([""]);oi.propTypes=ii.a.propTypes;oi.defaultProps=Object.assign({},ii.a.defaultProps,{tagName:"h3"});oi.displayName="H3";var si=oi,ci=n("fzi9"),ui=n("lS0L"),li=n("uzdC"),di=n("zUU5"),pi=function(e){var t,n={};if(!(e instanceof Object)||Array.isArray(e))throw new Error("keyMirror(...): Argument must be an object.");for(t in e)e.hasOwnProperty(t)&&(n[t]=t);return n},mi=pi({LEGITIMATE_INTEREST_PQL:null,LEGITIMATE_INTEREST_CLIENT:null,PERFORMANCE_OF_CONTRACT:null,CONSENT_WITH_NOTICE:null,NON_GDPR:null}),hi=(pi({OPT_IN:null,OPT_OUT:null,NOT_OPTED:null}),pi({subscription:null,newStatus:null,email:null,lawfulBasis:null,explanation:null,requestedBy:null,source:null,created:null}),function(e){var t=e.hideConsent,n=void 0!==t&&t,a=e.hideContract,r=void 0!==a&&a,i=e.showHelpText,o=void 0!==i&&i,s=e.hideNonGdpr,c=void 0!==s&&s,u=[Object.assign({text:Se.a.text("options.lawfulBasis."+mi.LEGITIMATE_INTEREST_PQL),value:mi.LEGITIMATE_INTEREST_PQL},o&&{help:Se.a.text("options.lawfulBasis.help."+mi.LEGITIMATE_INTEREST_PQL)}),Object.assign({text:Se.a.text("options.lawfulBasis."+mi.LEGITIMATE_INTEREST_CLIENT),value:mi.LEGITIMATE_INTEREST_CLIENT},o&&{help:Se.a.text("options.lawfulBasis.help."+mi.LEGITIMATE_INTEREST_CLIENT)})];r||u.push(Object.assign({text:Se.a.text("options.lawfulBasis."+mi.PERFORMANCE_OF_CONTRACT),value:mi.PERFORMANCE_OF_CONTRACT},o&&{help:Se.a.text("options.lawfulBasis.help."+mi.PERFORMANCE_OF_CONTRACT)}));n||u.push(Object.assign({text:Se.a.text("options.lawfulBasis."+mi.CONSENT_WITH_NOTICE),value:mi.CONSENT_WITH_NOTICE},o&&{help:Se.a.text("options.lawfulBasis.help."+mi.CONSENT_WITH_NOTICE)}));c||u.push(Object.assign({text:Se.a.text("options.lawfulBasis."+mi.NON_GDPR),value:mi.NON_GDPR},o&&{help:Se.a.text("options.lawfulBasis.help."+mi.NON_GDPR)}));return u}),fi=function(e){return Object(p.jsx)(li.a,Object.assign({label:Se.a.text("labels.lawfulBasis")},e.formControlProps,{children:Object(p.jsx)(rr.a,Object.assign({placeholder:Se.a.text("placeholders.lawfulBasis")},e,{options:hi(e),dropdownClassName:"untruncate","data-selenium-test":"gdpr-legal-basis-select"}))}))},gi=function(e){return"customerDataEmail.GDPR.legalBasisForm."+e};function bi(e){var t=e.onLegalBasisChange,n=e.onExplanationChange,a=e.renderLegalBasisMessage,r=Object(f.useState)(!1),i=Object(ci.a)(r,2),o=i[0],s=i[1];return Object(p.jsxs)(ui.a,{children:[Object(p.jsx)("div",{children:a&&a()}),Object(p.jsx)(fi,{hideNonGdpr:!0,onChange:function(e){var n=e.target.value;t(n)},formControlProps:{required:!0,label:Object(p.jsx)(F.a,{message:gi("legalBasis")})}}),Object(p.jsx)(li.a,{error:o,label:Object(p.jsx)(F.a,{message:gi("explanation")}),required:!0,validationMessage:o?Object(p.jsx)(F.a,{message:gi("explanationError")}):null,children:Object(p.jsx)(di.a,{"data-selenium-test":"gdpr-lawful-basis-explanation",onChange:function(e){var t=e.target.value;if(t.length>255){s(!0);n("")}else{o&&s(!1);n(t)}}})})]})}bi.propTypes={onLegalBasisChange:h.a.func.isRequired,onExplanationChange:h.a.func.isRequired,renderLegalBasisMessage:h.a.func};var Oi=bi,vi=Object.assign({renderLegalBasisMessage:h.a.func},ai.a),ji="customerDataEmail.GDPR",Si=function(e){Object(d.a)(t,e);function t(e){var n;Object(s.a)(this,t);(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleLegalBasisChange=function(e){n.setState({lawfulBasis:e})};n.handleExplanationChange=function(e){n.setState({explanation:e})};n.handleSave=function(){n.props.onConfirm(n.state)};n.state={lawfulBasis:"",explanation:""};return n}Object(c.a)(t,[{key:"render",value:function(){var e=!this.state.lawfulBasis||!this.state.explanation,t=this.props,n=t.renderLegalBasisMessage,a=t.onReject;return Object(p.jsx)(ri.a,{title:Object(p.jsx)(si,{children:Object(p.jsx)(F.a,{message:ji+".dialogs.legalBasis.title"})}),onConfirm:this.handleSave,onReject:a,confirmDisabled:e,confirmDisabledTooltip:Object(p.jsx)(F.a,{message:ji+".buttons.disabled"}),children:Object(p.jsx)(Oi,{onLegalBasisChange:this.handleLegalBasisChange,onExplanationChange:this.handleExplanationChange,renderLegalBasisMessage:n})})}}]);return t}(xe.a);Si.propTypes=vi;var yi=Object(ni.a)(Si),Ci=n("nrhn"),Ei=n("/VSk"),Ti=n.n(Ei),Ii=n("dd+0"),Ri=n.n(Ii),Ai=Object(b.Map)(),Ni=Object(i.define)().defineName("EmailGDPRLogStore").defineGet(function(e){return Ai.get(e)}).defineResponseTo(pt.U,function(e){var t=e.subjectId,n=e.legalBases;return Ai=Ai.set(t,n)}).defineResponseTo(pt.V,function(e){return Ai=Ai.delete(e)}).register(o.a),xi=n("EvX1"),Li=n.n(xi),ki={globallyOptedOutRecipientEmails:Object(b.List)(),notOptedInRecipientEmails:Object(b.List)(),optedOutRecipientEmails:Object(b.List)(),hasGdprEnabled:!1,oneToOneSubscription:Object(b.Map)()},Mi=function(e){Object(d.a)(t,e);function t(){Object(s.a)(this,t);return Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}Object(c.a)(t,null,[{key:"from",value:function(e){var n=e.globallyOptedOutRecipientEmails,a=void 0===n?Object(b.List)():n,r=e.notOptedInRecipientEmails,i=void 0===r?Object(b.List)():r,o=e.optedOutRecipientEmails,s=void 0===o?Object(b.List)():o,c=e.hasGdprEnabled,u=void 0!==c&&c,l=e.oneToOneSubscription;return new t({globallyOptedOutRecipientEmails:a,notOptedInRecipientEmails:i,optedOutRecipientEmails:s,hasGdprEnabled:u,oneToOneSubscription:void 0===l?Object(b.Map)():l})}}]);return t}(Object(b.Record)(ki)),_i=function(e){return"customerDataCommunicator.Communicator.Email.gdpr."+e},Di="is--heading-7 p-all-0 m-all-0 display-inline-block",Pi=function(e,t){return t.map(function(t){var n=e.find(function(e){return e.to.address===t});return n?Object(p.jsx)(Za,{className:Di,name:n.to.fullName(it.a),address:n.to.address},n.to.address):null})},wi=function(e,t,n){var a=Object(p.jsx)(Ti.a,{children:t}),r=Object.assign({recipientList:a},n);return Object(p.jsx)("p",{style:{maxWidth:"600px",textAlign:"center"},children:Object(p.jsx)(Ri.a,{message:e,options:r})})},Bi=function(e){if(0===e.size)return null;var t=_i("globallyOptedOut."+(e.size>1?"plural":"singular"));return wi(t,e)},Fi=function(e,t){if(0===e.size)return null;var n=_i("optedOut."+(e.size>1?"plural":"singular"));return wi(n,e,{subscription:t})},Ui=function(e,t,n){if(0===e.size)return null;var a=_i("notOpted."+(e.size>1?"plural":"singular")),r=Object(p.jsx)(q.a,{use:"link","data-selenium-test":"gdpr-change-status",onClick:n,children:Object(p.jsx)(F.a,{message:_i("changeStatus"),options:{count:e.size}})});return wi(a,e,{subscription:t,changeStatusButton:r})};function qi(e){var t=e.allRecipients,n=e.gdprSubscriptionProps,a=e.onChangeStatus,r=n.globallyOptedOutRecipientEmails,i=n.hasGdprEnabled,o=n.notOptedInRecipientEmails,s=n.oneToOneSubscription,c=n.optedOutRecipientEmails,u=Pi(t,r).filter(Li.a),l=Pi(t,c).filter(Li.a),d=Pi(t,o),m=Object(p.jsx)(F.a,{className:Di,message:"customerDataCommunicator.Communicator.Email.gdpr.message.oneToOneSubscription",options:{subscriptionName:s.get("name")}});return Object(p.jsxs)(f.Fragment,{children:[Bi(u),Fi(l,m),i&&Ui(d,m,a)]})}qi.propTypes={allRecipients:Ce.a.list.isRequired,gdprSubscriptionProps:h.a.instanceOf(Mi).isRequired,onChangeStatus:h.a.func.isRequired};var Gi=qi,Vi={email:"",explanation:"",legalBasis:""},Hi=function(e){Object(d.a)(t,e);function t(){Object(s.a)(this,t);return Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}Object(c.a)(t,null,[{key:"from",value:function(e){return new t({email:e.email,explanation:e.explanation,legalBasis:e.legalBasis})}}]);return t}(Object(b.Record)(Vi)),zi=n("+MPf"),Wi=n("R/fd");function Ki(e){var t=e["aria-labelledby"],n=e.children,a=(e.error,e.inline),r=e.name,i=Object(Na.a)(e,["aria-labelledby","children","error","inline","name"]);return Object(p.jsx)("div",Object.assign({},i,{children:f.Children.map(n,function(e){Object(Wi.a)(e,Ki.displayName);return e&&e.type&&Object(f.cloneElement)(e,Object.assign({inline:a,name:r,"aria-labelledby":st()(e.props.ariaLabelledBy,t)},e.props))})}))}Ki.propTypes={"aria-labelledby":h.a.string,children:h.a.node.isRequired,inline:h.a.bool,name:h.a.string.isRequired};Ki.displayName="UIToggleGroup";var Yi="addSubscription",Qi="markContactN/a",Ji="NON_GDPR",Xi=function(e){return"customerDataEmail.GDPR.changeSubscriptionStatus."+e},Zi=function(e,t,n){return{legalBasis:e===Qi?Ji:t,explanation:n}},$i=function(e,t,n){return(e===Qi||e===Yi)&&(e===Qi||""!==t&&""!==n)};function eo(e){var t=e.emails,n=e.onConfirm,a=e.onReject,r=e.subscriptionName,i=Object(f.useState)(""),o=Object(ci.a)(i,2),s=o[0],c=o[1],u=Object(f.useState)(""),l=Object(ci.a)(u,2),d=l[0],m=l[1],h=Object(f.useState)(null),g=Object(ci.a)(h,2),b=g[0],O=g[1],v=!$i(b,s,d),j=Object(p.jsxs)(Ki,{className:"p-y-3",name:"subscriptionStatus",children:[Object(p.jsx)(zi.a,{className:"p-y-3",onChange:function(e){return e.target.checked&&O(Yi)},"data-selenium-test":"gdpr-add-subscription",children:Object(p.jsx)(Ri.a,{message:Xi("addSubscription"),options:{subscriptionName:r}})}),Object(p.jsx)(zi.a,{className:"p-y-3",onChange:function(e){return e.target.checked&&O(Qi)},"data-selenium-test":"gdpr-mark-as-not-applicable",children:Object(p.jsx)(F.a,{message:Xi("markAsNA"),options:{count:t.size}})})]}),S=b===Yi?Object(p.jsx)(Oi,{onLegalBasisChange:c,onExplanationChange:m}):null;return Object(p.jsxs)(ri.a,{title:Object(p.jsx)(si,{children:Object(p.jsx)(F.a,{message:Xi("title")})}),onConfirm:function(){return n(Zi(b,s,d))},onReject:a,confirmDisabled:v,confirmDisabledTooltip:Object(p.jsx)(F.a,{message:"customerDataEmail.GDPR.buttons.disabled"}),children:[Object(p.jsx)(Ri.a,{message:Xi("description"),options:{recipientList:Object(p.jsx)(Ti.a,{children:t})}}),j,S]})}eo.propTypes=Object.assign({emails:Ce.a.list.isRequired,subscriptionName:h.a.node.isRequired},ai.a);var to=Object(ni.a)(eo);function no(e,t){return"/email/v2/contacts/"+encodeURIComponent(e)+"/subscriptions?"+t}function ao(e){return"/email/v1/subscriptions/"+encodeURIComponent(e)}var ro=function(e){return Pt.c(ao(e))},io=Object(wn.a)(ro,"SubscriptionsByEmailAPI.fetchSubscriptions"),oo=function(e,t){var n=no(e,"source=SOURCE_HUBSPOT_CUSTOMER");return Pt.d(n,t)};function so(e){return"subscriptions/v1/status/subscribers/"+encodeURIComponent(e)+"/types/email/brands"}var co=function(e){return Pt.c(so(e))};Object(wn.a)(co,"UpdatedSubscriptionStatusAPI.fetchSubscriptions");function uo(e){return"subscriptions/v1/timeline/email/"+encodeURIComponent(e)+"/full-timeline"}var lo=function(e){return Pt.c(uo(e))},po=(Object(wn.a)(lo,"UpdatedSubscriptionHistoryAPI.fetchSubscriptionsHistory"),"email/v1/subscriptions/definitions?includeInternal=true"),mo="subscriptions/v1/definitions/by-subscription-key",ho=function(){return Pt.c(po).then(function(e){return Object(b.Map)().set("subscriptionDefinitions",e)})},fo=function(e,t){return Pt.f({type:"PUT"},mo+"/"+encodeURIComponent(e)+"?portalId="+t)},go="OPT_IN",bo="OPT_OUT",Oo="NOT_OPTED",vo=n("P4dz"),jo=n("aORY"),So=n.n(jo);So()({OPT_OUT:null,NOT_OPTED:null,OPT_IN:null});var yo=n("Xy8J"),Co=n.n(yo);n("m9st");function Eo(e,t){var n=t.lawfulBasis,a={id:t.subscription,legalBasis:n,legalBasisExplanation:t.explanation},r=e.map(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oo,t=arguments.length>1?arguments[1]:void 0;a.optState=e;a.subscribed=e===go;a.unsubscribed=e!==go;var n={subscriptionStatuses:[a],email:t,portalId:et.a.get()};return oo(t,n)});return Co()(r).then(function(){Object(gt.a)(pt.Tb,{emails:e,updatedSubscription:a})})}function To(e){return fo(e,et.a.get())}var Io=function(e){return"customerDataCommunicator.Communicator.Email.gdpr.message."+e},Ro="is--heading-7 p-all-0 m-all-0 display-inline-block";function Ao(e,t){return t.map(function(t){var n=e.find(function(e){return e.to.address===t});return n?Object(p.jsx)(Za,{className:Ro,name:n.to.fullName(it.a),address:n.to.address},n.to.address):null})}var No=function(e){Object(d.a)(t,e);function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).getGloballyOptedOutEmailsWithoutLegalBasis=function(){var e=n.props,t=e.globallyOptedOutRecipients,a=e.legalBases;return t.filterNot(function(e){return a.has(e)})};n.getOptedOutEmailsWithoutLegalBasis=function(){var e=n.props,t=e.recipientsOptedOut,a=e.legalBases;return t.filterNot(function(e){return a.has(e)})};n.getNotOptedInEmailsWithoutLegalBasis=function(){var e=n.props,t=e.recipientsNotOptedIn,a=e.legalBases;return e.hasGdprEnabled?t.filterNot(function(e){return a.has(e)}):Object(b.List)()};n.getAllEmailsWithoutLegalBasis=function(){return n.getGloballyOptedOutEmailsWithoutLegalBasis().concat(n.getOptedOutEmailsWithoutLegalBasis(),n.getNotOptedInEmailsWithoutLegalBasis())};n.handleUpdateLegalBasis=function(e){var t=e.lawfulBasis,a=e.explanation,r=n.props,i=r.handleUsageLogging,o=r.handleGDPRByPass;i("emailCommunicatorInteraction",{subAction:"provide one time legal basis"});o(n.getAllEmailsWithoutLegalBasis().reduce(function(e,n){return e.set(n,Hi.from({email:n,explanation:a,legalBasis:t}))},n.props.legalBases))};n.handleUpdateSubscriptionStatus=function(e){var t=e.legalBasis,a=e.explanation,r=n.props.oneToOneSubscription;Eo(n.getNotOptedInEmailsWithoutLegalBasis().reduce(function(e,t){return e.set(t,go)},Object(b.Map)()),{lawfulBasis:t,explanation:a,subscription:r.get("id")})};n.handleShowStatusChangeDialog=function(){var e=n.props,t=e.allRecipients,a=e.oneToOneSubscription,r=Ao(t,n.getNotOptedInEmailsWithoutLegalBasis());to({emails:r,subscriptionName:Object(p.jsx)(F.a,{className:Ro,message:Io("oneToOneSubscription"),options:{subscriptionName:a.get("name")}})}).then(n.handleUpdateSubscriptionStatus,Ci.a).done()};n.handleShowProvideLegalBasisDialog=function(){yi({renderLegalBasisMessage:n.renderDialogProvideLegalBasisMessage}).then(n.handleUpdateLegalBasis,Ci.a).done()};n.renderDialogProvideLegalBasisMessage=function(){var e=Ao(n.props.allRecipients,n.getAllEmailsWithoutLegalBasis());return Object(p.jsx)(Ri.a,{message:Io("provideLegalBasisDialog"),options:{recipientList:Object(p.jsx)(Ti.a,{children:e})}})};return n}Object(c.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){var e=this.props,t=e.cachedLegalBases,n=e.handleGDPRByPass;if(t){n(t,this.getAllEmailsWithoutLegalBasis().isEmpty())}}},{key:"renderProvideLegalBasisSection",value:function(){return Object(p.jsxs)(f.Fragment,{children:[Object(p.jsx)(F.a,{message:Io("provideLegalBasis.text")}),Object(p.jsx)(q.a,{size:"small",use:"tertiary",className:"m-top-3","data-selenium-test":"gdpr-legal-basis",onClick:this.handleShowProvideLegalBasisDialog,children:Object(p.jsx)(F.a,{message:"customerDataCommunicator.Communicator.Email.gdpr.message.provideLegalBasis.button"})})]})}},{key:"renderMessage",value:function(){var e=this.props,t=e.allRecipients,n=e.hasGdprEnabled,a=e.oneToOneSubscription,r=Mi.from({globallyOptedOutRecipientEmails:this.getGloballyOptedOutEmailsWithoutLegalBasis(),notOptedInRecipientEmails:this.getNotOptedInEmailsWithoutLegalBasis(),optedOutRecipientEmails:this.getOptedOutEmailsWithoutLegalBasis(),hasGdprEnabled:n,oneToOneSubscription:a});return Object(p.jsx)(Gi,{allRecipients:t,gdprSubscriptionProps:r,onChangeStatus:this.handleShowStatusChangeDialog})}},{key:"render",value:function(){return Object(p.jsxs)("div",{className:"p-all-5 display-flex align-center justify-center flex-column",children:[this.renderMessage(),this.renderProvideLegalBasisSection()]})}}]);return t}(xe.a);No.propTypes={recipientsNotOptedIn:Ce.a.list.isRequired,handleGDPRByPass:h.a.func.isRequired,allRecipients:Ce.a.list.isRequired,globallyOptedOutRecipients:Ce.a.list.isRequired,recipientsOptedOut:Ce.a.list.isRequired,hasGdprEnabled:h.a.bool,handleUsageLogging:h.a.func.isRequired,cachedLegalBases:Ce.a.map,oneToOneSubscription:Ce.a.map,legalBases:Ce.a.map.isRequired};var xo=Object(i.connect)({cachedLegalBases:{stores:[Ni],propTypes:{subjectId:h.a.string},deref:function(e){var t=e.subjectId;return Ni.get(t)}}},o.a)(No);function Lo(){return Object(p.jsx)("div",{className:"p-y-1 p-x-5 crm-light-border-bottom",children:Object(p.jsx)(U.a,{use:"inline",type:"danger",titleText:Object(p.jsx)(F.a,{message:"customerDataCommunicator.salesContentMenuError.title"}),children:Object(p.jsx)(F.a,{message:"customerDataCommunicator.salesContentMenuError.text"})})})}var ko=n("AF1D"),Mo=n("2TCK"),_o=n("folk"),Do={stores:[ko.a,_o.a],deref:function(e){var t=e.subjectId;if(e.objectType!==St.TICKET||!t)return Mn.a;var n=ko.a.get({objectType:St.ENGAGEMENT,searchQuery:Mo.a.default({count:1,sorts:[{property:"engagement.timestamp",order:"DESC"}],filterGroups:[{filters:[{property:"associations.ticket",operator:"IN",values:[t]},{property:"email.threadId",operator:"HAS_PROPERTY"},{property:"email.messageId",operator:"HAS_PROPERTY"}]}]})});if(Object(Mn.d)(n))return Mn.b;var a=n&&n.getIn(["engagements",0]);return a?_o.a.get(a):Mn.a}},Po=n("LwVD"),wo=n("2T69"),Bo={mostRecentEmail:h.a.instanceOf(g.a),userSettings:h.a.object},Fo=function(e){Object(d.a)(t,e);function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).handleCloseTicketNewEmailAlert=function(){Ot(vt.a.HAS_CLOSED_THREAD_REPLY_MESSAGE,!0)};return n}Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.userSettings,n=e.mostRecentEmail,a=t&&t.get(vt.a.HAS_CLOSED_THREAD_REPLY_MESSAGE);return!n||a?null:Object(p.jsx)(U.a,{titleText:Object(p.jsx)(F.a,{message:"customerDataCommunicator.Communicator.Email.replyToThread.title"}),type:"warning",closeable:!0,onClose:this.handleCloseTicketNewEmailAlert,children:Object(p.jsx)(Ri.a,{message:"customerDataCommunicator.Communicator.Email.replyToThread.message",options:{link:Object(p.jsx)(Po.a,{url:"https://knowledge.hubspot.com/articles/kcs_article/email/how-do-i-send-an-email-and-reply-to-an-email-in-the-crm#reply-to-one-to-one-emails"})}})})}}]);return t}(xe.a);Fo.propTypes=Bo;var Uo=Object(i.connect)({mostRecentEmail:Do,userSettings:Object(wo.a)(vt.a.HAS_CLOSED_THREAD_REPLY_MESSAGE)},o.a)(Fo),qo=n("oSHU"),Go=function(e){var t=!1;return function(n,a){if(!t&&!n.plainText()&&a.plainText()){e();t=!0}}},Vo=n("lRoN"),Ho=Object(b.Record)({numberOfVideos:0,numberOfImages:0,numberOfAttachments:0,numberOfLinks:0},"EmailMediaAttachmentCountsRecord");Ho.fromRteResults=function(e){return new Ho({numberOfImages:e.numberOfImages(),numberOfVideos:e.numberOfVideos(),numberOfLinks:e.numberOfLinks()})};var zo=Ho,Wo=n("6dOn"),Ko=n.n(Wo),Yo=n("WLqE"),Qo=n("Sshb"),Jo=n("Ryvg"),Xo=n("iJaT"),Zo=n("T9dW"),$o=So()({SENT_EMAIL:null}),es=n("qvRI"),ts=n("GBWN"),ns="customerDataCommunicator.emailTrackingSettingAlert";function as(){var e=et.a.get();return Be.a.get("EmailSettingsMigration")?"/settings/"+e+"/objects/activities/email-logging":"/crm-settings-email/"+e+"/email/log-track"}var rs,is=function(e){var t,n,a=e.emailTrackingSetting,r=e.onConfirm;if(!a)return null;if(a.trackingIsEnabled){t="tracking_on_header";n="tracking_on_body"}else{t="tracking_off_header";n="tracking_off_body"}return Object(p.jsxs)(Xo.a,{use:"conversational",width:670,children:[Object(p.jsx)(ts.a,{children:Object(p.jsx)(Yo.a,{children:Object(p.jsx)(F.a,{message:ns+"."+t})})}),Object(p.jsx)(Qo.a,{className:"p-bottom-3",children:Object(p.jsxs)("p",{children:[Object(p.jsx)(F.a,{message:ns+"."+n})," ",Object(p.jsx)(De.a,{external:!0,href:as(),children:Object(p.jsx)(F.a,{message:ns+".learn_more_link"})})]})}),Object(p.jsx)(Jo.a,{align:"center",children:Object(p.jsx)(q.a,{use:"primary",onClick:r,children:Object(p.jsx)(F.a,{message:"customerDataCommunicator.emailTrackingSettingAlert.submit"})})})]})},os=n("bsBP"),ss="HUBS_SETTINGS_FETCH",cs="HUBS_SETTINGS_FETCH_SUCCEEDED",us="HUBS_SETTINGS_FETCH_FAILED",ls="DEFAULT_FONT",ds=Object(b.Record)({settings:Object(b.Map)(Object(ve.a)({},ls,Object(b.Map)({font:null,size:null,color:null}))),isLoading:!0,lastError:null},"HubsSettingsDataRecord"),ps=Object(i.defineFactory)().defineGetInitialState(function(){return ds()}).defineResponses((rs={},Object(ve.a)(rs,ss,function(){return ds()}),Object(ve.a)(rs,cs,function(e,t){return e.withMutations(function(e){e.mergeIn(["settings"],t).set("isLoading",!1)})}),Object(ve.a)(rs,us,function(e,t){return e.merge({isLoading:!1,lastError:t})}),rs)).register(),ms=n("g+dq"),hs=n.n(ms),fs="/hubs/v1/hubs",gs=function(){var e=et.a.get();return fs+"/"+e+"/settings"},bs=function(e){return Object(b.Map)().set(e.key,Object(b.fromJS)(JSON.parse(e.value)))},Os=function(e){return hs.a.get(gs()+"/"+e).then(bs)},vs=function(e){Object(gt.c)(ss);return Os(e).then(function(e){return Object(gt.b)(cs,e)}).catch(function(e){return Object(gt.b)(us,e)})},js="communicator-has-viewed-ticket-email-composer-alert",Ss="customerDataCommunicator.Email.ticketComposerBanner",ys=function(e){Object(d.a)(t,e);function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).onBannerClose=function(){es.a.log("communicator_bannerInteraction",{bannerName:"Ticket Email Composer Alert",activity:"close-banner",channel:"email",source:"communicator window"});Ot(js,!0)};return n}Object(c.a)(t,[{key:"render",value:function(){return this.props.hideTicketEmailComposerAlert?null:Object(p.jsx)(U.a,{type:"warning",closeable:!0,onClose:this.onBannerClose,children:Object(p.jsx)(ee.a,{message:Ss+".message"})})}}]);return t}(f.PureComponent);ys.propTypes={hideTicketEmailComposerAlert:h.a.bool};ys.defaultProps={hideTicketEmailComposerAlert:!0};var Cs={hideTicketEmailComposerAlert:{stores:[ft.a],deref:function(){return ft.a.get(js)}}},Es=Object(i.connect)(Cs)(ys);var Ts=function(e){Object(gt.b)(pt.Nb,{type:e,content:null})},Is=n("NLVp"),Rs=n("WAUT"),As=n("FXjx"),Ns=n("r1tY"),xs=n.n(Ns),Ls=function(e){Object(d.a)(t,e);function t(e){var n;Object(s.a)(this,t);(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).onFrameLoad=function(){var e=xs.a.findDOMNode(Object(at.a)(n)).contentWindow.document.body;e.style.color="#33475b";e.style["font-family"]='"Avenir Next W02", Helvetica, Arial, sans-serif';e.style["font-size"]="14px";e.style["line-height"]="24px";e.style["font-weight"]="400";n.setState({iframeHeight:e.scrollHeight+10+"px"})};n.state={iframeHeight:"0px"};return n}Object(c.a)(t,[{key:"render",value:function(){return Object(p.jsx)("iframe",{frameBorder:"0",ref:"iframe",scrolling:"no",height:this.state.iframeHeight,srcDoc:this.props.emailHistory,style:{maxWidth:640,width:"100%",height:this.state.iframeHeight,overflow:"visible"},onLoad:this.onFrameLoad})}}]);return t}(xe.a),ks={emailHistory:h.a.string},Ms={emailHistory:null};Ls.propTypes=ks;Ls.defaultProps=Ms;var _s,Ds=Ls,Ps="EMAIL_HISTORY_FETCH",ws="EMAIL_HISTORY_FETCH_SUCCEEDED",Bs="EMAIL_HISTORY_FETCH_FAILED",Fs="RESET_EMAIL_HISTORY",Us=function(e){Object(gt.c)(Ps);return e().then(function(e){return Object(gt.b)(ws,e)}).catch(function(e){return Object(gt.b)(Bs,e)})},qs=function(){Object(gt.b)(Fs)},Gs=Object(b.Record)({content:null,isLoading:!1,lastError:null},"EmailHistoryDataRecord"),Vs=1e5,Hs=Object(i.defineFactory)().defineGetInitialState(function(){return Gs()}).defineResponses((_s={},Object(ve.a)(_s,Ps,function(){return Gs({isLoading:!0})}),Object(ve.a)(_s,Fs,function(e){return e.merge({isLoading:!1,lastError:null,content:null})}),Object(ve.a)(_s,ws,function(e,t){t&&t.length>Vs&&(t=Se.a.text("customerDataCommunicator.Communicator.Email.emailHistory.contentTooLarge"));return e.withMutations(function(e){e.set("content",t).set("lastError",null).set("isLoading",!1)})}),Object(ve.a)(_s,Bs,function(e,t){ie({error:{message:"Email history failed to be fetched",detailedMessage:t}});return e.merge({isLoading:!1,lastError:t})}),_s)).register(o.a),zs="customerDataEmail.Forwarding",Ws=function(e){Object(d.a)(t,e);function t(e){var n;Object(s.a)(this,t);(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).tryAgain=function(){var e=n.props.fetchEmailHistory;Us(e)};n.state={showEmailHistory:!1};return n}Object(c.a)(t,[{key:"componentDidMount",value:function(){qs();this.moveHistoryToEnd()}},{key:"componentDidUpdate",value:function(e){e.fetchEmailHistory!==this.props.fetchEmailHistory&&qs()}},{key:"moveHistoryToEnd",value:function(){var e=document.querySelector("div.communicator-rte-editor-wrapper div.DraftEditor-root .public-DraftEditor-content");if(e){var t=document.querySelector("div.forwarded-rte-plugin");e.appendChild(t)}}},{key:"fillEmailHistory",value:function(){var e=this,t=this.props.fetchEmailHistory;this.setState({isLoading:!0});t().then(function(t){e.setState({emailHistory:t,isLoading:!1})}).catch(function(t){ie({error:{message:"Email history failed to be fetched",detailedMessage:t}});e.setState({fetchFailed:!0,isLoading:!1})})}},{key:"renderFailBanner",value:function(){return Object(p.jsxs)(U.a,{type:"danger",children:[Object(p.jsx)("strong",{children:Object(p.jsx)(F.a,{message:zs+".fetchFailedMessage"})})," ",Object(p.jsx)(De.a,{onClick:this.tryAgain,children:Object(p.jsx)(F.a,{message:zs+".fetchFailedTryAgain"})})]})}},{key:"renderEmailHistory",value:function(){var e=this.props,t=e.emailHistory,n=e.fetchEmailHistory,a=t.content,r=t.lastError,i=t.isLoading;a||r||i||Us(n);this.moveHistoryToEnd();return Object(p.jsx)(Rs.a,{style:{backgroundColor:"#f5f8fa",marginTop:10},compact:!0,children:Object(p.jsxs)(As.a,{style:{padding:5},children:[r&&this.renderFailBanner(),a&&Object(p.jsx)(Ds,{emailHistory:a}),i&&Object(p.jsx)(Q.a,{})]})})}},{key:"renderShowButton",value:function(){var e=this;return Object(p.jsx)(pa.a,{title:Object(p.jsx)(F.a,{message:zs+".emailHistoryTooltip"}),children:Object(p.jsx)(Is.a,{placement:"right",size:"extra-small",style:{borderRadius:"31px",width:40,paddingTop:9,height:20},onClick:function(){return e.setState({showEmailHistory:!e.state.showEmailHistory})},children:Object(p.jsx)(da.a,{name:"ellipses",size:"medium"})})})}},{key:"render",value:function(){return Object(p.jsxs)("div",{className:"forwarded-rte-plugin",contentEditable:!1,children:[this.renderShowButton(),this.state.showEmailHistory&&this.renderEmailHistory()]})}}]);return t}(xe.a),Ks={fetchEmailHistory:h.a.func.isRequired,emailHistory:Ce.a.record},Ys={emailHistory:Hs};Ws.propTypes=Ks;var Qs=Object(i.connect)(Ys)(Ws),Js=n("Nm19"),Xs=n("2h/E"),Zs=n("WYIs"),$s=n("Ukhg"),ec=n("ju9H"),tc=n("OW66"),nc="customerDataCommunicator.Communicator.Email.interaction",ac=function(e){Object(d.a)(t,e);function t(e){var n;Object(s.a)(this,t);(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).setSendButtonFn=n.setSendButtonFn.bind(Object(at.a)(n));n.generateGenericSendButtonFn=n.generateGenericSendButtonFn.bind(Object(at.a)(n));n.state={currentSendButtonFn:n.generateGenericSendButtonFn(e.defaultSaveLabel)};return n}Object(c.a)(t,[{key:"setSendButtonFn",value:function(e){var t=this;return function(){return t.setState({currentSendButtonFn:e})}}},{key:"generateGenericSendButtonFn",value:function(e,t){var n=this.props,a=n.handleSave,r=n.buttonSize;return function(n){var i=n.disabled,o=n.saveTooltip;return Object(p.jsx)(pa.a,Object.assign({},o,{children:Object(p.jsx)(q.a,{disabled:i,onClick:a(t),"data-selenium-test":"rich-text-editor-controls__save-btn",size:r,use:"primary",children:e})}))}}},{key:"getSendOptions",value:function(){var e=this.props,t=e.isQueueTask,n=e.defaultSaveLabel,a=e.sendLaterButtonContent,r=Object(p.jsx)(F.a,{message:nc+".sendOnly"}),i=Object(p.jsx)(q.a,{use:"link","data-test-id":"defaultSave",onClick:this.setSendButtonFn(this.generateGenericSendButtonFn(n)),children:n});return Object(p.jsxs)(ec.a,{children:[t?Object(p.jsx)(q.a,{use:"link","data-test-id":"sendOnly",onClick:this.setSendButtonFn(this.generateGenericSendButtonFn(r,{skipCompleteSave:!0})),children:r}):i,a?Object(p.jsx)(q.a,{use:"link","data-test-id":"sendLater",onClick:this.setSendButtonFn(function(e){var t=e.onSecondarySave;return a(t)}),children:Object(p.jsx)(F.a,{message:nc+".sendLater"})}):null,t?i:null]})}},{key:"render",value:function(){var e=this.props,t=e.sendParams,n=e.disabled,a=e.saveTooltip,r=e.sendLaterButtonContent,i=e.isQueueTask,o=r||i;return Object(p.jsx)("span",{className:"m-x-2",children:Object(p.jsxs)(tc.a,{children:[this.state.currentSendButtonFn(Object.assign({},t,{disabled:n,saveTooltip:a})),o?Object(p.jsx)($s.a,{iconName:null,buttonSize:"small",buttonUse:"primary",disabled:n,"data-selenium-test":"send-btn-dropdown",placement:"top left",style:{paddingLeft:10,paddingRight:10,borderLeft:"1px solid white"},children:this.getSendOptions()}):null]})})}}]);return t}(f.PureComponent);ac.propTypes={sendParams:h.a.object,saveTooltip:h.a.object.isRequired,disabled:h.a.bool.isRequired,isQueueTask:h.a.bool,defaultSaveLabel:h.a.node.isRequired,handleSave:h.a.func.isRequired,buttonSize:h.a.string.isRequired,sendLaterButtonContent:h.a.func};var rc=ac,ic=dt()(U.a).withConfig({displayName:"EmailComponent__CustomAlert",componentId:"sc-1jh0sko-0"})(["& > div{flex-wrap:nowrap !important;}"]),oc={associations:h.a.instanceOf(b.Map).isRequired,attachments:h.a.instanceOf(b.List).isRequired,attachmentsValid:h.a.bool.isRequired,checkIntegration:h.a.func.isRequired,children:h.a.node,connectDropTarget:h.a.func.isRequired,connectedAccounts:h.a.instanceOf(X.a).isRequired,contacts:h.a.shape({get:h.a.func.isRequired}).isRequired,isConversationsInteraction:h.a.bool,deliverability:h.a.instanceOf(b.Map).isRequired,disabledRecipientFields:h.a.instanceOf(b.Set),disableUnsubscribeLink:h.a.bool,editorState:h.a.object,enableMultipleToAddresses:h.a.bool,EmailActions:h.a.instanceOf(Nn.a).isRequired,emailBrandingVariation:h.a.string,emailTrackingSetting:h.a.shape({trackingIsEnabled:h.a.bool.isRequired}),gates:h.a.shape({get:h.a.func.isRequired}),globallyOptedOutRecipients:Ce.a.list,interaction:h.a.instanceOf(O.a).isRequired,inTimeline:h.a.bool,isFullScreen:h.a.bool,isQueueTask:h.a.bool,isHovered:h.a.bool.isRequired,isOptedInToProfileActionsRedesign:h.a.bool,isPaidHub:h.a.bool,isSendingToContact:h.a.bool,NotificationAreaComponent:h.a.func,notificationAreaProps:h.a.object,neverLogList:Ce.a.list,objectType:Je.b.isRequired,onCancel:h.a.func.isRequired,onCompleteSave:h.a.func.isRequired,onPreventNavigation:h.a.func.isRequired,onInteractionEvent:h.a.func.isRequired,onRemoveRecipients:h.a.func.isRequired,onReplaceRecipient:h.a.func,onRteChange:h.a.func.isRequired,onRteStateCreated:h.a.func.isRequired,onSave:h.a.func.isRequired,onUpdateRecipients:h.a.func.isRequired,owners:h.a.shape({get:h.a.func.isRequired}).isRequired,paddingClassName:h.a.string.isRequired,passthruRtePlugins:h.a.instanceOf(wt.a).isRequired,recipientsNotOptedIn:Ce.a.list,recipientsOptedOut:Ce.a.list,renderEmailBranding:h.a.func,renderTray:h.a.func,replyEngagementId:h.a.number,trackerKey:h.a.string,replyEngagementType:h.a.string,onResetSendValidation:h.a.func,RichTextEditor:h.a.instanceOf(Function).isRequired,RichTextEditorDefaultConfigurations:h.a.object.isRequired,saveLabel:h.a.node.isRequired,sender:h.a.instanceOf(J.a).isRequired,sendToAnyEmailAddress:h.a.bool.isRequired,showTrackingTooltip:h.a.bool.isRequired,subject:Je.a.isRequired,subjectId:h.a.string.isRequired,threadId:h.a.oneOfType([h.a.string,h.a.number]),trialState:h.a.oneOfType([h.a.array,h.a.object]),useTertiaryButtons:h.a.bool,userEmail:h.a.string,handleUsageLogging:h.a.func.isRequired,onInteractionChange:h.a.func.isRequired,gdprDisabled:h.a.bool,onSaveToLocalStorage:h.a.func,onPasteContent:h.a.func,dontRenderConfirmAccountSwitch:h.a.bool,onBeforeSendValidation:h.a.func,AsyncFileManager:h.a.func,AsyncSalesModal:h.a.func,sourceApp:h.a.string,defaultFontSettings:Ce.a.record,oneToOneSubscription:Ce.a.map,hasGdprEnabled:h.a.bool,fetchEmailHistory:h.a.func},sc={onUnsubscribeChange:h.a.func.isRequired},cc=function(e){var t={EmailActions:e.EmailActions,enableMultipleToAddresses:!0,notificationAreaProps:{},onPreventNavigation:T.a,onCompleteSave:T.a,onPasteContent:T.a,onInteractionEvent:T.a,onSaveToLocalStorage:T.a,passthruRtePlugins:new wt.a,saveLabel:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.interaction.send"}),sendToAnyEmailAddress:!1,recipientsNotOptedIn:Object(b.List)(),globallyOptedOutRecipients:Object(b.List)(),recipientsOptedOut:Object(b.List)(),handleUsageLogging:T.a,onInteractionChange:T.a,gates:Object(b.Set)(),gdprDisabled:!1,onResetSendValidation:T.a,dontRenderConfirmAccountSwitch:!1},n=function(t){Object(d.a)(n,t);function n(t){var a;Object(s.a)(this,n);(a=Object(u.a)(this,Object(l.a)(n).call(this,t))).getRecipientEmail=function(){var e=a.props.gates,t=e&&e.get("CRM:VidyardTrackingTokens"),n=Object(Dt.i)(a.state);return t&&1===n.size?n.first():null};a.handleSecondarySaveButtonClick=function(e){a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:"clicked send later"});var t=a.createEmailInteractionRecord(e,a.props.associations),n=a.componentConfig.createEmailMetadata;a.handleSetOpenState();a.rteResults=e;a.setState({email:n(t,it.a,a.props.replyEngagementId)})};a.handleScheduleSend=function(e){a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:"scheduled email"});a.sendEmail({sendLaterSelectionRecord:e})};a.handleSave=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=a.props,n=t.isFullScreen,r=t.onInteractionEvent,i=t.onBeforeSendValidation;n&&r(Vo.a,{type:yt.c});var o="function"!=typeof i||i({editorState:a.rteResults.editorState}),s=e.skipCompleteSave;o&&a.sendEmail({skipCompleteSave:s})};a.sendEmail=function(e){var t=a.props,n=t.replyEngagementId,r=t.subjectId,i=t.gdprDisabled,o=t.neverLogList,s=t.isConversationsInteraction,c=a.state,u=c.unsubscribeLinkData,l=c.from;a.setState({sending:!0});var d=a.componentConfig.common.appSource,p=Boolean(a.props.connectedAccounts.isShared(l.addressId)),m=e||{},h=m.sendLaterSelectionRecord,f=m.skipCompleteSave;a.triggerSaveStatusChanged();a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:"sent email"});a.debouncedOnInteractionChange.cancel();a.props.handleUsageLogging("sentFirstCrmEmail");a.trackEmailCommunicatorSend(e);i||a.props.EmailActions.completeLocalLawfulBasis(r);a.createEmail({isSendLater:!!h,skipCompleteSave:f}).then(function(t){var r=t.email,i=t.interaction,c=t.isHubSpotHosted,l=a.getRecipientCounts(),m=l.toCount,h=l.ccCount,f=l.bccCount;re({key:$o.SENT_EMAIL,tags:{isHubSpotHosted:c,isShared:p,toCount:m,ccCount:h,bccCount:f,isReplying:!!n,isScheduled:!(!e||!e.sendLaterSelectionRecord)}});ea({email:r,associations:i.associations,replyId:n,source:d,when:e&&e.sendLaterSelectionRecord&&e.sendLaterSelectionRecord.sendTimeUTC,recommendedSendTimeId:e&&e.sendLaterSelectionRecord&&e.sendLaterSelectionRecord.recommendedId,unsubscribeLinkType:u.get("linkType"),EmailActions:a.props.EmailActions,onSendSuccess:a.partial(a.handleEmailSent,i,e),onSendError:a.handleEmailSendError,isHubSpotHosted:c,isShared:p});if(!r.shouldLogToCrm&&!p&&!s){var g=r.to.toJS().concat(r.cc.toJS()).concat(r.bcc.toJS()).filter(function(e){var t=e.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi).pop();return Object(ue.d)(o,t)});qo.a.addAlert({message:Se.a.text("customerDataCommunicator.Communicator.Email.validation.floatingNeverlogAlert",{emails:Se.a.SafeString(g.join(", ")),count:g.length}),titleText:"",timeout:1e4})}}).catch(function(e){var t={message:"Email Send Failed",detailedMessage:e.message};ie({error:t});qo.a.addAlert({message:Se.a.text("customerDataCommunicator.Email.api.errors.EMAIL_SEND_ERROR"),titleText:"",timeout:1e4})})};a.handleCancel=function(){if(!a.state.sending){a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:"canceled email"});a.reset();a.props.onPreventNavigation(!1);a.props.onCancel()}};a.handleEditSignature=function(e){a.trackEmailCommunicatorEvent("edit signature");a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:"open signature popover from "+e});a.setState({editingSignature:!0})};a.handleSignatureEditorClosed=function(){a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:"closed signature popover"});a.setState({editingSignature:!1})};a.handleEmailSent=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=a.props,i=r.onInteractionEvent,o=r.onSave,s=r.isPaidHub,c=r.trialState,u=r.connectedAccounts,l=a.state.hasEmailBrandingBanner,d=mn(c),p=a.getMediaAttachmentCounts();a.trackEmailCommunicatorSentUsage(Object.assign({},t,{mediaAttachmentCounts:p}));var m=a.state.from.getSendAsAddress(),h=u.getAccountWithAlias(m);if(h&&h.getIn(["aliasList","aliases"]).find(function(e){return e.address===m&&"owner"===e.type})){a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:"sent email with manually added alias"});i(At.f)}s||d||l&&l()&&i(At.e,n);a.reset();a.props.onPreventNavigation(!1);o(e,n.engagement,{postProcessOnly:!0})};a.handleEmailSendError=function(e){var t=a.props.onInteractionEvent;a.setState({sending:!1});t(At.d,{error:e});var n=e.message;(n.indexOf("BLACKLISTED_EMAIL")>-1||n.indexOf(Zs.e)>-1)&&a.handleCancel()};a.handleSubjectChange=function(e){a.updateSubject(e)};a.proceedToHandleSenderChange=function(e){a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:"continue using personal address"});a.setState({confirmAccountSwitchModal:!1});var t=a.props.connectedAccounts.getAliasEmailAddress(e,!1),n=a.props.connectedAccounts.getAccount(e),r=Tt()(["friendlyFromName"],n),i=Tt()(["resolvedFromName"],n),o=a.state.from.merge({addressId:e,address:t,friendlyName:r,sendAsAddress:Tt()(["sendFromEmail"],n),resolvedFromName:i});a.senderWithFriendlyName=a.updateFriendlyFromName(a.props.sender,e);var s=a.getIntegrationStatus(o,a.props);a.setState({from:o,integrationStatus:s});a.persistentFromAddress.setAddressByType(a.props.objectType,o).save()};a.confirmSenderChange=function(){var e=a.state.confirmAccountSwitchModal;a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:"revert back to shared address"});a.setState({confirmAccountSwitchModal:!e})};a.handleSenderChange=function(e){var t="changed sender";a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:t});a.trackEmailCommunicatorEvent(t);var n=a.props,r=n.replyEngagementId,i=n.interaction.metadata.get("from");i=i&&i.get("addressId")?i:a.state.from;a.setState({incomingFromAccountId:e});var o=a.props.connectedAccounts.getAccount(i.addressId),s=o.isShared(),c=a.props.connectedAccounts.getAccount(e).isShared();if(!s||c||!r||a.props.dontRenderConfirmAccountSwitch||a.state.confirmAccountSwitchCheck)a.proceedToHandleSenderChange(e);else{a.obtainInboxInfo(o);a.confirmSenderChange(e)}};a.handleSendToChange=function(e,t){if(e){a.setState({allowGDPRByPass:!1});a.props.onReplaceRecipient(a.state.recipient,t);a.setState({recipient:t})}else a.setState({recipient:Object(Dt.e)()})};a.handleCopyToChange=function(e,t,n){var r=a.state[a.getListName(e)];if(t){a.setState({allowGDPRByPass:!1});a.props.onUpdateRecipients(Object(b.List)([n]));a.addRecipient(e,r,n);a.multipleToAddressesEnabled&&a.fetchDeliverabilityStatusForEmail(n.getIn(["to","address"]))}else{a.removeRecipient(e,r,n);a.props.onRemoveRecipients(Object(b.List)([n]))}};a.handleRecipientChange=function(e,t,n){e!==_t.c||a.multipleToAddressesEnabled?a.handleCopyToChange(e,t,n):a.handleSendToChange(t,n)};a.handleRecipientSelectOpen=function(e){a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:"opened email "+e+" select"});var t="sendTo"===e?"to":e;a.trackEmailCommunicatorEvent('Search for "'+t+'" recipients')};a.handleDeleteEmailBrandingBanner=function(){a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:"deleted email branding banner"});if((0,a.state.hasEmailBrandingBanner)()){a.componentConfig.onDeleteEmailBrandingBanner();a.setState({hasEmailBrandingBanner:function(){return!1}});a.triggerSaveStatusChanged()}};a.handleMountBrandingBanner=function(){a.setState({hasEmailBrandingBanner:function(){return!0}});a.triggerSaveStatusChanged()};a.handleSignatureChange=function(e,t){if(t){var n=a.props,r=n.sender;(0,n.onInteractionEvent)(At.a,{sender:r,signature:e})}a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:t?"signature edit saved permanent":"signature edit saved"});es.a.log("communicator_saveSignature",{action:"save signature",activity:"email",channel:"email",signatureType:"unknown",source:a.getTrackingSource()});a.setState({signature:e,editingSignature:!1},function(){a.rteResults=a.rteResults.transform(a.getPreEditStateTransform());a.setState({editorState:a.rteResults.editorState})})};a.handleUnsubscribeChange=function(e){var t=e.get("linkType")?"changed unsubscribe link":"removed unsubscribe link";a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:t});a.setState({unsubscribeLinkData:e},function(){a.rteResults=a.rteResults.transform(a.getPreEditStateTransform());a.setState({editorState:a.rteResults.editorState})})};a.handleUseConnectedEmailAddress=function(){var e=a.getFirstConnectedEmailAddress();if(e){var t=a.props.connectedAccounts,n=t.getAddressId(e,!1);n||t.logAccountsError({message:"Connected Email Address not found",extraData:{firstConnectedEmailAddress:e}});a.handleSenderChange(n)}};a.handleRteStateCreated=function(e){var t=a.props.onRteStateCreated;a.rteResults=e;t(a.rteResults);a.triggerSaveStatusChanged()};a.handleRteStateChange=function(e){a.isInitialContentChange(a.rteResults,e);a.rteResults=e;a.props.onRteChange(a.rteResults);a.rteResults.contentChanged&&a.handleRteContentChange();a.debouncedSetState()};a.handleRteContentChange=function(){a.props.onResetSendValidation();a.props.onPreventNavigation(!0);a.debouncedOnInteractionChange()};a.handleSalesContentMenuClick=function(e){var t=e||"unknown";a.trackEmailCommunicatorEvent("clicked "+t.toLowerCase())};a.handleTemplateSelected=function(e){var t=e.templateId,n=e.res;if(""!==t){var r=a.emailAttributes.subject,i=Mt(n);(!Object(ue.b)(r)||a.props.replyEngagementType!==yt.f&&a.props.replyEngagementType!==yt.c)&&a.updateSubject(i.subject);a.setState({templateId:t});a.rteResults=a.rteResults.pushContent(i.html,!0).transform(a.getPreEditStateTransform());a.setEditorState(a.rteResults.editorState);a.trackEmailCommunicatorEvent("insert template");a.handleSaveToLocalStorage()}else a.setState({templateId:t})};a.handleDocumentSelected=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n="insert document link";a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:n});a.trackEmailCommunicatorEvent(n);a.insertLinkIntoEmail(t,e)};a.handleMeetingSelected=function(e,t){var n="insert meeting link";a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:n});a.trackEmailCommunicatorEvent(n);a.insertLinkIntoEmail(t,e)};a.handleQuotesSelected=function(e,t){a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:"quote select"});a.trackEmailCommunicatorEvent("insert quote");a.insertLinkIntoEmail(t,e,At.b)};a.handleSequenceSelected=function(){a.props.onCompleteSave();a.props.onCancel()};a.handleTrackingTooltipClose=function(){a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:"email tracking tooltip dismissed"});a.props.onInteractionEvent(At.g)};a.handleSetOpenState=function(){a.setState(function(e){return{sendLaterDialogOpen:!e.sendLaterDialogOpen}})};a.handleGDPRByPass=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=a.props.subjectId;a.setEditorState(a.rteResults.editorState);a.props.EmailActions.updateLocalLawfulBasis({subjectId:n,legalBases:e});a.setState({allowGDPRByPass:t,legalBases:e})};a.handleSaveToLocalStorage=function(){var e=a.createSaveStatusInteraction();e.savable&&a.props.onSaveToLocalStorage(e)};a.handleSalesContentDropdownOpenChange=function(e,t){if(t.target.value){a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:"clicked "+e+" in sales content menu"});a.handleSalesContentMenuClick(e)}};a.handlePaste=function(){a.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:"pasted content"});a.props.onPasteContent()};a.hasSendButtonOptions=function(){return a.props.gates&&a.props.gates.get("Communication:SendButtonOptions")};a.handleRenderSendLaterPopover=function(e){var t={get:function(e,t){return Pt.c(e,t.query)}},n=a.componentConfig.SendLaterPopover,r=a.state.from.addressId,i=r&&a.props.connectedAccounts.isHubSpotHosted(r),o=a.sendable(),s=a.hasSendButtonOptions(),c=Object(p.jsx)(q.a,{disabled:!o||i,onClick:e,size:a.getButtonSize(),use:s?"primary":"secondary","data-selenium-test":"communicator-send-later",children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.interaction.sendLater"})});return Object(p.jsx)(n,{emailMetadata:a.state.email,handleScheduleSend:a.handleScheduleSend,handleSetOpenState:a.handleSetOpenState,httpClient:t,open:a.state.sendLaterDialogOpen,objectType:a.props.objectType,children:o&&i?Object(p.jsx)(pa.a,{title:Se.a.text("customerDataCommunicator.Communicator.Email.interaction.sendLaterUnsupported"),children:c}):c})};a.handleOnConfirm=function(){var e=a.props.emailTrackingSetting;Ot(os.a.EMAIL_TRACKING_SETTINGS,e.trackingIsEnabled.toString());a.setState({showEmailTrackingSettingAlert:!1})};a.onChangeDontShowConfirm=function(e){if(e.target.checked){Ot(vt.a.DONT_SHOW_CONFIRM_ACCOUNT_SWITCH,!0);a.setState({confirmAccountSwitchCheck:!0})}};a.partial=N()(Ne.a);a.renderSenderWarning=a.renderSenderWarning.bind(Object(at.a)(a));a.renderConfirmAccountSwitch=a.renderConfirmAccountSwitch.bind(Object(at.a)(a));var r=a.props,i=r.objectType,o=r.NotificationAreaComponent,c=r.subjectId,d=r.gates,m=r.subject,h=r.enableMultipleToAddresses;a.componentConfig=e;var g=a.componentConfig.RichTextEditorResults;a.isInitialContentChange=Go(function(){return t.handleUsageLogging("emailCommunicatorInteraction",{subAction:"start to type email"})});a.rteResults=new g;a.NotificationAreaComponent=Sa(o);a.IntegrateEmailAlertContainer=Qe(a.componentConfig,i,c);a.VerifyEmailMessageComponent=Ca(t.EmailActions);a.multipleToAddressesEnabled=d&&!!d.get("CRM:EnableMultipleToAddresses")&&h;a.MessageSettings=Hr({recipientResolverFactory:a.getRecipientResolverFactory(i),subject:m,subjectId:c,isContact:a.isObjectTypeContact()});a.persistentFromAddress=Object(Zo.a)();a.emailSelectRef=Object(f.createRef)();a.positionTether=Ko()(500,function(){a.emailSelectRef.current.forceUpdate()});a.debouncedSetState=Ko()(1e3,function(){var e=a.sendable();if(a.isSendable!==e){a.sendAble=e;a._isMounted&&a.setState({rteResults:a.rteResults})}a.rteResults&&!a.rteResults.hasContent()&&a.props.onPreventNavigation(!1)});a.debouncedOnInteractionChange=Ko()(500,function(){a.props.onInteractionChange(a.createSaveStatusInteraction())});try{a.state=a.createInitialState(t);a.senderWithFriendlyName=a.updateFriendlyFromName(t.sender,a.state.from.addressId)}catch(e){a.state={hasError:!0};ut.a.captureException(e,{component:"EmailComponent",extras:{message:"Email component failed to instantiate."}});var O={message:"Email Failed Creating Initial State",detailedMessage:e.message};ie({error:O})}return a}Object(c.a)(n,[{key:"getChildContext",value:function(){return{onUnsubscribeChange:this.handleUnsubscribeChange}}},{key:"UNSAFE_componentWillMount",value:function(){if(!this.state.hasError){var e=this.props.gates,t=this.state.recipient;if(!this.multipleToAddressesEnabled&&t){var n=t.to,a=this.componentConfig.common.appId;n.address&&!this.props.deliverability.get(n.address)&&this.props.EmailActions.fetchEmailRecipientDeliverabilityStatus(n.address,{appId:a})}this.multipleToAddressesEnabled&&this.fetchDeliverabilityStatus();var r=e&&e.get("CRM:ImprovedRtePerformance"),i=this.getRtePlugins();this.rteConfig=this.props.RichTextEditorDefaultConfigurations.createRteConfig(i.getRteConfigType(yt.c),i.plugins,i.pluginComposers,i.pluginGroupConfig,r)}}},{key:"componentDidMount",value:function(){var e=this.state,t=e.to,n=e.ccs,a=e.bccs;if(!this.state.hasError){var r=this.props.gates,i=Object(Dt.j)(this.state);this.props.onUpdateRecipients(i);if(this.emailAttributes){this.emailAttributes.subject&&(t&&!t.isEmpty()||n&&!n.isEmpty()||a&&!a.isEmpty())&&this.setState({editorFocused:!0})}r&&r.get("Communicator:EnableGlobalFont")&&vs(ls);this._isMounted=!0}}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){if(!this.state.hasError){this.props.connectedAccounts!==e.connectedAccounts&&this.setState({integrationStatus:this.getIntegrationStatus(this.state.from,e),missingAccountsAccess:this.getMissingAccountsAccess(this.state.from,e)});!this.multipleToAddressesEnabled&&this.isObjectTypeContact()&&Object(Dt.a)(this.props.subject,e.subject)&&this.setState({recipient:Object(Dt.b)(e.subject)});if(this.props.sender.from.id!==e.sender.from.id){this.setState(this.createInitialState(e));this.senderWithFriendlyName=this.updateFriendlyFromName(e.sender,this.state.from.addressId)}if(this.props.editorState!==e.editorState){this.rteResults=this.rteResults.setEditorState(e.editorState).transform(this.getPreEditStateTransform());this.setEditorState(this.rteResults.editorState);this.handleSaveToLocalStorage()}!this.props.emailTrackingSetting&&e.emailTrackingSetting&&this.setState({showEmailTrackingSettingAlert:!0})}}},{key:"componentDidUpdate",value:function(e,t){e.interaction!==this.props.interaction&&this.resetStateFromInteraction(this.props);if(!this.multipleToAddressesEnabled&&!Object(b.is)(this.state.recipient.to,t.recipient.to)){var n=this.state.recipient;if(n.to.address&&!this.props.deliverability.get(n.to.address)){var a=this.componentConfig.common.appId;this.props.EmailActions.fetchEmailRecipientDeliverabilityStatus(n.to.address,{appId:a})}}var r=this.multipleToAddressesEnabled?Object(b.is)(this.state.to,t.to):Object(b.is)(this.state.recipient.to,t.recipient.to);Object(b.is)(this.state.from,t.from)&&r&&Object(b.is)(this.state.ccs,t.ccs)&&Object(b.is)(this.state.bccs,t.bccs)||this.triggerSaveStatusChanged();this.isComposingEmailDisabled()&&this.positionTether();var i=Object(Dt.i)(t),o=Object(Dt.i)(this.state),s=this.state.legalBases;if(!s.isEmpty()&&!Object(b.is)(i,o)){var c=s.keySeq().filterNot(function(e){return o.includes(e)}),u=Object(b.Map)(s);c.forEach(function(e){u.has(e)&&(u=u.delete(e))});var l=this.isValidGdprState(u);this.setState({allowGDPRByPass:l,legalBases:u})}}},{key:"componentWillUnmount",value:function(){this._isMounted=!1;this.debouncedOnInteractionChange.cancel()}},{key:"getRecipientResolverFactory",value:function(e){var t=this.componentConfig.RecipientResolverFactories;return!Object(Xs.a)(e)?t.get(Nt.a):t.get(e)}},{key:"createEmail",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.isSendLater,a=t.skipCompleteSave,r=void 0!==a&&a,i=t.rteResults,o=void 0===i?this.rteResults:i,s=this.props,c=s.attachments,u=s.connectedAccounts,l=s.onCompleteSave,d=s.associations,p=s.replyEngagementId,m=s.trackerKey,h=s.isQueueTask,f=this.state.legalBases,g=this.getRecipientCounts(),O=g.toCount+g.ccCount+g.bccCount,v=this.getRecipientEmail(),j=this.hasSendButtonOptions();return o.manageVideoTokens(O,v).then(function(t){var a=e.createEmailInteractionRecord(t,d);r||j&&n&&h?l({completeActiveTask:!1}):l();var i=a.metadata.get("from").addressId,o=i&&u.isHubSpotHosted(i),s=Boolean(i&&u.isShared(i)),g=(o||s)&&!n,O=g?Dt.d:Dt.c,v={interactionRecord:a,attachments:c,connectedAccounts:u,nameFormatter:it.a,trackerKey:m,legalBases:Object(b.List)(f&&f.valueSeq())};g&&p&&(v.replyToEngagementId=p);return{email:O(v),interaction:a,isHubSpotHosted:o}})}},{key:"getRtePlugins",value:function(){return va(this.componentConfig,this.props,{handleEditSignatureInline:this.partial(this.handleEditSignature,"inline"),handleEditSignaturePluginButton:this.partial(this.handleEditSignature,"plugin"),handleSignatureChange:this.handleSignatureChange,handleDeleteBrandingBanner:this.handleDeleteEmailBrandingBanner,handleMountBrandingBanner:this.handleMountBrandingBanner})}},{key:"validateIsConnected",value:function(e,t){var n=t.connectedAccounts;return e&&n?e.addressId?n.getAccount(e.addressId,!1)?e:null:n.getAccountWithAlias(e.get("email"))?e:null:e}},{key:"getListName",value:function(e){if(e===_t.c)return"to";if(e===_t.b)return"ccs";if(e===_t.a)return"bccs";throw new Error("Unknown to address type "+e)}},{key:"getIntegrationStatus",value:function(e,t){return!!this.validateIsConnected(e,t)&&t.checkIntegration(e.addressId)}},{key:"getMissingAccountsAccess",value:function(e,t){var n=t.connectedAccounts;return!n.hasEnabledAliases()&&n.isConnected(e.addressId)}},{key:"getInitialFrom",value:function(e){var t,n=e.interaction,a=e.sender,r=e.connectedAccounts,i=e.replyEngagementId,o=e.replyEngagementType,s=n.metadata.get("from");if(s&&s.get("address")&&i){var c=s.get("address"),u=r.getAccountWithAlias(c);u&&(t=new Ta.a({address:c,addressId:r.getAddressId(c,!1),friendlyName:u.get("friendlyFromName"),sendAsAddress:u.get("sendAsAddress")||u.get("sendFromEmail"),resolvedFromName:u.get("resolvedFromName")}));if(t){t&&e.sender&&e.sender.aliasEmailAddresses&&e.sender.aliasEmailAddresses.size&&e.sender.aliasEmailAddresses.find(function(e){return e.address===t.get("address")&&"owner"===e.type})&&(t=a.from);return t}ut.a.captureMessage("User does not have access to the sender.",{extra:{replyEngagementType:o,emailAddress:c,knownAccounts:r.toJS()}})}else t=s&&this.validateIsConnected(s,e);!t&&this.state&&this.state.from&&(t=this.validateIsConnected(this.state.from,e));var l=t&&e.sender&&e.sender.aliasEmailAddresses&&e.sender.aliasEmailAddresses.size&&e.sender.aliasEmailAddresses.find(function(e){return e.address===t.get("address")&&"owner"===e.type});t&&!l||(t=a.from);return t}},{key:"getInitialToRecipient",value:function(e){var t,n=this.props,a=n.contacts,r=n.owners,i=n.replyEngagementId,o=e&&e.metadata.get("to"),s=b.List.isList(o)?o.get(0):o;s instanceof Ta.a&&(t=Object(Dt.f)(s));if(i)return t;if(!this.isObjectTypeContact())return Object(Dt.e)(a,r,s);var c=Object(Dt.b)(this.props.subject);t&&c.emailAddresses.contains(s.address)&&(c=c.set("to",s));return c}},{key:"fetchDeliverabilityStatus",value:function(){var e=this,t=this.state;[t.to,t.ccs,t.bccs].forEach(function(t){t.forEach(function(t){if(t&&t.to.hasAddress()){var n=t.to.get("address");e.fetchDeliverabilityStatusForEmail(n)}})})}},{key:"fetchDeliverabilityStatusForEmail",value:function(e){var t=this.props.deliverability,n=this.componentConfig.common.appId;if(e&&Object(ue.e)(e)){t.get(e)||this.props.EmailActions.fetchEmailRecipientDeliverabilityStatus(e,{appId:n})}}},{key:"getInitialToList",value:function(e){var t=this.getInitialRecipientList(e,_t.c);if(t&&t.size&&(1!==t.size||t.getIn([0,"to","address"])))return t;var n=this.getInitialToRecipient(this.props.interaction);return n&&n.to.hasAddress()?Object(b.List)([n]):Object(b.List)()}},{key:"getInitialRecipientList",value:function(e,t){var n=this.props,a=n.contacts,r=n.owners,i=this.getListName(t);return(e.metadata.get(i)||Object(b.List)()).map(this.partial(Dt.e,a,r))}},{key:"createInitialState",value:function(e){var t=e.sender,n=e.unsubscribeLinkType,a=e.isPaidHub,r=e.trialState,i=e.emailTrackingSetting,o=e.disableUnsubscribeLink,s=Object.assign(this.createStateFromInteraction(e),{legalBases:Object(b.Map)(),allowGDPRByPass:!1,editingSignature:!1,editorFocused:!1,signature:t.signature,unsubscribeLinkData:Object(b.Map)({linkType:!o&&n}),sendLaterDialogOpen:!1,renderEmailBranding:this.componentConfig.renderEmailBranding,hasEmailBrandingBanner:function(){return!1},isPaidHub:a,trialState:r,confirmAccountSwitchModal:!1,confirmAccountSwitchCheck:!1,showEmailTrackingSettingAlert:!!i});s.integrationStatus=this.getIntegrationStatus(s.from,e);s.missingAccountsAccess=this.getMissingAccountsAccess(s.from,e);return s}},{key:"createStateFromInteraction",value:function(e){var t=e.interaction,n=this.rteResults.hasContent(),a=!!this.state&&this.state.sending&&n,r={from:this.getInitialFrom(e),ccs:this.getInitialRecipientList(t,_t.b),bccs:this.getInitialRecipientList(t,_t.a),templateId:t.metadata.get("templateId"),editorState:this.rteResults.editorState,sending:a,hasBodyContent:n,isForward:t.metadata.get("isForward")};this.emailAttributes={subject:t.metadata.get("subject")||""};this.multipleToAddressesEnabled?r.to=this.getInitialToList(t):r.recipient=this.getInitialToRecipient(t);return r}},{key:"resetStateFromInteraction",value:function(e){this.setState(this.createStateFromInteraction(e))}},{key:"createEmailInteractionRecord",value:function(e,t){var n=this.state,a=n.ccs,r=n.to,i=n.isForward,o=this.props,s=o.neverLogList,c=o.sender,u=S(e,o.userEmail,o.sourceApp),l={shouldLogToCrm:!s};if(s){var d=r.concat(a).some(function(e){return!Object(ue.d)(s,e.get("to").get("address"))});l.shouldLogToCrm=d}var p={from:this.state.from};c.get("from").get("firstName")&&!this.state.from.get("firstName")&&(p.from=this.state.from.set("firstName",c.get("from").get("firstName")).set("lastName",c.get("from").get("lastName")));var m=Object.assign({},this.state,this.emailAttributes,l,p,{isForward:i});return Object(Dt.o)(u,m,t)}},{key:"createSaveStatusInteraction",value:function(){if(!this.rteResults.hasState())return{};var e=this.rteResults.transform(this.getPostEditStateTransform());this.props.gates&&this.props.gates.get("CRM:DontSaveSignatureToLocalStorage")&&(e=this.rteResults);var t=this.savable(),n=this.props,a=n.replyEngagementId,r=n.replyEngagementType,i=Object.assign({replyEngagementId:a,replyEngagementType:r},this.state,this.emailAttributes);return{savable:t,interaction:Object(Dt.o)(j(e),i)}}},{key:"triggerSaveStatusChanged",value:function(){(0,this.props.onInteractionChange)(this.createSaveStatusInteraction())}},{key:"updateSubject",value:function(e){Object.assign(this.emailAttributes,{subject:e});this.debouncedOnInteractionChange();this.debouncedSetState()}},{key:"getTrackingSource",value:function(){return this.props.inTimeline?"timeline":this.props.threadId?"inbox":"communicator"}},{key:"getRecipientCounts",value:function(){var e=this.state,t=e.to,n=e.ccs,a=e.bccs;return{toCount:t?t.size:0,ccCount:n?n.size:0,bccCount:a?a.size:0}}},{key:"trackEmailCommunicatorEvent",value:function(e){es.a.log("communicatorInteraction",{action:e,activity:"email",channel:"email",source:this.getTrackingSource()})}},{key:"trackEmailCommunicatorSend",value:function(e){var t=(e||{}).sendLaterSelectionRecord,n=this.getRecipientCounts(),a=n.toCount+n.ccCount+n.bccCount,r="click to send email",i="send now",o="not applicable";if(t){r="click to schedule email";i="schedule email";o=Rt()("uiOption",t)}es.a.log("communicator_sendEmail",{action:r,activity:"email",channel:"email",source:this.getTrackingSource(),replyAllCount:a,emailType:i,scheduleEmailType:o,isReply:!!this.props.replyEngagementId});es.a.log("communicator_emailActivation");es.a.log("communicator_firstEmailActivation",{screen:"first activation"})}},{key:"trackEmailCommunicatorSentUsage",value:function(e){var t=e||{},n=t.sendLaterSelectionRecord,a=t.mediaAttachmentCounts,r=this.getRecipientCounts(),i=r.toCount+r.ccCount+r.bccCount,o="send now",s="not applicable";if(n){o="schedule email";s=n.get("uiOption")}var c=!1;this.props.sender&&this.props.sender.getIn(["from","addressId"])&&(c=this.props.connectedAccounts.isShared(this.props.sender.getIn(["from","addressId"])));es.a.log("communicatorUsage_sendEmail",Object.assign({emailType:o,replyAllCount:i,scheduleEmailType:s,senderAccountType:c?"shared":"personal",source:this.getTrackingSource(),isReply:!!this.props.replyEngagementId},a.toJS()))}},{key:"updateRteResults",value:function(e){this.rteResults=this.rteResults.setEditorState(e);this.setEditorState(this.rteResults.editorState)}},{key:"setEditorState",value:function(e){this.props.onResetSendValidation();this.setState({editorState:e});this.triggerSaveStatusChanged()}},{key:"addRecipient",value:function(e,t,n){if(!t.contains(n)){t=t.push(n);var a=this.getListName(e);this.props.handleUsageLogging("emailRecipientsAdded",{subAction:"add "+a+" recipient",count:t.size});es.a.log("communicator_recipientInteraction",{action:'Add "'+a.replace(/s$/,"")+'" recipient',activity:"email",channel:"email",source:this.getTrackingSource(),count:t.size});this.setState(Object(ve.a)({},a,t))}}},{key:"removeRecipient",value:function(e,t,n){var a=t.findIndex(function(e){return n.getIn(["to","address"]).toLocaleLowerCase()===e.getIn(["to","address"]).toLocaleLowerCase()});t=t.remove(a);var r=this.getListName(e);this.props.handleUsageLogging("emailCommunicatorInteraction",{subAction:"remove "+r+" recipient"});this.trackEmailCommunicatorEvent('Remove "'+r.replace(/s$/,"")+'" recipient');this.setState(Object(ve.a)({},r,t))}},{key:"insertLinkIntoEmail",value:function(e,t,n){var a=Lt(this.rteResults,{url:e,text:t}).editorState;this.updateRteResults(a);this.props.onInteractionEvent(n)}},{key:"reset",value:function(){var e=this.props,t=e.sender.signature,n=e.onInteractionEvent;Ts(Ct.EMAIL);n(At.c);this.setState({signature:t,legalBases:Object(b.Map)(),hasEmailBrandingBanner:function(){return!1}});this.emailAttributes={}}},{key:"getMediaAttachmentCounts",value:function(){return zo.fromRteResults(this.rteResults).set("numberOfAttachments",this.props.attachments.size)}},{key:"updateFriendlyFromName",value:function(e,t){if(!t)return e;var n=this.props.connectedAccounts.getAccount(t),a=xt.a.toAliasAddress(t);if(!n.isPrimaryAlias(a))return e;var r=Tt()(["friendlyFromName"],n),i=Tt()(["resolvedFromName"],n)||null;return e.merge({from:e.from.merge({friendlyName:r,resolvedFromName:i})})}},{key:"isObjectTypeContact",value:function(){return this.props.objectType===St.CONTACT}},{key:"getSendToType",value:function(){var e=this.props,t=e.replyEngagementId,n=e.sendToAnyEmailAddress;return t||this.isObjectTypeContact()&&!n?xn.b:xn.c}},{key:"editable",value:function(){var e=this.componentConfig.common.hasScope;if(this.multipleToAddressesEnabled)return Object(ue.f)(e);var t=this.props,n=t.sender,a=t.deliverability,r=this.state.recipient;return Object(ue.h)(n,r,a,e)}},{key:"savable",value:function(){var e=this.state,t=e.ccs,n=e.bccs,a=this.emailAttributes.subject;return Object(ue.b)(a)||this.rteResults.hasContent()||!t.isEmpty()||!n.isEmpty()}},{key:"validateEmailAddresses",value:function(){return Object(Dt.i)(this.state).every(ue.e)}},{key:"validateEmailDeliverability",value:function(){var e=this.props,t=e.deliverability,n=e.sender;return!(!n||!n.hasIntegration())||Object(Dt.i)(this.state).every(function(e){return Object(ue.c)(e,t)})}},{key:"isValidGdprState",value:function(e){var t=this.props,n=t.globallyOptedOutRecipients,a=t.recipientsOptedOut,r=t.recipientsNotOptedIn,i=t.hasGdprEnabled;return n.concat(a,i?r:Object(b.List)()).filterNot(function(t){return e.has(t)}).isEmpty()}},{key:"hasToAddress",value:function(){var e=this.state,t=e.recipient,n=e.to,a=this.multipleToAddressesEnabled?n&&n.size:t.to.hasAddress();return a}},{key:"sendable",value:function(){var e=this.props,t=e.sender,n=e.deliverability,a=e.attachmentsValid,r=this.state,i=r.recipient,o=r.sending,s=this.emailAttributes.subject;if(this.multipleToAddressesEnabled)return Object(ue.l)(s,this.rteResults)&&this.hasToAddress()&&Object(Dt.i)(this.state).size&&this.validateEmailAddresses()&&this.validateEmailDeliverability()&&a&&!o;var c=this.componentConfig.common.hasScope;return Object(ue.i)(t,i,n,this.rteResults,s,c)&&this.validateEmailAddresses()&&this.hasToAddress()&&a&&!o}},{key:"deliverable",value:function(){if(this.multipleToAddressesEnabled)return!0;var e=this.props,t=e.sender,n=e.deliverability,a=this.state.recipient;return Object(ue.g)(t,a,n)}},{key:"mandatoryFieldsEmpty",value:function(){var e=this.emailAttributes.subject;return Object(ue.a)(e,this.rteResults)}},{key:"getButtonSize",value:function(){return this.props.useTertiaryButtons?"extra-small":"small"}},{key:"getFromTooltip",value:function(){return this.state.integrationStatus===Re.a?ra():ta()}},{key:"getTrackingTooltop",value:function(){var e=this.props,t=e.showTrackingTooltip,n=e.replyEngagementId;if(!t||n)return null;var a=na();a.onClose=this.handleTrackingTooltipClose;return a}},{key:"getMandatoryFieldsTooltip",value:function(){var e=this.state,t=e.recipient,n=e.to,a=e.sending,r=this.emailAttributes.subject,i=this.multipleToAddressesEnabled?n&&n.size:t.to.hasAddress();return Object(ue.l)(r,this.rteResults)&&i||a?null:i?aa():ia()}},{key:"getOwnerToOwnerTooltip",value:function(){var e=this.props,t=e.replyEngagementId,n=e.isSendingToContact,a=this.state.ccs.find(function(e){return e.to.id});return!t||n||a?null:ua()}},{key:"getInvalidAttachmentsTooltip",value:function(){return this.props.attachmentsValid?null:oa()}},{key:"getInvalidEmailAddressTooltip",value:function(){return this.validateEmailAddresses()?null:sa()}},{key:"getUndeliverableEmailAddressTooltip",value:function(){return this.validateEmailDeliverability()?null:ca()}},{key:"getSaveTooltip",value:function(){return this.getInvalidEmailAddressTooltip()||this.getUndeliverableEmailAddressTooltip()||this.getTrackingTooltop()||this.getMandatoryFieldsTooltip()||this.getInvalidAttachmentsTooltip()||ta()}},{key:"getStateTransformOpts",value:function(){var e=this.state,t=e.signature,n=e.renderEmailBranding,a=e.unsubscribeLinkData,r=e.isPaidHub,i=e.trialState,o=this.props.emailBrandingVariation,s=mn(i),c=!r&&!s&&n&&n()&&(o||Js.a);return{contentMediator:this.rteResults.contentMediator,signature:t,renderEmailBranding:n,emailBranding:c||null,unsubscribeLinkData:a,isPaidHub:r,trialState:i}}},{key:"getPreEditStateTransform",value:function(){return this.partial(Rn,this.getStateTransformOpts())}},{key:"getPostEditStateTransform",value:function(){return this.partial(An,this.getStateTransformOpts())}},{key:"getEmailNotificationAreaProps",value:function(){var e=Object(Dt.k)(this.props.sender);return Object.assign({emailIntegrations:e},this.props.notificationAreaProps)}},{key:"getRecipientSubjectId",value:function(){var e,t=this.state,n=t.recipient,a=t.to;if(this.multipleToAddressesEnabled){var r=a.find(function(e){return e.getIn(["to","id"])});e=r&&r.getIn(["to","id"])}else e=n.to.id;return e&&""+e}},{key:"getFirstConnectedEmailAddress",value:function(){var e=this.props.connectedAccounts,t=e&&e.getFirstIntegratedAlias();return t&&t.displayableAddress}},{key:"isComposingEmailDisabled",value:function(){var e=this.state,t=e.allowGDPRByPass,n=e.legalBases,a=this.props.gdprDisabled;return!t&&!a&&!this.isValidGdprState(n)}},{key:"obtainInboxInfo",value:function(e){var t=e&&e.getPrimaryAlias();if(t){var n=t.inboxId,a=t.conversationsConnectedAccountId;n&&a&&this.setState({connectedAccountId:a,inboxId:n})}}},{key:"renderConfirmAccountSwitch",value:function(){var e=this.state.incomingFromAccountId;if(this.state.confirmAccountSwitchModal){var t={personalEmail:e.split(" ").pop()};return Object(p.jsxs)(Xo.a,{use:"conversational",width:670,children:[Object(p.jsx)(ts.a,{children:Object(p.jsx)(Yo.a,{children:Object(p.jsx)(F.a,{message:"customerDataCommunicator.Communicator.Email.replyToThread.confirmChangeFromHeader"})})}),Object(p.jsxs)(Qo.a,{className:"text-left p-bottom-3",children:[Object(p.jsx)(ic,{className:"m-bottom-4",titleText:Object(p.jsxs)("div",{className:"m-bottom-1",style:{fontWeight:700},children:[Object(p.jsx)("span",{className:"m-right-2",children:Object(p.jsx)(F.a,{message:"customerDataCommunicator.Communicator.Email.replyToThread.tipHeader"})}),Object(p.jsx)("span",{style:{fontWeight:400,fontSize:"14px"},children:Object(p.jsx)(F.a,{message:"customerDataCommunicator.Communicator.Email.replyToThread.tipText"})})]}),type:"info",children:Object(p.jsx)(q.a,{use:"tertiary",href:"/live-messages-settings/"+et.a.get()+"/inboxes/"+this.state.inboxId+"/email/"+this.state.connectedAccountId,size:"small",external:!0,className:"m-top-2",children:Object(p.jsx)(F.a,{message:"customerDataCommunicator.Communicator.Email.replyToThread.inboxSettingsButton"})})}),Object(p.jsx)("p",{children:Object(p.jsx)(F.a,{message:"customerDataCommunicator.Communicator.Email.replyToThread.confirmChangeFromBody",options:t})}),Object(p.jsx)("div",{children:Object(p.jsx)(jt.a,{inline:!0,defaultChecked:!1,onChange:this.onChangeDontShowConfirm,children:Object(p.jsx)(F.a,{style:{fontSize:14},message:"customerDataCommunicator.Communicator.Email.replyToThread.dontShowAgain"})})})]}),Object(p.jsxs)(Jo.a,{children:[Object(p.jsx)(q.a,{use:"primary",onClick:this.proceedToHandleSenderChange.bind(this,e),children:Object(p.jsx)(F.a,{message:"customerDataCommunicator.Communicator.Email.replyToThread.confirmContinueButton"})}),Object(p.jsx)(q.a,{use:"secondary",onClick:this.confirmSenderChange,children:Object(p.jsx)(F.a,{message:"customerDataCommunicator.Communicator.Email.replyToThread.confirmBackButton"})})]})]})}return null}},{key:"renderUndeliverableStatus",value:function(){var e=this.componentConfig.common.hasScope;if(Object(ue.f)(e)&&!this.deliverable()){var t=this.state.recipient;if(t.to.exists()){var n="deliverability",a="danger";t.to.hasAddress()||(n="noEmailAddress");return Object(p.jsx)(U.a,{className:"m-all-3",titleText:Se.a.text("customerDataCommunicator.Communicator.Email.interaction.problem."+n+".title"),type:a,children:Object(p.jsx)(ee.a,{message:"customerDataCommunicator.Communicator.Email.interaction.problem."+n+".description"})})}}}},{key:"renderVerifyMessage",value:function(){var e=this.componentConfig.common.hasScope;if(!Object(ue.f)(e)){var t=this.VerifyEmailMessageComponent;return Object(p.jsx)(t,{})}}},{key:"renderSalesContentMenu",value:function(){var e=this.state,t=e.from,n=e.to,a=e.signature,r=e.templateId,i=e.missingAccountsAccess,o=this.props,s=o.objectType,c=o.subjectId,u=o.subject,l=o.handleUsageLogging,d=o.gates,m=o.isOptedInToProfileActionsRedesign,h=o.AsyncSalesModal,f=o.connectedAccounts,g=this.componentConfig,b=g.SalesContentMenu,O=g.getMeetingsLinks;if(this.editable()&&b&&!i){var v=this.isComposingEmailDisabled(),j=!!(d&&d.get("CRM:RecordActions")&&m),S=f.isShared(t.get("addressId"));return Object(p.jsx)(w.a,{boundaryName:"salesContentMenu",ErrorComponent:Lo,showRefreshAlert:!1,children:Object(p.jsx)(b,{from:t,fromSharedAccount:S,hideSequencesButton:j,handleUsageLogging:l,isSequencesDisabled:v,meetingsUrl:O().meetings,onDocumentSelect:this.handleDocumentSelected,onMeetingsSelect:this.handleMeetingSelected,onMeetingOpenChange:this.partial(this.handleSalesContentDropdownOpenChange,"meeting"),onQuotesOpenChange:this.partial(this.handleSalesContentDropdownOpenChange,"quotes"),onQuotesSelect:this.handleQuotesSelected,onSequenceSelectionMade:this.handleSequenceSelected,onTemplateSelect:this.handleTemplateSelected,onClick:this.handleSalesContentMenuClick,signature:a,subjectId:this.getRecipientSubjectId(),templateId:r,timelineObjectType:s,timelineSubject:u,timelineSubjectId:c,to:n,AsyncSalesModal:h,isCrmObject:!Object(Xs.a)(s)})})}}},{key:"renderOnboarding",value:function(){if(this.editable()){var e=this.componentConfig.OnboardingComponent;if(e){var t=this.props,n=t.objectType,a=t.subjectId;return Object(p.jsx)(e,{subjectId:a,objectType:n})}}}},{key:"renderSenderWarning",value:function(){var e=this.state,t=e.integrationStatus,n=e.from,a=e.missingAccountsAccess;if(t)return Object(p.jsx)(pa.a,{title:Se.a.text("customerDataCommunicator.Communicator.Email.sender.notIntegrated"),children:Object(p.jsx)(da.a,{name:"warning",color:Ja.MARIGOLD,className:"p-x-2"})});var r=this.props.connectedAccounts.getAliasFromAliasAddressId(n.get("addressId"));if(a&&r){var i=$r("RECONNECT",r).langBasePath+".tooltip";return Object(p.jsx)(pa.a,{title:Object(p.jsx)(Ri.a,{message:i}),children:Object(p.jsx)(da.a,{name:"warning",color:Ja.MARIGOLD,className:"p-x-2"})})}var o=r&&"owner"===r.type,s=Object(p.jsx)(De.a,{target:"_blank",href:"https://www.hubspot.com/product-updates/sending-to-manually-added-aliases-will-be-removed-from-hubspot-crm-on-february-25",children:Object(p.jsx)(F.a,{message:"customerDataCommunicator.Communicator.Email.sender.learnMore"})});return o?Object(p.jsx)(pa.a,{title:Object(p.jsx)(Ri.a,{message:"customerDataCommunicator.Communicator.Email.sender.aliasRemovedMessage",options:{link:s}}),children:Object(p.jsx)(da.a,{name:"warning",color:Ja.MARIGOLD,className:"p-x-2"})}):null}},{key:"renderMessageSettings",value:function(){var e=this.componentConfig.common.hasScope;if(Object(ue.f)(e)){var t=this.componentConfig.makeContactSearchSelect,n=this.props,a=n.disabledRecipientFields,r=n.objectType,i=n.subjectId,o=n.contacts,s=n.owners,c=n.gates,u=n.replyEngagementId,l=n.deliverability,d=n.connectedAccounts,m=n.isConversationsInteraction,h=this.state,f=h.to,g=h.bccs,b=h.ccs,O=h.from,v=h.recipient,j=h.isForward,S=this.emailAttributes.subject,y={};this.multipleToAddressesEnabled&&(y.toList=f);var C=!u||!!c.get("CRM:EnforceReplySenderAddress"),E=Tt()(["addressId"],O),T=!d.isShared(E)&&!m;return Object(p.jsx)(this.MessageSettings,Object.assign({bccList:g,ccList:b,contacts:o,disabledRecipientFields:a,deliverability:l,from:O,fromTooltip:this.getFromTooltip(),allowSenderChange:C,makeContactSearchSelect:t,onRecipientChange:this.handleRecipientChange,onSenderChange:this.handleSenderChange,onSubjectChange:this.handleSubjectChange,owners:s,readOnly:!this.editable(),recipient:v,recipientResolverFactory:this.getRecipientResolverFactory(r),sender:this.senderWithFriendlyName,sendToType:this.getSendToType(),showDeliverabilityWarning:!this.deliverable(),showNeverLogWarning:T,renderSenderWarning:this.renderSenderWarning,subject:S,subjectId:i,onOpen:this.handleRecipientSelectOpen,emailSelectRef:this.emailSelectRef,isForward:j},y))}}},{key:"renderRte",value:function(){var e=this;if(this.editable()){var t=this.props,n=t.RichTextEditor,a=t.saveLabel,r=t.notificationAreaProps,i=t.paddingClassName,o=t.subject,s=t.objectType,c=t.useTertiaryButtons,u=t.renderTray,l=t.gates,d=t.associations,m=t.defaultFontSettings,h=t.fetchEmailHistory,f=t.isQueueTask,g=this.state,b=g.editorState,O=g.editorFocused,v=g.templateId,j=this.componentConfig.SendLaterPopover,S=l&&l.get("CRM:SendLater"),y=l&&l.get("Communicator:EnableGlobalFont"),C=this.hasSendButtonOptions(),E="communicator-rte-wrapper"+(this.isComposingEmailDisabled()?" hidden":""),T=st()(i,"communicator-rte-input"),I=this.getRecipientEmail(),R=Tt()(["settings",ls],m),A=Rt()("isLoading",m);if(y&&A)return Object(p.jsx)(Q.a,{grow:!0},"loading_RichTextEditor");var N=S&&j?this.handleRenderSendLaterPopover:void 0,x=C?function(t){return Object(p.jsx)(rc,{sendParams:t,disabled:!e.sendable(),isQueueTask:f,defaultSaveLabel:a,handleSave:function(t){return e.handleSave.bind(e,t)},buttonSize:e.getButtonSize(),sendLaterButtonContent:N,saveTooltip:e.getSaveTooltip()})}:null,L=!y&&O;return Object(p.jsxs)(n,{defaultFont:v?void 0:R.get("font"),defaultSize:v?void 0:R.get("size"),defaultColor:v?void 0:R.get("color")&&"color|$|"+R.get("color"),focus:L,associations:d,className:E,cancelLabel:Se.a.text("customerDataCommunicator.Communicator.Email.interaction.cancel"),config:this.rteConfig,ControlsAreaComponent:this.NotificationAreaComponent,controlSize:this.getButtonSize(),controlsAreaComponentProps:this.getEmailNotificationAreaProps(),controlsButtonsClassName:r.controlsButtonsClassName,controlsClassName:c?"p-left-2":"",editorState:b,inputClassName:T,interactionType:yt.c,onCancel:this.handleCancel,showCancel:!1,onChange:this.handleRteStateChange,onPaste:this.handlePaste,onSave:this.handleSave,onSecondarySaveButtonClick:this.handleSecondarySaveButtonClick,onStateCreated:this.handleRteStateCreated,overrideDrawStyle:c,recipientEmail:I,renderTray:u,resetInitialStateOnSave:!1,saveDisabled:!this.sendable(),renderSaveButtons:x,saveLabel:a,saveTooltip:this.getSaveTooltip(),secondarySaveButtonContent:S&&j?this.handleRenderSendLaterPopover:void 0,showControls:!0,showControlsBorder:!c,subject:o,objectType:s,contactVid:this.getRecipientSubjectId(),useStickyControls:!0,onPluginCloseModal:this.handleSaveToLocalStorage,children:[Object(p.jsx)("div",{className:i,"data-selenium-test":"email-editor",children:this.props.children}),h&&Object(p.jsx)(Qs,{fetchEmailHistory:h})]},"RichTextEditor")}}},{key:"renderMissingAccountAccessAlert",value:function(){var e=this.state.from,t=this.props,n=t.onCancel,a=t.replyEngagementId,r=t.connectedAccounts,i=t.isPaidHub,o=this.componentConfig.footerClassName,s=r.getAliasFromAliasAddressId(e.get("addressId"));return Object(p.jsx)(ge,{className:o,onClick:n,showFooter:!!a,children:Object(p.jsx)(ti,{alias:s,isPaidHub:i})})}},{key:"renderIntegrateEmailAlert",value:function(e){var t=this.props,n=t.onCancel,a=t.replyEngagementId,r=this.componentConfig.footerClassName,i=this.IntegrateEmailAlertContainer;return Object(p.jsx)(ge,{className:r,onClick:n,showFooter:!!a,children:Object(p.jsx)(i,Object.assign({},e))})}},{key:"renderEditorArea",value:function(){var e=this.state,t=e.from,n=e.integrationStatus,a=e.missingAccountsAccess,r=e.legalBases,i=this.props,o=i.recipientsNotOptedIn,s=i.globallyOptedOutRecipients,c=i.recipientsOptedOut,u=i.subjectId,l=i.oneToOneSubscription,d=i.hasGdprEnabled;if(n)return this.renderIntegrateEmailAlert({use:n,emailAddress:t.address,connectedEmailAddress:this.getFirstConnectedEmailAddress(),onUseConnectedEmailAddress:this.handleUseConnectedEmailAddress});if(a)return this.renderMissingAccountAccessAlert();var m=[this.renderRte()];this.isComposingEmailDisabled()&&m.push(Object(p.jsx)(xo,{allRecipients:Object(Dt.j)(this.state),globallyOptedOutRecipients:s,handleGDPRByPass:this.handleGDPRByPass,hasGdprEnabled:d,recipientsNotOptedIn:o,recipientsOptedOut:c,subjectId:u,oneToOneSubscription:l,handleUsageLogging:this.props.handleUsageLogging,legalBases:r},"EmailGDPRMessage"));return m}},{key:"renderSignatureEditor",value:function(){var e=this.state,t=e.editingSignature,n=e.signature,a=this.componentConfig.SignatureEditorComponent;return t&&a?Object(p.jsx)(a,{AsyncFileManager:this.props.AsyncFileManager,signature:n,gates:this.props.gates,onSave:this.handleSignatureChange,onCloseModal:this.handleSignatureEditorClosed}):null}},{key:"renderConnectedDropTarget",value:function(){var e="communicator-rte-editor-wrapper"+(this.props.isFullScreen?" communicator-rte-drop-target":"");return this.props.connectDropTarget(Object(p.jsxs)("div",{className:e,children:[this.renderEditorArea(),this.renderSignatureEditor()]}))}},{key:"renderTicketNewEmailAlert",value:function(){var e=this.componentConfig.common.hasScope;return!this.props.replyEngagementId&&this.props.objectType===St.TICKET&&this.props.gates&&this.props.gates.get("CRM:TicketReply")&&e("tickets-access")&&Object(p.jsx)(Uo,{subjectId:this.props.subjectId,objectType:this.props.objectType})}},{key:"renderEmailTrackingSettingChanged",value:function(){var e=this.props.emailTrackingSetting;return this.state.showEmailTrackingSettingAlert?Object(p.jsx)(is,{emailTrackingSetting:e,onConfirm:this.handleOnConfirm}):null}},{key:"renderTicketEmailComposerAlert",value:function(){return this.props.objectType!==St.TICKET||this.props.replyEngagementId?null:Object(p.jsx)(Es,{})}},{key:"render",value:function(){var e=this.props.paddingClassName;return this.state.hasError?Object(p.jsx)(te,{codes:["unk"]}):Object(p.jsxs)("div",{className:"editor-body communicator-rte-wrapper"+(this.props.isHovered?" hovered":""),onBlur:this.handleSaveToLocalStorage,children:[this.renderTicketEmailComposerAlert(),this.renderEmailTrackingSettingChanged(),this.renderConfirmAccountSwitch(),this.renderOnboarding(),this.renderTicketNewEmailAlert(),this.renderSalesContentMenu(),Object(p.jsxs)("div",{className:"m-bottom-2 "+e,children:[this.renderVerifyMessage(),this.renderMessageSettings(),this.renderUndeliverableStatus()]}),this.renderConnectedDropTarget()]})}}]);return n}(f.Component);n.propTypes=oc;n.defaultProps=t;n.childContextTypes=sc;var a={dontRenderConfirmAccountSwitch:{stores:[ft.a],deref:function(){return ft.a.get(vt.a.DONT_SHOW_CONFIRM_ACCOUNT_SWITCH)}},defaultFontSettings:ps};return Object(i.connect)(a)(n)};Object(Pn.b)({namespace:Dn.q,fetch:io});var uc=Object(Pn.a)({namespace:Dn.q,idIsValid:function(e){return"string"==typeof e}}).defineName("SubscriptionsStoreByEmail").defineResponseTo(pt.Sb,function(e,t){return e.mergeDeep(t)}).defineResponseTo(pt.Ub,function(e,t){var n=t.email,a=t.updatedSubscription,r=e.getIn([n,"subscriptionStatuses"]).findIndex(function(e){return e.get("id")===a.id});return r>-1?e.setIn([n,"subscriptionStatuses",r],Object(b.fromJS)(a)):e.updateIn([n,"subscriptionStatuses"],function(e){return e.push(Object(b.fromJS)(a))})}).defineResponseTo(pt.Tb,function(e,t){var n=t.emails,a=t.updatedSubscription;n.forEach(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"NOT_OPTED",n=arguments.length>1?arguments[1]:void 0;a.optState=t;var r=e.getIn([n,"subscriptionStatuses"]).findIndex(function(e){return e.get("id")===a.id});e=r>-1?e.setIn([n,"subscriptionStatuses",r],Object(b.fromJS)(a)):e.updateIn([n,"subscriptionStatuses"],function(e){return e.push(Object(b.fromJS)(a))})});return e}).register(o.a),lc="ONE_TO_ONE",dc=n("TvEW"),pc=Object(b.Set)(),mc=Object(i.defineFactory)().defineName("ContactsEmailStore").defineGetInitialState(function(){return Object(b.Map)()}).defineGet(function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").toLowerCase();if(!e.has(t)&&!pc.has(t)){pc=pc.add(t);Object(dc.a)(t).catch(function(e){if(404!==(e&&e.status))throw e}).done()}return e.get(t)}).defineResponseTo(pt.q,function(e,t){return t.reduce(function(e,t){if(!t)return e;var n=Object(vo.d)(t,"email");e=e.set(n?n.toLowerCase():n,t);var a=Object(vo.d)(t,"hs_additional_emails"),r=a&&a.split(";");r&&r.forEach(function(n){e=e.set(n?n.toLowerCase():n,t)});return e},e)}).defineResponseTo(pt.y,function(e,t){var n=t.email;return e.remove(n?n.toLowerCase():n)}).register(o.a),hc={subjectId:h.a.string.isRequired,objectType:Je.b.isRequired,subject:Je.a.isRequired,onUpdateAssociation:h.a.func.isRequired,onRemoveAssociation:h.a.func.isRequired,emails:Ce.a.list.isRequired,replyEngagementType:h.a.string,interaction:h.a.instanceOf(O.a).isRequired,subscriptionNameForGDPRVerification:h.a.string,gates:h.a.shape({get:h.a.func.isRequired}),hasGdprEnabled:h.a.bool.isRequired},fc={subscriptionNameForGDPRVerification:lc,gates:Object(b.Set)()};function gc(e,t){return e.map(function(e){return t.get(e)}).filter(Li.a).reduce(function(e,t){return e.set(t.get("email"),t.get("subscriptionStatuses"))},Object(b.Map)())}function bc(e,t,n){return e.getIn([t.get("id"),"internalName"])===n}function Oc(e){return e.filter(function(e){return e===bo}).keySeq().toList()}function vc(e){return e.filter(function(e){return e===Oo}).keySeq().toList()}function jc(e,t,n,a){return e&&t?e.reduce(function(e,r,i){if(a.includes(i))return e;var o=r.find(function(e){return bc(t,e,n)},null,Object(b.Map)({optState:Oo})).get("optState");return e.set(i,o)},Object(b.Map)()).filter(function(e){return e!==go}):Object(b.Map)()}function Sc(e,t){return e&&e.find(function(e){return e.get("internalName")===t})}function yc(e){var t=function(t){Object(d.a)(n,t);function n(){Object(s.a)(this,n);return Object(u.a)(this,Object(l.a)(n).apply(this,arguments))}Object(c.a)(n,[{key:"render",value:function(){var t=this.props,n=t.subscriptionsByEmail,a=t.subscriptionDefinitionsById,r=t.subscriptionNameForGDPRVerification,i=t.emailsToIgnore,o=t.hasGdprEnabled,s=jc(n,a,r,i),c=Oc(s),u=vc(s),l=this.props.globallyOptedOutRecipients.map(function(e){return e.get("email")}).filterNot(function(e){return i.includes(e)}),d=Sc(a,r);return Object(p.jsx)(e,Object.assign({},this.props,{recipientsNotOptedIn:u,globallyOptedOutRecipients:l,recipientsOptedOut:c,oneToOneSubscription:d,hasGdprEnabled:o}))}}]);return n}(xe.a);t.defaultProps=fc;return Object(i.connect)({subscriptionsByEmail:{stores:[uc],deref:function(e){var t=e.emails,n=e.replyEngagementType,a=e.interaction;if(n===yt.f){var r=a.getIn(["metadata","to"],Object(b.List)()).map(function(e){return e.address});t=t.filterNot(function(e){return r.includes(e)})}return t.size?gc(t,uc):Mn.a}},globallyOptedOutRecipients:{stores:[uc],deref:function(e){var t=e.emails;return t.size?t.map(function(e){return uc.get(e)}).filter(function(e){return e&&"unsubscribed"===e.get("status")}):Object(b.List)()}},emailsToIgnore:{stores:[mc],deref:function(e){var t=e.emails,n=e.gates;return n&&n.get("BET:enable_1_1_communication_for_ql")&&t.size?t.map(function(e){var t=mc.get(e);return t&&"true"===t.getIn(["properties","enable_1_1_communication_for_ql","value"])?e:null}).filter(Li.a):Object(b.List)()}}},o.a)(t)}yc.propTypes=hc;var Cc=yc;Object(Pn.b)({namespace:Dn.r,fetch:ho});var Ec=Object(Pn.a)({namespace:Dn.r,idIsValid:function(){return!0}}).defineName("SubscriptionDefinitionsStore").register(o.a),Tc=n("r+9/"),Ic=n.n(Tc),Rc=n("RaRG"),Ac=n("eUxV"),Nc="/subscriptions/v1/definitions/by-subscription-key",xc={owners:h.a.shape({get:h.a.func.isRequired}).isRequired,onUpdateAssociation:h.a.func.isRequired,onRemoveAssociation:h.a.func.isRequired,neverLogList:Ce.a.list,subject:Je.a.isRequired},Lc={neverLogList:Object(b.List)()};function kc(e){var t=e.to,n=t.firstName,a=t.lastName,r=t.address;return{primaryDisplayLabel:it()({firstName:n,lastName:a}),secondaryDisplayLabel:r?"<"+r+">":void 0}}function Mc(e){var t=kc(e),n=t.primaryDisplayLabel,a=t.secondaryDisplayLabel,r=e.to.id;return Object(b.fromJS)(Object(ve.a)({},Ac.c,{associationOptionRecordsMap:Object(ve.a)({},""+r,{isDefaultAssociation:!1,isSelected:!0,objectId:r,primaryDisplayLabel:n,secondaryDisplayLabel:a}),assoicationSpec:{associationCategory:"HUBSPOT_DEFINED",associationTypeId:10},objectIds:[""+r]}))}var _c=function(e){return function(t){var n=Cc(t,e),a=function(t){Object(d.a)(a,t);function a(){var e;Object(s.a)(this,a);(e=Object(u.a)(this,Object(l.a)(a).call(this))).handleAddEmails=function(t){var n=t.map(function(e){return e.to.address});e.setState({emails:e.state.emails.concat(n)})};e.handleAddAssociations=function(t,n,a){var r=e.props.subject,i=n.to.id;if(i&&!a){var o=Object(Xs.a)(Object($a.c)(r))?void 0:Mc(n);e.props.onUpdateAssociation(t,i,o)}};e.handleRemoveEmails=function(t){var n=t.map(function(e){return e.to.address});e.setState({emails:Ic()(n,e.state.emails)})};e.handleRemoveAssociations=function(t,n,a){var r=e.props.subject,i=n.to.id;if(i&&!a){var o=Object(Xs.a)(Object($a.c)(r))?void 0:Object(b.fromJS)({objectIdToRemove:""+i,toObjectTypeId:Ac.c});e.props.onRemoveAssociation(t,i,o)}};e.hasOwner=function(t){return!!e.props.owners.get(""+t.getIn(["to","id"]))};e.handleOnUpdateRecipients=function(t){var n=e.props.neverLogList;e.handleAddEmails(t);t.reduce(function(e,t){var a=Object(ue.d)(n,t.to.address);return e.set(t,a)},Object(b.Map)()).forEach(function(t,n){var a=e.hasOwner(n);t?e.handleRemoveAssociations(St.CONTACT,n,a):e.handleAddAssociations(St.CONTACT,n,a)})};e.handleOnRemoveRecipients=function(t){e.handleRemoveEmails(t);t.forEach(function(t){return e.handleRemoveAssociations(St.CONTACT,t,e.hasOwner(t))})};e.handleReplaceRecipient=function(t,n){var a=t.to.address,r=n.to.address,i=t.to.id,o=n.to.id,s=e.state.emails.push(r).filterNot(function(e){return e===a});e.setState({emails:s});o&&e.props.onUpdateAssociation(St.CONTACT,o);i&&e.props.onRemoveAssociation(St.CONTACT,i)};e.state={emails:Object(b.List)(),hasGdprEnabled:!1};return e}Object(c.a)(a,[{key:"componentDidMount",value:function(){Object(Pt.c)(Nc+"/ONE_TO_ONE").then(function(e){e.get("active")&&To("ONE_TO_ONE").done()}).catch(function(e){Object(ne.a)({error:new Error("Error finding ONE_TO_ONE subscription"),extraData:{message:e.message}})});this.setState({hasGdprEnabled:e.common.hasPortalSetting(Rc.b)})}},{key:"render",value:function(){return Object(p.jsx)(n,Object.assign({},this.props,{emails:this.state.emails,onUpdateRecipients:this.handleOnUpdateRecipients,onRemoveRecipients:this.handleOnRemoveRecipients,onReplaceRecipient:this.handleReplaceRecipient,hasGdprEnabled:this.state.hasGdprEnabled}))}}]);return a}(xe.a);return Object(i.connect)({neverLogList:{stores:[jr],deref:function(){return jr.get("neverlogList")}},subscriptionDefinitionsById:{stores:[Ec],deref:function(){var e=Ec.get("subscriptionDefinitions")&&Ec.get("subscriptionDefinitions").get("subscriptionDefinitions");return e?e.reduce(function(e,t){return e.set(t.get("id"),t)},Object(b.Map)()):null}}},o.a)(a)}};_c.propTypes=xc;_c.defaultProps=Lc;var Dc=_c;n.d(t,"buildEmail",function(){return Pc});var Pc=function(e){var t=r()(Dc(e),Y,ce,nt(e),Ze(e),cc);return Object(i.connect)(e.dependencies,o.a)(t(e))}},yMxc:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var a=n("qG7J"),r=n("Ly8s"),i=n("Xdd2"),o=n("EvX1"),s=n.n(o),c=n("QYOI"),u=n("W0Wh"),l=n("Nw75"),d=Object(c.Record)({promise:null,value:l.b},"LazyValueState");function p(e){var t=e.fetch,n=e.namespace,o=e.responseTransform,c=void 0===o?s.a:o,p=e.getterTransform,m=void 0===p?function(e){return e.value}:p,h=Object(u.c)(n,a.FETCH),f=h.QUEUED,g=h.STARTED,b=h.FAILED,O=h.SUCCEEDED;return Object(i.defineFactory)().defineName(n+"_LazyValueStore").defineGetInitialState(d).defineGet(function(e,t){t&&t.forceRefresh?Object(r.b)(f,t):e.promise||Object(r.b)(f);return m({value:e.value,options:t})}).defineResponseTo(f,function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.promise&&!n.forceRefresh)return e;var a=t();Object(r.b)(g);a.then(function(e){return Object(r.a)(O,e)},function(){return Object(r.a)(b)}).done();return e.set("promise",a)}).defineResponseTo(O,function(e,t){return e.set("value",c(t))}).defineResponseTo(b,function(e){return e.set("value",l.a)})}},yTm7:function(e,t,n){"use strict";var a=n("OwGx"),r=n("ll3n"),i=n("AgF4"),o=n("Xdd2"),s=n("emzX"),c=n.n(s),u=n("E7+s"),l=n("Y/yC"),d=n.n(l);function p(e){c()("function"==typeof e,"connectPromise: Expected param `isLoading` to be type function but got `%s`",typeof e)}function m(e,t){return Object.keys(t).some(function(n){return e(t[n])})}function h(e,t,n){var a=d()();e(function(e,n,r,i){if(e)a.reject(e);else if(!m(t,n)){i();a.resolve(n)}},n);return a.promise}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.d,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.a;p(t);return Object(r.a)(h,Object(o.connectCallback)(e,n),t)}n.d(t,"a",function(){return v});var g="__data__";function b(e){return e[g]}function O(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return e.apply(void 0,n).then(b)}function v(e,t){return Object(r.a)(O,f(Object(a.a)({},g,e),t))}},zJzf:function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return a});n.d(t,"a",function(){return r});n.d(t,"c",function(){return i});var a="EMAIL_ACTIVITY",r="CALL_ACTIVITY",i="MEETING_ACTIVITY";e&&e.exports&&(e.exports.default=Object.assign({},e.exports))}).call(this,n("ABwO")(e))}}]);
//# sourceMappingURL=inbox-email-communicator.js.map